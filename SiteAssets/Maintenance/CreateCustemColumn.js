var a0_0x5c5d4b=a0_0x1aac;(function(_0x4f9cc2,_0x1ae9a0){var _0x644211=a0_0x1aac,_0x4ffca3=_0x4f9cc2();while(!![]){try{var _0x58bac7=-parseInt(_0x644211(0xf1))/0x1*(parseInt(_0x644211(0x154))/0x2)+parseInt(_0x644211(0x151))/0x3*(-parseInt(_0x644211(0x15f))/0x4)+-parseInt(_0x644211(0xcb))/0x5*(-parseInt(_0x644211(0x126))/0x6)+parseInt(_0x644211(0xae))/0x7*(parseInt(_0x644211(0x157))/0x8)+parseInt(_0x644211(0xbf))/0x9*(parseInt(_0x644211(0xe2))/0xa)+-parseInt(_0x644211(0x6b))/0xb*(-parseInt(_0x644211(0x134))/0xc)+-parseInt(_0x644211(0xc9))/0xd;if(_0x58bac7===_0x1ae9a0)break;else _0x4ffca3['push'](_0x4ffca3['shift']());}catch(_0x531062){_0x4ffca3['push'](_0x4ffca3['shift']());}}}(a0_0x52e5,0x51570),$(document)[a0_0x5c5d4b(0xb5)](function(){var _0x464b37=a0_0x5c5d4b,_0x26ce72=$('#btnSubmit')[_0x464b37(0xe5)]('.panel-heading-bg-txt-clr')['val']();GetDepartmentUrl(),LoadAllDepartment(),departmentOnChange(),$('#btnFillcompanyAndDepartmentId')[_0x464b37(0x90)](function(){getDataFromShareDocument();}),$('#btnCreateCustomColumn')['click'](function(){createNewCustomColumn();}),$(_0x464b37(0xdc))[_0x464b37(0x90)](function(){addEnvironmentalSettingsEntry();}),$('#btnFilProject')[_0x464b37(0x90)](function(){getProjects();}),$(_0x464b37(0x116))[_0x464b37(0x90)](function(){getDepartmentalItems();}),$(_0x464b37(0x148)),$(_0x464b37(0x9c))[_0x464b37(0x90)](function(){AddCustomer();}),$(_0x464b37(0x8c))[_0x464b37(0x90)](function(){CreateListColumns();}),$(_0x464b37(0x119))[_0x464b37(0x90)](function(){Addemployee();}),$(_0x464b37(0x181))[_0x464b37(0x90)](function(){AddCommentInAnnouncement();}),$('#btnaddProject')[_0x464b37(0x90)](function(){addProjectkDetails();}),$('#btnChangePriority')[_0x464b37(0x90)](function(){var _0x2ba3a9=_0x464b37;confirm(_0x2ba3a9(0xf2))&&ChangePriority();}),$(_0x464b37(0x13c))[_0x464b37(0x90)](function(){var _0x4a4994=_0x464b37;confirm(_0x4a4994(0xf2))&&getBlankAssignedBy();}),$(_0x464b37(0x17e))[_0x464b37(0x90)](function(){var _0x375acf=_0x464b37;confirm(_0x375acf(0xf2))&&(waitingDialog[_0x375acf(0x179)](),setTimeout(function(){getInternalEmployees();},0x1f4));}),$(_0x464b37(0x160))['click'](function(){ChangeCompanyId();}),$(_0x464b37(0x78))['click'](function(){var _0x24e9cc=_0x464b37;confirm(_0x24e9cc(0xf2))&&(waitingDialog['show'](),setTimeout(function(){fileShareDocumentColumn();},0x1f4));}),$(_0x464b37(0x76))['click'](function(){var _0x3c2b58=_0x464b37;confirm('The\x20related\x20MS\x20Flow\x20must\x20be\x20stopped.\x20\x0a\x20Do\x20want\x20to\x20continue\x20?')&&(waitingDialog[_0x3c2b58(0x179)](),setTimeout(function(){getTaskItemByTaskCategory();},0x1f4));});}));var TaskAssignTo=[0x74,0x14,0x20];function addEmployeeTaskDetails(){var _0x158529=a0_0x5c5d4b,_0x3148b5='EmployeeTaskDetails',_0x45a118=new Date(),_0x2a6eb4=_0x45a118[_0x158529(0x79)]()[_0x158529(0xff)](0x0,0x32);for(var _0x454769=0x1;_0x454769<=0x1f4;_0x454769++){var _0xd096a9=_0x158529(0x102)+_0x454769,_0x1aeedc;_0x1aeedc={'__metadata':{'type':_0x158529(0x125)},'TaskAssignToId':{'results':TaskAssignTo},'Title':_0xd096a9,'CurrentPhase':_0x158529(0x159),'TaskType':_0x158529(0x11a),'StartDate':_0x2a6eb4,'DueDate':'01/01/2023','TaskPriority':_0x158529(0x113),'Worktype':_0x158529(0xa6),'Distribution':_0x158529(0x145),'CompanyId':Logged_CompanyId},$[_0x158529(0x153)](AddItemEmp(_0x3148b5,_0x1aeedc))[_0x158529(0xd9)](function(_0x5dff44){var _0x55378d=_0x158529;_0x454769==0x1f4&&alert(_0x55378d(0x175));});}}function addProjectkDetails(){var _0x42d21c=a0_0x5c5d4b,_0x108cd7='ProjectDetails',_0x57da4b=_0x42d21c(0xa4),_0x405df0=new Date(),_0x2e5824=new Date(_0x42d21c(0xda)),_0x159d24=_0x405df0[_0x42d21c(0x79)]()[_0x42d21c(0xff)](0x0,0x32);for(var _0x3b4432=0xbb8;_0x3b4432<=0x1388;_0x3b4432++){var _0x3675eb=_0x42d21c(0x12a)+_0x3b4432,_0x5f56bc;_0x5f56bc={'__metadata':{'type':'SP.Data.ProjectDetailsListItem'},'Title':_0x3675eb,'ProjectCode':'2540D','ProjectName':_0x3675eb,'ProjectDescription':_0x57da4b,'ProjectSiteURL':'','DepartmentId':'50','Department_IDId':Logged_DepartmentId,'ActualStartDate':_0x159d24,'PlanedStartDate':_0x159d24,'PlanedEndDate':_0x42d21c(0x7b),'TechnologyUsed':'','Status':_0x42d21c(0x14f),'DepartmentName':'50','ManagerNameId':0x20,'OfficeLocation':_0x42d21c(0xd2),'Domain':'ABC','Office_Location_IdId':Logged_Location,'CompanyId':'2','ClientIDId':0x3,'ProgramIDId':0x2},$[_0x42d21c(0x153)](AddItemEmp(_0x108cd7,_0x5f56bc))[_0x42d21c(0xd9)](function(_0xc093ce){var _0x2c1a75=_0x42d21c;_0x3b4432==0x1388&&alert(_0x2c1a75(0x175));});}}function AddItemEmp(_0x58cf21,_0x48b262){var _0x5d8cbc=a0_0x5c5d4b,_0x13ce64=$[_0x5d8cbc(0x115)](),_0x120bc4=_spPageContextInfo[_0x5d8cbc(0x118)]+_0x5d8cbc(0x15b)+_0x58cf21+'\x27)/Items';return $[_0x5d8cbc(0x7e)]({'url':_0x120bc4,'type':'POST','async':![],'headers':{'accept':_0x5d8cbc(0xa2),'X-RequestDigest':$(_0x5d8cbc(0xcc))[_0x5d8cbc(0xfd)](),'content-Type':_0x5d8cbc(0xa2)},'data':JSON['stringify'](_0x48b262),'success':function(_0x1bf22d){var _0x495ee4=_0x5d8cbc;_0x13ce64[_0x495ee4(0x13b)](_0x1bf22d);},'error':function(_0x1e5d73){alert(JSON['stringify'](_0x1e5d73)),_0x13ce64['reject'](_0x1e5d73);}}),_0x13ce64['promise']();}function AddCustomer(){var _0x295a65=a0_0x5c5d4b,_0x1e169f='';for(var _0x52f99b=0x1;_0x52f99b<=0x1f4;_0x52f99b++){var _0x87f0a3='',_0x3e9725='';_0x1e169f=_0x295a65(0xca)+_0x52f99b;var _0x39d805='Demo'+_0x52f99b+_0x295a65(0x15d),_0x3d89c2=_0x295a65(0x73)+_0x52f99b,_0x6354be=_0x295a65(0x95),_0x3ad38d='',_0x4a6ca8='',_0x116e67='',_0x204494=_0x295a65(0xca),_0x4ae019='',_0x4170e0=_0x295a65(0xde),_0x45c9b4='',_0x527512=_0x295a65(0x87),_0xf444bf;_0xf444bf={'__metadata':{'type':_0x295a65(0x9f)},'Title':_0x1e169f,'Client_Code':_0x295a65(0xee),'Attn_Name':_0x3d89c2,'BillingAddress':_0x87f0a3,'EmailId':_0x39d805,'Country':_0x3e9725,'IsActive':!![],'City':_0x6354be,'State':'Up','SalesPersonId':TaskAssignTo[0x0],'InternalMembersId':{'results':TaskAssignTo},'TemplateType':_0x295a65(0x17b),'InternalSupervisorId':TaskAssignTo[0x1],'CustType':_0x295a65(0xa5),'Contact_No':_0x295a65(0x9d),'CompanyIDId':Logged_CompanyId},$['when'](AddItemEmp(_0x527512,_0xf444bf))[_0x295a65(0xd9)](function(_0x542e34){_0x52f99b==0x1f4&&alert('Submit\x20successfully');});}}function Create_List(){createList('Test\x20by\x20lakhan');}function createList(_0x2ed761){var _0x5423a8=a0_0x5c5d4b,_0x2cecc8=_spPageContextInfo[_0x5423a8(0x118)]+'/_api/web/lists';$[_0x5423a8(0x7e)]({'url':_0x2cecc8,'type':_0x5423a8(0x16a),'data':JSON[_0x5423a8(0x100)]({'__metadata':{'type':'SP.List'},'BaseTemplate':0x65,'Title':_0x2ed761}),'headers':{'accept':'application/json;odata=verbose','content-type':_0x5423a8(0xa2),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x5423a8(0xfd)]()},'success':onQuerySucceeded,'error':onQueryFailed});}function onQuerySucceeded(_0x13c8af){var _0x8a24ec=a0_0x5c5d4b;alert(_0x13c8af['d'][_0x8a24ec(0xf7)]+_0x8a24ec(0xb1));}function onQueryFailed(){var _0x5c30ba=a0_0x5c5d4b;alert(_0x5c30ba(0x83));}function a0_0x1aac(_0x59542f,_0x1ea1aa){var _0x52e584=a0_0x52e5();return a0_0x1aac=function(_0x1aac50,_0x403327){_0x1aac50=_0x1aac50-0x6b;var _0x1c51cb=_0x52e584[_0x1aac50];return _0x1c51cb;},a0_0x1aac(_0x59542f,_0x1ea1aa);}function Addemployee(){var _0x5b0f1f=a0_0x5c5d4b,_0x503091=_0x5b0f1f(0xf3),_0x31d7c8=new Date(),_0x2abd7a=_0x31d7c8['toISOString']()['substring'](0x0,0x32),_0x5a15ed;for(var _0x4ec674=0x0;_0x4ec674<=0x12c;_0x4ec674++){_0x5a15ed={'__metadata':{'type':_0x5b0f1f(0x171)},'LogonNameId':0x74,'FullName':_0x5b0f1f(0x161)+_0x4ec674,'Title':_0x5b0f1f(0x161)+_0x4ec674,'ParentId':0x190,'Designation':'BA','Manager':_0x5b0f1f(0x146),'ManagerLoginNameId':0x14,'Email':_0x5b0f1f(0xf8),'Gender':_0x5b0f1f(0x170),'CompanyId':Logged_CompanyId,'DepartmentId':Logged_DepartmentId,'OfficeLocationId':Logged_Location,'Status':'Active','JoiningDate':_0x2abd7a,'PrimaryCompany':_0x5b0f1f(0xea)},$[_0x5b0f1f(0x153)](AddItemEmp(_0x503091,_0x5a15ed))[_0x5b0f1f(0xd9)](function(_0x1c6532){var _0x83ef86=_0x5b0f1f;_0x4ec674==0x1324&&alert(_0x83ef86(0x175));});}}function AddCommentInAnnouncement(){var _0x54175e=a0_0x5c5d4b,_0x591a2d;for(var _0xc06e8=0x1;_0xc06e8<=0x3e8;_0xc06e8++){var _0x5aead2=_spPageContextInfo[_0x54175e(0x77)],_0xa7fb64=_0x54175e(0x12d),_0x1ed89d=_0x54175e(0x129),_0x3d70be={'__metadata':{'type':_0x54175e(0x143)+_0x1ed89d+_0x54175e(0x6c)},'Item_ID':'1357','WebPartName':_0x54175e(0x166),'Comment':'test'+_0xc06e8,'ReplierId':parseInt(_0x5aead2),'Initials':'Parent','ReplyforId':parseInt(_0x5aead2),'UserImage':_0xa7fb64};$[_0x54175e(0x153)](AddItemEmp(_0x1ed89d,_0x3d70be))[_0x54175e(0xd9)](function(_0x15aa73){_0xc06e8==0x3e8&&alert('Submit\x20successfully');});}}var arrMeta=[{'FieldTypeKind':0x2,'Title':a0_0x5c5d4b(0x89)},{'FieldTypeKind':0x2,'Title':a0_0x5c5d4b(0x13a)},{'FieldTypeKind':0x2,'Title':a0_0x5c5d4b(0x178)},{'FieldTypeKind':0x3,'Title':a0_0x5c5d4b(0x162)},{'FieldTypeKind':0x14,'Title':'Shared'},{'FieldTypeKind':0x2,'Title':a0_0x5c5d4b(0x163)},{'FieldTypeKind':0x14,'Title':a0_0x5c5d4b(0x110)},{'FieldTypeKind':0x2,'Title':a0_0x5c5d4b(0xb3)},{'FieldTypeKind':0x2,'Title':'SecurityLevel'},{'FieldTypeKind':0x2,'Title':a0_0x5c5d4b(0x139)},{'FieldTypeKind':0x2,'Title':a0_0x5c5d4b(0xd1)},{'FieldTypeKind':0x6,'Title':a0_0x5c5d4b(0x16c)},{'FieldTypeKind':0x2,'Title':a0_0x5c5d4b(0x75)},{'FieldTypeKind':0x14,'Title':a0_0x5c5d4b(0xef)},{'FieldTypeKind':0x4,'Title':a0_0x5c5d4b(0x10f)},{'FieldTypeKind':0x4,'Title':'FileValidity'},{'FieldTypeKind':0x4,'Title':a0_0x5c5d4b(0x8b)},{'FieldTypeKind':0x2,'Title':a0_0x5c5d4b(0x17f)},{'FieldTypeKind':0x2,'Title':a0_0x5c5d4b(0x17a)},{'FieldTypeKind':0x9,'Title':a0_0x5c5d4b(0xc2)},{'FieldTypeKind':0x3,'Title':a0_0x5c5d4b(0x117)}];function CreateListColumn(){var _0x265aae=a0_0x5c5d4b;console['log'](arrMeta);for(var _0x1294c2=0x0;_0x1294c2<arrMeta[_0x265aae(0x86)];_0x1294c2++){var _0x28e05f;_0x28e05f={'__metadata':{'type':'SP.FieldUser','addToDefaultView':_0x265aae(0xb0)},'FieldTypeKind':arrMeta[_0x1294c2][_0x265aae(0x138)],'Title':arrMeta[_0x1294c2]['Title'],'SelectionMode':0x0,'AllowMultipleValues':!![]},$[_0x265aae(0x7e)]({'url':_spPageContextInfo[_0x265aae(0x118)]+_0x265aae(0x147),'type':_0x265aae(0x16a),'async':![],'data':JSON['stringify'](_0x28e05f),'headers':{'Accept':_0x265aae(0xa2),'Content-Type':'application/json;odata=verbose','X-RequestDigest':$(_0x265aae(0xcc))['val']()},'success':function(_0x112130,_0x1fb8be,_0x480ef3){var _0x22ddf3=_0x265aae;console[_0x22ddf3(0x17c)](_0x22ddf3(0x122)+Title),alert(_0x22ddf3(0x15e));},'error':function(_0x45e6fb,_0x4e1f60,_0x3d9ccc){var _0x58ea69=_0x265aae;alert(_0x45e6fb[_0x58ea69(0x8f)]);}});}}function getGUID(){var _0x37ad9e=a0_0x5c5d4b,_0x1072e4=_spPageContextInfo[_0x37ad9e(0x118)]+_0x37ad9e(0xbd);$[_0x37ad9e(0x7e)]({'url':_0x1072e4,'headers':{'Accept':_0x37ad9e(0xa2)},'async':![],'success':function(_0x2e6107){var _0x19d9d0=_0x37ad9e,_0x351b91=_0x2e6107['d'][_0x19d9d0(0x135)][0x0][_0x19d9d0(0x112)];return console[_0x19d9d0(0x17c)](_0x2e6107['d'][_0x19d9d0(0x135)][0x0]['__metadata'][_0x19d9d0(0x150)]),_0x351b91['uri'][_0x19d9d0(0x81)](_0x19d9d0(0xfa))[0x1]['split']('\x27)')[0x0],_0x351b91;},'error':function(_0x21ef53){var _0x568fd5=_0x37ad9e;console[_0x568fd5(0x17c)](_0x568fd5(0xa0));}});}function createNewCustomColumn(){var _0x130dc9=a0_0x5c5d4b,_0x4ffa54=$(_0x130dc9(0x10a))[_0x130dc9(0xfd)]()[_0x130dc9(0x11e)](),_0x18ea4c=_0x4ffa54[_0x130dc9(0x120)]('/');if(_0x4ffa54[_0x130dc9(0x86)]==0x0)return alert(_0x130dc9(0x6f)),![];if($('.radioBtnClass')['is'](_0x130dc9(0x164))==![])return alert(_0x130dc9(0x70)),![];var _0x3f6fff=_0x4ffa54[_0x130dc9(0x81)]('/');_0x3f6fff=_0x3f6fff[_0x3f6fff['length']-0x1];_0x3f6fff=='/'&&(_0x3f6fff=_0x3f6fff[_0x3f6fff['length']-0x2]);for(var _0x1e0e53=0x0;_0x1e0e53<arrMeta['length'];_0x1e0e53++){var _0x45758f;GetAllFieldsFromList(_0x4ffa54[_0x130dc9(0x74)](0x0,_0x18ea4c),_0x3f6fff,arrMeta[_0x1e0e53]['Title']);if(urlValidation==![])return![];if(exists==![]){var _0x38946b='';_0x38946b=_0x4ffa54[_0x130dc9(0x74)](0x0,_0x18ea4c)+_0x130dc9(0xaf)+_0x3f6fff+_0x130dc9(0xb9),arrMeta[_0x1e0e53][_0x130dc9(0x138)]==0x6?arrMeta[_0x1e0e53][_0x130dc9(0xf7)]==_0x130dc9(0x16c)?_0x45758f={'__metadata':{'type':_0x130dc9(0xf4),'addToDefaultView':_0x130dc9(0xb0)},'FieldTypeKind':arrMeta[_0x1e0e53]['FieldTypeKind'],'Title':arrMeta[_0x1e0e53]['Title'],'Choices':{'results':[_0x130dc9(0xc6),'Not\x20Required','N/A']}}:_0x45758f={'__metadata':{'type':'SP.FieldChoice','addToDefaultView':'true'},'FieldTypeKind':arrMeta[_0x1e0e53][_0x130dc9(0x138)],'Title':arrMeta[_0x1e0e53][_0x130dc9(0xf7)],'Choices':{'results':['Draft',_0x130dc9(0xd6),_0x130dc9(0x9b),'Rejected']}}:arrMeta[_0x1e0e53][_0x130dc9(0x138)]!=0x7&&(_0x45758f={'__metadata':{'type':_0x130dc9(0xc7),'addToDefaultView':_0x130dc9(0xb0)},'FieldTypeKind':arrMeta[_0x1e0e53]['FieldTypeKind'],'Title':arrMeta[_0x1e0e53][_0x130dc9(0xf7)]}),arrMeta[_0x1e0e53]['Title']==_0x130dc9(0x140)&&(_0x38946b=_0x4ffa54['slice'](0x0,_0x18ea4c)+_0x130dc9(0xaf)+_0x3f6fff+_0x130dc9(0xb9),_0x45758f={'__metadata':{'type':_0x130dc9(0x94),'addToDefaultView':'true'},'FieldTypeKind':arrMeta[_0x1e0e53][_0x130dc9(0x138)],'Title':arrMeta[_0x1e0e53][_0x130dc9(0xf7)],'AllowMultipleValues':!![]}),arrMeta[_0x1e0e53][_0x130dc9(0xf7)]==_0x130dc9(0x110)&&(_0x38946b=_0x4ffa54[_0x130dc9(0x74)](0x0,_0x18ea4c)+_0x130dc9(0xaf)+_0x3f6fff+_0x130dc9(0xb9),_0x45758f={'__metadata':{'type':_0x130dc9(0x94),'addToDefaultView':_0x130dc9(0xb0)},'FieldTypeKind':arrMeta[_0x1e0e53]['FieldTypeKind'],'Title':arrMeta[_0x1e0e53][_0x130dc9(0xf7)]}),arrMeta[_0x1e0e53][_0x130dc9(0xf7)]==_0x130dc9(0xef)&&(_0x38946b=_0x4ffa54['slice'](0x0,_0x18ea4c)+_0x130dc9(0xaf)+_0x3f6fff+_0x130dc9(0xb9),_0x45758f={'__metadata':{'type':_0x130dc9(0x94),'addToDefaultView':'true'},'FieldTypeKind':arrMeta[_0x1e0e53]['FieldTypeKind'],'Title':arrMeta[_0x1e0e53][_0x130dc9(0xf7)],'SelectionMode':0x0}),arrMeta[_0x1e0e53][_0x130dc9(0xf7)]==_0x130dc9(0x9a)&&(_0x38946b=_0x4ffa54[_0x130dc9(0x74)](0x0,_0x18ea4c)+'/_api/web/lists/getByTitle(\x27'+_0x3f6fff+_0x130dc9(0xb9),_0x45758f={'__metadata':{'type':_0x130dc9(0x11b)},'FieldTypeKind':arrMeta[_0x1e0e53][_0x130dc9(0x138)],'Title':arrMeta[_0x1e0e53]['Title'],'DisplayFormat':0x0}),arrMeta[_0x1e0e53]['Title']=='email_date'&&(_0x38946b=_0x4ffa54[_0x130dc9(0x74)](0x0,_0x18ea4c)+'/_api/web/lists/getByTitle(\x27'+_0x3f6fff+_0x130dc9(0xb9),_0x45758f={'__metadata':{'type':'SP.FieldDateTime'},'FieldTypeKind':arrMeta[_0x1e0e53][_0x130dc9(0x138)],'Title':arrMeta[_0x1e0e53][_0x130dc9(0xf7)],'DisplayFormat':0x0}),arrMeta[_0x1e0e53][_0x130dc9(0xf7)]==_0x130dc9(0x10f)&&(_0x38946b=_0x4ffa54[_0x130dc9(0x74)](0x0,_0x18ea4c)+_0x130dc9(0xaf)+_0x3f6fff+'\x27)/fields',_0x45758f={'__metadata':{'type':_0x130dc9(0x11b)},'FieldTypeKind':arrMeta[_0x1e0e53]['FieldTypeKind'],'Title':arrMeta[_0x1e0e53][_0x130dc9(0xf7)],'DisplayFormat':0x0}),$['ajax']({'url':_0x38946b,'type':'POST','async':![],'data':JSON[_0x130dc9(0x100)](_0x45758f),'headers':{'Accept':_0x130dc9(0xa2),'Content-Type':'application/json;odata=verbose','X-RequestDigest':$(_0x130dc9(0xcc))[_0x130dc9(0xfd)]()},'success':function(_0x139c52,_0x5871b6,_0x313c0d){var _0x2da0d1=_0x130dc9;console[_0x2da0d1(0x17c)](_0x2da0d1(0x156)+arrMeta[_0x1e0e53][_0x2da0d1(0xf7)]),arrMeta[_0x2da0d1(0x86)]-0x1==_0x1e0e53&&alert(_0x2da0d1(0x101));},'error':function(_0x12ed99,_0x244e11,_0x2c6342){var _0x2a678b=_0x130dc9;console[_0x2a678b(0x17c)](_0x2a678b(0xad));}});}else console[_0x130dc9(0x17c)](_0x130dc9(0x177)+arrMeta[_0x1e0e53][_0x130dc9(0xf7)]),arrMeta[_0x130dc9(0x86)]-0x1==_0x1e0e53&&alert(_0x130dc9(0x103));}}var arrColumn=a0_0x5c5d4b(0xcd),urlValidation=!![],exists=![];function GetAllFieldsFromList(_0x53fbb5,_0x4133cf,_0x2bc98e){var _0x4fddc8=a0_0x5c5d4b;arrColumn='',exists=![],$[_0x4fddc8(0x7e)]({'url':_0x53fbb5+_0x4fddc8(0xaf)+_0x4133cf+_0x4fddc8(0x11d)+_0x2bc98e+'\x27','method':'GET','async':![],'headers':{'Accept':_0x4fddc8(0xa2)},'success':function(_0x2d4fc5,_0x217ea2,_0x10e183){var _0x4cff30=_0x4fddc8,_0x5096d7=_0x2d4fc5['d'][_0x4cff30(0x135)];if(_0x5096d7['length']>0x0)for(var _0x3e067b=0x0;_0x3e067b<_0x5096d7[_0x4cff30(0x86)];_0x3e067b++){ColumnTitle=_0x5096d7[_0x3e067b][_0x4cff30(0xf7)],exists=!![],$(_0x4cff30(0x148))[_0x4cff30(0xfd)]()=='2'&&DeleteListColumn(_0x53fbb5,ColumnTitle,_0x4133cf),console[_0x4cff30(0x17c)](_0x5096d7[_0x3e067b][_0x4cff30(0xf7)]);}},'error':function(_0xa61cdd,_0x49aa0e,_0x5afa6a){var _0x33f46d=_0x4fddc8;alert(_0x33f46d(0xe3)),urlValidation=![];}});}function UpdateFieldFromList(_0xc535fe,_0xf3a9c1,_0x3e3979){var _0x2b35e4=a0_0x5c5d4b;$[_0x2b35e4(0x7e)]({'url':_0xc535fe+_0x2b35e4(0xaf)+_0xf3a9c1+_0x2b35e4(0x7f)+_0x3e3979+')','method':_0x2b35e4(0x16a),'data':JSON[_0x2b35e4(0x100)]({'__metadata':{'type':_0x2b35e4(0x94),'addToDefaultView':_0x2b35e4(0xb0)},'Description':_0x2b35e4(0x12e),'FieldTypeKind':0x14,'Title':_0x3e3979,'AllowMultipleValues':!![]}),'headers':{'IF-MATCH':'*','X-HTTP-Method':_0x2b35e4(0xf6),'Accept':_0x2b35e4(0xa2),'Content-Type':_0x2b35e4(0xa2),'X-RequestDigest':$(_0x2b35e4(0xcc))[_0x2b35e4(0xfd)]()},'success':function(_0x3fe9c3,_0x24b2af,_0x18303a){var _0x10a17a=_0x2b35e4;console[_0x10a17a(0x17c)](_0x10a17a(0x15c)+_0x3e3979);},'error':function(_0x92027c,_0x390837,_0x8cba7){var _0x2acfcb=_0x2b35e4;console[_0x2acfcb(0x17c)](_0x2acfcb(0xad));}});}function DeleteListColumn(_0x42afcc,_0x3ad21d,_0x32a0c0){var _0x4dae43=a0_0x5c5d4b;$[_0x4dae43(0x7e)]({'url':_0x42afcc+'/_api/web/lists/getByTitle(\x27'+_0x32a0c0+_0x4dae43(0xed)+_0x3ad21d+'\x27)','type':_0x4dae43(0x16a),'async':![],'headers':{'Accept':_0x4dae43(0xa2),'Content-Type':_0x4dae43(0xa2),'IF-MATCH':'*','X-HTTP-Method':_0x4dae43(0x168),'X-RequestDigest':$(_0x4dae43(0xcc))['val']()},'success':function(_0x1094f3,_0x5777df,_0x351e52){var _0x1d5eee=_0x4dae43;console[_0x1d5eee(0x17c)](_0x1d5eee(0x84)+_0x3ad21d),exists=![],urlValidation=!![];},'error':function(_0x523653,_0x2ccb5f,_0x52eb34){var _0x18b0f5=_0x4dae43;console[_0x18b0f5(0x17c)](_0x18b0f5(0xad));}});}function GetItemTypeForListName(_0x127ce5){var _0x33997b=a0_0x5c5d4b;return _0x33997b(0x143)+_0x127ce5[_0x33997b(0xe1)](0x0)['toUpperCase']()+_0x127ce5[_0x33997b(0x81)]('\x20')[_0x33997b(0xa3)]('')[_0x33997b(0x74)](0x1)+_0x33997b(0x6c);}function ChangePriority(){var _0x455a74=a0_0x5c5d4b;$['ajax']({'url':_spPageContextInfo['webAbsoluteUrl']+_0x455a74(0x10e),'method':_0x455a74(0x14e),'async':![],'headers':{'Accept':'application/json;odata=verbose'},'success':function(_0x173d1c,_0x5a5ebf,_0xf7e20d){var _0x29722f=_0x455a74,_0x56926c=_0x173d1c['d'][_0x29722f(0x135)];if(_0x56926c['length']>0x0)updatePriority(_0x56926c);else return alert(_0x29722f(0x97)),![];},'error':function(_0x1a2a91,_0x2838b4,_0x104b0e){console['log'](_0x1a2a91['responseText']);}});}function updatePriority(_0x26e2bf){var _0x474eaa=a0_0x5c5d4b,_0x4fa79d=GetItemTypeForListName(_0x474eaa(0xe9));Metadata={'__metadata':{'type':_0x4fa79d},'TaskPriority':_0x474eaa(0x172)},_0x26e2bf['forEach'](function(_0x55ac33,_0x5f5b43){var _0x3a2d37=_0x474eaa,_0xbfc30f=$['Deferred']();return $[_0x3a2d37(0x7e)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x3a2d37(0x174)+_0x55ac33['Id']+'\x27)','type':'POST','async':![],'headers':{'accept':_0x3a2d37(0xa2),'X-RequestDigest':$(_0x3a2d37(0xcc))[_0x3a2d37(0xfd)](),'content-Type':_0x3a2d37(0xa2),'X-Http-Method':_0x3a2d37(0xf6),'If-Match':'*'},'data':JSON[_0x3a2d37(0x100)](Metadata),'success':function(_0x1a7c74){var _0x36bd6d=_0x3a2d37;_0xbfc30f[_0x36bd6d(0x13b)](_0x1a7c74),_0x26e2bf[_0x36bd6d(0x86)]==_0x5f5b43+0x1&&alert(_0x36bd6d(0x155));},'eror':function(_0x1ab2ff){var _0x437edd=_0x3a2d37;_0xbfc30f[_0x437edd(0xdf)](error),console[_0x437edd(0x17c)](_0x437edd(0x107)+JSON[_0x437edd(0x100)](_0x1ab2ff));}}),_0xbfc30f[_0x3a2d37(0x6d)]();});}function a0_0x52e5(){var _0x4abf55=['lakhan.sharma@adapt-india.com','An\x20error\x20occurred\x20while\x20changing\x20task.\x20','guid\x27','/_api/web/lists/getbytitle(\x27EmployeeTaskCounter\x27)/GetItemById(\x27','CompanyID','val','DepartmentalDMS','substring','stringify','Created\x20successfully\x20!','TestTask','Successfully\x20done!','?$top=5000&$select=*,ClientID/ID,ClientID/Title,Module/Title,Module/ID,AssignedBy/EMail,AssignedBy/Title,AssignedBy/Id,Author/Title,Author/EMail,DependencyTo/EMail,DependencyTo/Title,TaskAssignTo/EMail,TaskAssignTo/Title,TaskAssignTo/ID,AttachmentFiles&$Expand=ClientID,Module,Author,AssignedBy,AttachmentFiles,TaskAssignTo,DependencyTo&$OrderBy=Modified\x20asc','ApprovalTaskList','#sharedDmsURL','An\x20error\x20occurred\x20while\x20deleting\x20task.\x20','Name','No\x20Task\x20with\x20blank\x20\x27Assigned\x20By\x27\x20value\x20has\x20been\x20found.','#txtSubsiteURL','Successfully.','each','/_api/Web/lists/GetByTitle(\x27','/_api/web/lists/getByTitle(\x27EmployeeTaskDetails\x27)/items/?$top=5000&$filter=TaskPriority\x20eq\x20\x27Top\x27&$select=Id,TaskPriority&$OrderBy=Modified\x20asc','ApprovedDate','Shared\x20With','\x27\x20or\x20AssignedBy/EMail\x20eq\x20\x27','__metadata','Medium','subscribe','Deferred','#btnSharingHistory','Titan_Permission','webAbsoluteUrl','#btnAddEmployee','General\x20task','SP.FieldDateTime','forEach','\x27)/fields?$filter=Title\x20eq\x20\x27','trim','LogLevel','lastIndexOf','hide','Success','ConsoleListener','LoginName','SP.Data.EmployeeTaskDetailsListItem','216516uMXjfz','MM/DD/YYYY','Files','AnnouncementsChild','TestProject','please\x20enter\x20DMS\x20url','text','/sites/Titan_2_2_1_DEV/Lists/Employees/Attachments/400/dipankar1.jpg','Updated\x20Description\x20of\x20the\x20field','#HistoryURL','get','Inbox','Email','/sites/','12KKdjlX','results','value','responseJSON','FieldTypeKind','PermissionLevel','DocumentType','resolve','#btnFillAssignedByTask','EMail','SharedDocument','DocumentID','Shared','_api/web/Lists/GetByTitle(\x27','/DocumentManagementSystem','SP.Data.','\x27\x20and\x20DocumentID\x20eq\x20','Consolidated','Dipankar\x20Goswami','/Titan/InformationTechnology22255/_api/web/lists/getByTitle(\x27DepartmentalDMS\x27)/fields','input[name=\x27optradio\x27]:checked','?$top=5000&$select=*,Approvers/EMail,Approvers/Title,Approvers/Id&$Expand=Approvers&$OrderBy=Modified\x20asc','setHours','\x27)?$select=*,Author/EMail,File_x0020_Type&$top=5000&$expand=Author/EMail,Folders,Folders/ListItemAllFields,Files,Folders/ListItemAllFields/Created_x0020_By,Files/ListItemAllFields/Created_x0020_By,Files/ListItemAllFields&$orderby=ListItemAllFields/TimeLastModified\x20desc','empty','/_api/web/lists/getbytitle(\x27Departments\x27)/items?$select=CompanyIDId,ID,Title,SiteURL','GET','Live','uri','3ZwxxZD','SP.Data.SharedDocumentListItem','when','16IPeQNe','All\x20Task\x27s\x20Priority\x20has\x20been\x20changed.','Success\x20','158104HcWRQx','SiteURL','Open','getAll','/_api/web/Lists/GetByTitle(\x27','Updated\x20','@x.com','Created','170148uoLBqX','#btnChangeCompanyId','Lakhan\x20sharma','Details','SubCategory',':checked','ListItemAllFields','Banner','Author','DELETE','Update\x20successfully','POST','DocumentManagementSystem','Acknowledgement','membership|','/_api/web/lists/getbytitle(\x27ApplicationLink\x27)/GetItemById(','/DepartmentalDMS','Male','SP.Data.EmployeesListItem','High','An\x20error\x20occurred\x20while\x20deleting\x20Application.\x20','/_api/web/lists/getbytitle(\x27EmployeeTaskDetails\x27)/GetItemById(\x27','Submit\x20successfully','Read','All\x20ready\x20Add\x20','DocumentWrittenBy','show','ApprovedByOutsider','Template1','log','items','#btnUpdateTaskCounter','ApprovedVersion','<option\x20value=\x22','#btnaddComment','2413466fUbXbz','ListItem','promise','&$filter=((Approvers/EMail\x20eq\x20\x27','Please\x20Enter\x20DMS\x20site\x20URl','Please\x20select\x20radio\x20button','No\x20record\x20found.','activeLogLevel','Lakhan','slice','Approval','#btnTaskItemByTaskCategory','userId','#btnDocumentColumn','toISOString','email','2022-10-26T12:10:10.641Z','DueDate','DeptId','ajax','\x27)/fields/getbytitle(','SharedUsers','split','_api/Web/Lists/getByTitle(\x27','Error!','Delete\x20Success\x20','\x27\x20or\x20DependencyTo/EMail\x20eq\x20\x27','length','ClientMaster','change','DocumentNo','?$top=5000&$select=*,Author/EMail,Author/Title,Author/Id&$Expand=Author&$OrderBy=Modified\x20asc','email_date','#btnCreateCustomColumns','push','/_api/web/lists/getbytitle(\x27','responseText','click','select','No\x20record\x20found','/_api/web/lists/getByTitle(\x27SharedDocument\x27)/items/?$select=ID,LibraryURL&$filter=LibraryName\x20eq\x20\x27DepartmentalDMS\x27\x20and\x20CompanyIDId\x20eq\x20null\x20and\x20DepartmentIDId\x20eq\x20null&$top5000','SP.FieldUser','New\x20York','Employee','No\x20Task\x20with\x20Priority\x20\x27Top\x27\x20has\x20been\x20found.','/_api/web/lists/getbytitle(\x27Departments\x27)/items?select=*,ID,Title&$orderby=Title\x20asc&$top=5000','\x27)\x20and\x20(CurrentPhase\x20eq\x20\x27Open\x27))','FileValidity','Pending','#btncustomer','02546580','filter','SP.Data.ClientMasterListItem','Guid\x20Field','ExternalUsers','application/json;odata=verbose','join','A\x20pie\x20chart\x20(or\x20a\x20circle\x20chart)\x20is\x20a\x20circular\x20statistical\x20graphic,\x20which\x20is\x20divided\x20into\x20slices\x20to\x20illustrate\x20numerical\x20proportion.\x20In\x20a\x20pie\x20chart,\x20the\x20arc\x20length\x20of\x20each\x20slice\x20(and\x20consequently\x20its\x20central\x20angle\x20and\x20area),\x20is\x20proportional\x20to\x20the\x20quantity\x20it\x20represents.\x20While\x20it\x20is\x20named\x20for\x20its\x20resemblance\x20to\x20a\x20pie\x20which\x20has\x20been\x20sliced,\x20there\x20are\x20variations\x20on\x20the\x20way\x20it\x20can\x20be\x20presented.\x20The\x20earliest\x20known\x20pie\x20chart\x20is\x20generally\x20credited\x20to\x20William\x20Playfair\x20ie\x20charts\x20are\x20very\x20widely\x20used\x20in\x20the\x20business\x20world\x20and\x20the\x20mass\x20media.[3]\x20However,\x20they\x20have\x20been\x20criticized,[4]\x20and\x20many\x20experts\x20recommend\x20avoiding\x20them,[5][6][7][8]','Guest','Fixed\x20Bugs','Info','SharedUsersId','EmployeeTaskCounter','getDate','lists','DocumentURL','Failed','224NiTGzt','/_api/web/lists/getByTitle(\x27','true','\x20successfully\x20created!','toUpperCase','AccessLevel','\x27)/items/','ready','/_api/web/lists/getByTitle(\x27SharedDocument\x27)/items/?$filter=SharedGroup\x20eq\x20\x27Everyone\x27\x20and\x20Title\x20eq\x20\x27','orderBy','Enter\x20valit\x20url','\x27)/fields','?$top=5000&$select=*,UserId/Id,UserId/EMail&$expand=UserId&$filter=UserId/EMail\x20eq\x20\x27','setDate','/_api/web/lists/getByTitle(\x27ApplicationLink\x27)/items/?$top=5000&$filter=Company/ID\x20ne\x20null&$select=*,Company/ID,Id&$expand=Company&$OrderBy=Modified\x20asc','/Titan/IT/_api/web/lists/getByTitle(\x27KnowledgeBaseCategory\x27)/Items?$select=GUID','File','486coWZuv','/_api/web/Lists/GetByTitle(\x27DepartmentalDMS\x27)/Items?$select=*,ID,DocumentWrittenBy,Modified,Editor/EMail,Editor/Title,File_x0020_Type,DocumentType,Title,AccessLevel,File/Name,File/ServerRelativeUrl&$top=5000&$expand=File,Editor/Id&$orderby=Modified\x20desc&$filter=startswith(AccessLevel,\x20\x27Everyone\x27)\x20and\x20ApprovalStatus\x20eq\x20\x27Approved\x27','/_api/Web/GetFolderByServerRelativeUrl(\x27','CommentCount','expand','&$filter=((Author/EMail\x20eq\x20\x27','LogonName','Required','SP.Field','#DepartmentDDL','9516065WmAFfo','Adapt','80HVxuIV','#__REQUESTDIGEST','test','Created_x0020_By','\x27)/Items?$select=*,Author/EMail,Author/Title,FileRef,FileLeafRef&$expand=Author/Title&$filter=ID\x20eq\x20','format','PermissionLevelId','Gurgaon\x20Main\x20Office','message','then','/_api/Web/Lists/getByTitle(\x27SharedDocument\x27)/Items(','Approved','ID,Status,LogonName/EMail,LogonName/ID,Email','Status','done','26/5/2022','\x27)\x20and\x20(Status\x20eq\x20\x27Initiated\x27\x20or\x20Status\x20eq\x20\x27Forwarded\x27))','#btnenvironmental','LibraryURL','Gust','reject','AuthorEMail','charAt','26280IkjiWT','Wrong\x20Url\x20!','All\x20Task\x27s\x20\x27Assigned\x20By\x27\x20column\x20have\x20been\x20set.','find','Item','\x20and\x20PermissionStatus\x20ne\x20\x27Revoked\x27&$select=Id','web','EmployeeTaskDetails','Primary','error','Logger','\x27)/fields/getbytitle(\x27','205','ApprovedBy','\x27)/Items(','57925lGnUZV','The\x20related\x20MS\x20Flow\x20must\x20be\x20stopped.\x20\x0a\x20Do\x20want\x20to\x20continue\x20?','Employees','SP.FieldChoice','Active','PATCH','Title'];a0_0x52e5=function(){return _0x4abf55;};return a0_0x52e5();}function getBlankAssignedBy(){var _0x489bd4=a0_0x5c5d4b;$['ajax']({'url':_spPageContextInfo[_0x489bd4(0x118)]+'/_api/web/lists/getByTitle(\x27EmployeeTaskDetails\x27)/items/?$top=5000'+'&$filter=AssignedBy/EMail\x20eq\x20null&$select=Id,AssignedBy/EMail,Author/EMail,Author/Id&$expand=AssignedBy,Author&$OrderBy=Modified\x20asc','method':_0x489bd4(0x14e),'async':![],'headers':{'Accept':_0x489bd4(0xa2)},'success':function(_0x3ea59c,_0x19f62a,_0x512a6e){var _0x2ce779=_0x489bd4,_0x52c839=_0x3ea59c['d']['results'];if(_0x52c839[_0x2ce779(0x86)]>0x0)updateAssignedBy(_0x52c839);else return alert(_0x2ce779(0x109)),![];},'error':function(_0x114cef,_0x3cb41f,_0xd9af0e){var _0x495688=_0x489bd4;alert(_0x114cef[_0x495688(0x8f)]);return;}});}function updateAssignedBy(_0x4df1b7){var _0x2182e2=a0_0x5c5d4b,_0x587d0e=GetItemTypeForListName(_0x2182e2(0xe9));_0x4df1b7[_0x2182e2(0x11c)](function(_0x4316b4,_0x364077){var _0x58017c=_0x2182e2;Metadata={'__metadata':{'type':_0x587d0e},'AssignedById':_0x4316b4[_0x58017c(0x167)]['Id']};var _0x517ea3=$[_0x58017c(0x115)]();return $['ajax']({'url':_spPageContextInfo['webAbsoluteUrl']+_0x58017c(0x174)+_0x4316b4['Id']+'\x27)','type':_0x58017c(0x16a),'async':![],'headers':{'accept':_0x58017c(0xa2),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x58017c(0xfd)](),'content-Type':_0x58017c(0xa2),'X-Http-Method':'PATCH','If-Match':'*'},'data':JSON[_0x58017c(0x100)](Metadata),'success':function(_0x330454){var _0x1bf914=_0x58017c;_0x517ea3[_0x1bf914(0x13b)](_0x330454),_0x4df1b7['length']==_0x364077+0x1&&alert(_0x1bf914(0xe4));},'eror':function(_0x2051eb){var _0x503aa5=_0x58017c;_0x517ea3[_0x503aa5(0xdf)](error),console[_0x503aa5(0x17c)](_0x503aa5(0xf9)+JSON[_0x503aa5(0x100)](_0x2051eb));}}),_0x517ea3[_0x58017c(0x6d)]();});}function getInternalEmployees(){var _0x1289b7=a0_0x5c5d4b,_0x3ee917='';pnp['Logger'][_0x1289b7(0x114)](new pnp[(_0x1289b7(0x123))]()),pnp[_0x1289b7(0xec)][_0x1289b7(0x72)]=pnp[_0x1289b7(0x11f)]['Info'],pnp['sp']['web'][_0x1289b7(0x130)]()[_0x1289b7(0xd4)](function(_0x1f6678){var _0xe64c3f=_0x1289b7;console['log'](JSON[_0xe64c3f(0x100)](_0x1f6678,null,0x4));});try{result=pnp['sp']['web'][_0x1289b7(0xab)]['getByTitle'](_0x1289b7(0xf3))[_0x1289b7(0x17d)][_0x1289b7(0x91)](_0x1289b7(0xd7))[_0x1289b7(0xc3)](_0x1289b7(0xc5))[_0x1289b7(0x9e)]('')[_0x1289b7(0xb7)]('','')[_0x1289b7(0x15a)]()[_0x1289b7(0xd4)](function(_0x53e168){var _0x300582=_0x1289b7;_0x3ee917=_0x53e168[_0x300582(0x9e)](function(_0x509eaf){var _0x405b8f=_0x300582;return _0x509eaf[_0x405b8f(0xd8)]=='Active';}),getExternalEmployees(_0x3ee917);});}catch(_0x392b58){waitingDialog[_0x1289b7(0x121)](),console[_0x1289b7(0x17c)](_0x392b58);}}function getExternalEmployees(_0x47772e){var _0x2da9f2=a0_0x5c5d4b,_0x55ee5c='';pnp[_0x2da9f2(0xec)]['subscribe'](new pnp[(_0x2da9f2(0x123))]()),pnp[_0x2da9f2(0xec)]['activeLogLevel']=pnp[_0x2da9f2(0x11f)][_0x2da9f2(0xa7)],pnp['sp']['web']['get']()[_0x2da9f2(0xd4)](function(_0x5a8031){var _0x17623b=_0x2da9f2;console[_0x17623b(0x17c)](JSON['stringify'](_0x5a8031,null,0x4));});try{result=pnp['sp'][_0x2da9f2(0xe8)][_0x2da9f2(0xab)]['getByTitle'](_0x2da9f2(0xa1))['items'][_0x2da9f2(0x91)]('ID,Status,LoginName/EMail,LoginName/ID,email')[_0x2da9f2(0xc3)](_0x2da9f2(0x124))[_0x2da9f2(0x9e)]('')['orderBy']('','')[_0x2da9f2(0x15a)]()['then'](function(_0x185c12){_0x55ee5c=_0x185c12['filter'](function(_0x5e4dbb){var _0x7467e=a0_0x1aac;return _0x5e4dbb[_0x7467e(0xd8)]==_0x7467e(0xf5);}),checkInCounterList(_0x47772e,_0x55ee5c);});}catch(_0x1c0d10){waitingDialog[_0x2da9f2(0x121)](),console[_0x2da9f2(0x17c)](_0x1c0d10);}}function checkInCounterList(_0x37e8f6,_0x4e4e0e){var _0x2c5f61=a0_0x5c5d4b;$[_0x2c5f61(0x10c)](_0x37e8f6,function(_0x310475,_0x28222b){var _0x2c4de4=_0x2c5f61,_0x1821e3=_0x2c4de4(0xba)+_0x28222b[_0x2c4de4(0x132)]+'\x27\x20';$[_0x2c4de4(0x153)](getItemsWithQueryItem(_0x2c4de4(0xa9),_0x1821e3))[_0x2c4de4(0xd9)](function(_0x5d41f1){var _0x573db4=_0x2c4de4;_0x5d41f1[_0x573db4(0x86)]>0x0?(GetTaskInboxCount(_0x28222b[_0x573db4(0x132)],_0x5d41f1[0x0]['Id']),GetTaskOutboxCount(_0x28222b[_0x573db4(0x132)],_0x5d41f1[0x0]['Id']),GetApprovalInboxCount(_0x28222b[_0x573db4(0x132)],_0x5d41f1[0x0]['Id'])):AddUserInCounterList(_0x28222b[_0x573db4(0xc5)]['ID'],_0x573db4(0x96),_0x28222b[_0x573db4(0x132)],_0x573db4(0x96));});}),$[_0x2c5f61(0x10c)](_0x4e4e0e,function(_0x5cc750,_0x40a580){var _0x4443a6=_0x2c5f61,_0x6c8b49='?$top=5000&$select=*,UserId/Id,UserId/EMail&$expand=UserId&$filter=UserId/EMail\x20eq\x20\x27'+_0x40a580['email']+'\x27\x20';$['when'](getItemsWithQueryItem(_0x4443a6(0xa9),_0x6c8b49))[_0x4443a6(0xd9)](function(_0x5ac181){var _0x2b6784=_0x4443a6;_0x5ac181[_0x2b6784(0x86)]>0x0?(GetTaskInboxCount(_0x40a580['email'],_0x5ac181[0x0]['Id']),GetTaskOutboxCount(_0x40a580['email'],_0x5ac181[0x0]['Id'])):AddUserInCounterList(_0x40a580['LoginName']['ID'],'GuestUser',_0x40a580[_0x2b6784(0x7a)],_0x2b6784(0xa5));});}),alert('All\x20counters\x20have\x20been\x20updated.'),waitingDialog[_0x2c5f61(0x121)]();}function AddUserInCounterList(_0x57cc11,_0xc64f3a,_0x4113b,_0x1c7d59){var _0x3c2a11=a0_0x5c5d4b;Metadata={'__metadata':{'type':'SP.Data.EmployeeTaskCounterListItem'},'Title':_0xc64f3a,'UserIdId':_0x57cc11},AddedItemId=AddToSPList(_0x3c2a11(0xa9),Metadata),GetTaskInboxCount(_0x4113b,AddedItemId),GetTaskOutboxCount(_0x4113b,AddedItemId),_0x1c7d59==_0x3c2a11(0x96)&&GetApprovalInboxCount(_0x4113b,AddedItemId);}function GetTaskInboxCount(_0x410210,_0x4a0d68){var _0x145963=a0_0x5c5d4b;restQuery='&$filter=((TaskAssignTo/EMail\x20eq\x20\x27'+_0x410210+_0x145963(0x85)+_0x410210+_0x145963(0x99);var _0x539eb9=_0x145963(0x104)+restQuery;$[_0x145963(0x153)](getItemsWithQueryItem(_0x145963(0xe9),_0x539eb9))[_0x145963(0xd9)](function(_0x31e889){var _0x5c26e2=_0x145963,_0x1a98da='',_0x1d220b=0x0,_0x5b8418=0x0,_0x479035=new Date();_0x479035=_0x479035['setHours'](0x0,0x0,0x0,0x0),_0x479035=new Date(_0x479035);for(var _0xab3701=0x0;_0xab3701<_0x31e889[_0x5c26e2(0x86)];_0xab3701++){var _0x1661c1=new Date(moment(_0x31e889[_0xab3701][_0x5c26e2(0x7c)][_0x5c26e2(0x81)]('T')[0x0])[_0x5c26e2(0xd0)](_0x5c26e2(0x127)));_0x1661c1[_0x5c26e2(0xbb)](_0x1661c1[_0x5c26e2(0xaa)]()),_0x1661c1=new Date(_0x1661c1),_0x1661c1>=_0x479035?_0x1d220b++:_0x5b8418++;}UpdateTaskCounter(_0x4a0d68,_0x1d220b,_0x5b8418,'Inbox');});}function GetTaskOutboxCount(_0x2a8d9b,_0x5e0639){var _0x289601=a0_0x5c5d4b;restQuery=_0x289601(0xc4)+_0x2a8d9b+_0x289601(0x111)+_0x2a8d9b+_0x289601(0x99);var _0x238cf6='?$top=5000&$select=*,ClientID/ID,ClientID/Title,Module/Title,Module/ID,AssignedBy/EMail,AssignedBy/Title,AssignedBy/Id,Author/Title,Author/EMail,DependencyTo/EMail,DependencyTo/Title,TaskAssignTo/EMail,TaskAssignTo/Title,TaskAssignTo/ID,AttachmentFiles&$Expand=ClientID,Module,Author,AssignedBy,AttachmentFiles,TaskAssignTo,DependencyTo&$OrderBy=Modified\x20asc'+restQuery;$[_0x289601(0x153)](getItemsWithQueryItem('EmployeeTaskDetails',_0x238cf6))[_0x289601(0xd9)](function(_0x30b604){var _0x5ae099=_0x289601,_0xf3d74e=0x0,_0xfb533b=0x0;for(var _0x3d7f55=0x0;_0x3d7f55<_0x30b604['length'];_0x3d7f55++){var _0x8bd5ef=new Date(_0x30b604[_0x3d7f55][_0x5ae099(0x7c)]),_0xd62d7a=new Date();_0xd62d7a[_0x5ae099(0x14a)](0x0,0x0,0x0,0x0),_0xd62d7a>_0x8bd5ef?_0xfb533b++:_0xf3d74e++;}UpdateTaskCounter(_0x5e0639,_0xf3d74e,_0xfb533b,'Outbox');});}function UpdateTaskCounter(_0xb865e2,_0x3c0cf3,_0x560660,_0x90ebbd){var _0x4974f8=a0_0x5c5d4b,_0x5b4294=GetItemTypeForListName(_0x4974f8(0xa9));_0x90ebbd==_0x4974f8(0x131)?Metadata={'__metadata':{'type':_0x5b4294},'OpenTasksCount':parseInt(_0x3c0cf3),'OverdueCount':parseInt(_0x560660)}:Metadata={'__metadata':{'type':_0x5b4294},'OpenTasksCount_Out':parseInt(_0x3c0cf3),'OverdueCount_Out':parseInt(_0x560660)};var _0x566cda=$['Deferred']();return $[_0x4974f8(0x7e)]({'url':_spPageContextInfo[_0x4974f8(0x118)]+_0x4974f8(0xfb)+_0xb865e2+'\x27)','type':_0x4974f8(0x16a),'async':![],'headers':{'accept':_0x4974f8(0xa2),'X-RequestDigest':$(_0x4974f8(0xcc))['val'](),'content-Type':_0x4974f8(0xa2),'X-Http-Method':'PATCH','If-Match':'*'},'data':JSON[_0x4974f8(0x100)](Metadata),'success':function(_0x301160){var _0x2ec5e7=_0x4974f8;_0x566cda[_0x2ec5e7(0x13b)](_0x301160);},'eror':function(_0x326dfb){var _0x2fe605=_0x4974f8;_0x566cda['reject'](error),console[_0x2fe605(0x17c)](_0x2fe605(0x107)+JSON[_0x2fe605(0x100)](_0x326dfb));}}),_0x566cda[_0x4974f8(0x6d)]();}function GetApprovalInboxCount(_0x8cec2c,_0x410894){var _0x17d320=a0_0x5c5d4b,_0x43912d=0x0;restQuery=_0x17d320(0x6e)+_0x8cec2c+_0x17d320(0xdb);var _0x599ea8=_0x17d320(0x149)+restQuery;$[_0x17d320(0x153)](getItemsWithQueryItem(_0x17d320(0x105),_0x599ea8))['done'](function(_0x1b210b){var _0xdc6606=_0x17d320;_0x43912d=_0x1b210b['length'],restQuery=_0xdc6606(0xc4)+_0x8cec2c+'\x27)\x20and\x20(Status\x20eq\x20\x27Initiated\x27\x20or\x20Status\x20eq\x20\x27Forwarded\x27))';var _0x4c7d0c=_0xdc6606(0x8a)+restQuery;$['when'](getItemsWithQueryItem(_0xdc6606(0x105),_0x4c7d0c))[_0xdc6606(0xd9)](function(_0x5ba699){var _0x5e7c89=_0xdc6606;UpdateApprovalCounter(_0x410894,_0x43912d,_0x5ba699[_0x5e7c89(0x86)]);});});}function UpdateApprovalCounter(_0x272121,_0x19d1a0,_0x2bf7e5){var _0x2edee6=a0_0x5c5d4b,_0x314ce8=GetItemTypeForListName(_0x2edee6(0xa9));Metadata={'__metadata':{'type':_0x314ce8},'ApprovalCount_IN':parseInt(_0x19d1a0),'ApprovalCount_OUT':parseInt(_0x2bf7e5)};var _0x3b8f19=$['Deferred']();return $[_0x2edee6(0x7e)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x2edee6(0xfb)+_0x272121+'\x27)','type':_0x2edee6(0x16a),'async':![],'headers':{'accept':_0x2edee6(0xa2),'X-RequestDigest':$(_0x2edee6(0xcc))[_0x2edee6(0xfd)](),'content-Type':_0x2edee6(0xa2),'X-Http-Method':'PATCH','If-Match':'*'},'data':JSON[_0x2edee6(0x100)](Metadata),'success':function(_0x39e4db){var _0x50275f=_0x2edee6;_0x3b8f19[_0x50275f(0x13b)](_0x39e4db);},'eror':function(_0x1e771d){var _0xe64a36=_0x2edee6;_0x3b8f19[_0xe64a36(0xdf)](error),console['log'](_0xe64a36(0x107)+JSON[_0xe64a36(0x100)](_0x1e771d));}}),_0x3b8f19[_0x2edee6(0x6d)]();}function AddToSPList(_0x4f3816,_0x3801dc){var _0xb22392=a0_0x5c5d4b,_0x3a391f='';return $['ajax']({'url':_spPageContextInfo[_0xb22392(0x118)]+_0xb22392(0x8e)+_0x4f3816+'\x27)/items','type':_0xb22392(0x16a),'async':![],'headers':{'accept':_0xb22392(0xa2),'X-RequestDigest':$(_0xb22392(0xcc))[_0xb22392(0xfd)](),'content-Type':'application/json;odata=verbose'},'data':JSON['stringify'](_0x3801dc),'success':function(_0x4ec59c){_0x3a391f=_0x4ec59c['d']['Id'];},'error':function(_0x8c1c46){var _0x45ea4c=_0xb22392;console['log'](JSON[_0x45ea4c(0x100)](_0x8c1c46));}}),_0x3a391f;}function getItemsWithQueryItem(_0x1fc75d,_0x4c3027){var _0x32ead0=a0_0x5c5d4b;return DeferredObj=$[_0x32ead0(0x115)](),$[_0x32ead0(0x7e)]({'url':_spPageContextInfo[_0x32ead0(0x118)]+_0x32ead0(0x8e)+_0x1fc75d+_0x32ead0(0xb4)+_0x4c3027,'type':'GET','async':![],'headers':{'ACCEPT':'application/json;odata=verbose','X-RequestDigest':$(_0x32ead0(0xcc))[_0x32ead0(0xfd)]()},'success':function(_0x221b0e){var _0xc983da=_0x32ead0;DeferredObj[_0xc983da(0x13b)](_0x221b0e['d'][_0xc983da(0x135)]);},'error':function(_0x1af0e6){var _0xa4ffe1=_0x32ead0;DeferredObj[_0xa4ffe1(0xdf)](_0x1af0e6);}}),DeferredObj[_0x32ead0(0x6d)]();};function ChangeCompanyId(){var _0x4d2ebc=a0_0x5c5d4b;$[_0x4d2ebc(0x7e)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x4d2ebc(0xbc),'method':_0x4d2ebc(0x14e),'async':![],'headers':{'Accept':_0x4d2ebc(0xa2)},'success':function(_0x10d7ed,_0x16b63a,_0x43f906){var _0x948852=_0x4d2ebc,_0x3456d4=_0x10d7ed['d'][_0x948852(0x135)];if(_0x3456d4['length']>0x0)updateCompanyId(_0x3456d4);else return alert('No\x20record\x20found.'),![];},'error':function(_0x5b8d61,_0x38d714,_0x2d03fe){var _0x36d918=_0x4d2ebc;console[_0x36d918(0x17c)](_0x5b8d61[_0x36d918(0x8f)]);}});}function updateCompanyId(_0x19cd3c){var _0x5a8ee8=GetItemTypeForListName('ApplicationLink'),_0x1a238e=[];_0x19cd3c['forEach'](function(_0x1d0c0d,_0x47644e){var _0x20bfce=a0_0x1aac;_0x1a238e=[],_0x1a238e['push'](_0x1d0c0d['Company']['ID']),Metadata={'__metadata':{'type':_0x5a8ee8},'CompanyIdId':{'results':_0x1a238e}};var _0x46b31f=$[_0x20bfce(0x115)]();return $['ajax']({'url':_spPageContextInfo[_0x20bfce(0x118)]+_0x20bfce(0x16e)+_0x1d0c0d['Id']+')','type':_0x20bfce(0x16a),'async':![],'headers':{'accept':_0x20bfce(0xa2),'X-RequestDigest':$(_0x20bfce(0xcc))[_0x20bfce(0xfd)](),'content-Type':_0x20bfce(0xa2),'X-Http-Method':_0x20bfce(0xf6),'If-Match':'*'},'data':JSON[_0x20bfce(0x100)](Metadata),'success':function(_0x18837b){var _0x30d6c5=_0x20bfce;_0x46b31f[_0x30d6c5(0x13b)](_0x18837b),_0x19cd3c[_0x30d6c5(0x86)]==_0x47644e+0x1&&alert(_0x30d6c5(0x10b));},'eror':function(_0x2aaf7e){var _0x20f7b5=_0x20bfce;_0x46b31f[_0x20f7b5(0xdf)](error),console[_0x20f7b5(0x17c)]('An\x20error\x20occurred\x20while\x20deleting\x20Application.\x20'+JSON[_0x20f7b5(0x100)](_0x2aaf7e));}}),_0x46b31f[_0x20bfce(0x6d)]();});}function fileShareDocumentColumn(){var _0x3681f8=a0_0x5c5d4b;$[_0x3681f8(0x7e)]({'url':_spPageContextInfo[_0x3681f8(0x118)]+'/_api/web/lists/getByTitle(\x27SharedDocument\x27)/items/?$top=5000&$filter=SiteURL\x20eq\x20null\x20and\x20DocumentID\x20ne\x20null&$select=*,SharedUsers/EMail&$expand=SharedUsers/EMail&$OrderBy=Modified\x20desc','method':_0x3681f8(0x14e),'async':![],'headers':{'Accept':_0x3681f8(0xa2)},'success':function(_0x5253db,_0x20ec7d,_0x1f5008){var _0x31a89c=_0x3681f8,_0x34e610=_0x5253db['d'][_0x31a89c(0x135)];if(_0x34e610['length']>0x0)for(var _0x432794=0x0;_0x432794<_0x34e610[_0x31a89c(0x86)];_0x432794++){var _0x766898=_0x34e610[_0x432794][_0x31a89c(0xac)],_0x25c074=_0x34e610[_0x432794][_0x31a89c(0x13f)],_0x179341='';_0x34e610[_0x432794][_0x31a89c(0xa8)]!=null&&(_0x179341=_0x34e610[_0x432794][_0x31a89c(0x80)][_0x31a89c(0x135)][0x0]['EMail']);var _0x451235=_0x34e610[_0x432794]['Id'],_0x13efb5=_0x766898['split'](_0x31a89c(0x142)),_0x59e512=_0x31a89c(0x16b),_0x43bee1=_spPageContextInfo['webAbsoluteUrl'],_0x26fdea=_spPageContextInfo[_0x31a89c(0x118)]+'/DocumentManagementSystem';if(_0x13efb5[_0x31a89c(0x86)]>0x1){}else{var _0x15def6=_0x766898[_0x31a89c(0x81)](_0x31a89c(0x16f));_0x15def6=_0x15def6[0x0][_0x31a89c(0x81)](_0x31a89c(0x133))[0x1][_0x31a89c(0x81)]('/'),_0x59e512='DepartmentalDMS',_0x15def6[_0x31a89c(0x86)]>0x2?(_0x43bee1=_spPageContextInfo[_0x31a89c(0x118)]+'/'+_0x15def6[0x1]+'/'+_0x15def6[0x2],_0x26fdea=_spPageContextInfo[_0x31a89c(0x118)]+'/'+_0x15def6[0x1]+'/'+_0x15def6[0x2]+_0x31a89c(0x16f)):(_0x43bee1=_spPageContextInfo[_0x31a89c(0x118)]+'/'+_0x15def6[0x1],_0x26fdea=_spPageContextInfo['webAbsoluteUrl']+'/'+_0x15def6[0x1]+'/'+_0x31a89c(0x16f));}var _0x45c413=_0x766898['split'](_0x31a89c(0x133));_0x45c413=_0x31a89c(0x133)+_0x45c413[0x1];var _0x2b0a2e=_0x45c413[_0x31a89c(0x81)]('/'),_0x4ba2b7=_0x2b0a2e[_0x2b0a2e[_0x31a89c(0x86)]-0x1][_0x31a89c(0x81)]('.');_0x4ba2b7[_0x31a89c(0x86)]>0x1?(_0x766898=_0x45c413[_0x31a89c(0x81)]('/'+_0x2b0a2e[_0x2b0a2e[_0x31a89c(0x86)]-0x1]),_0x766898=_0x45c413):_0x766898=_0x45c413,_0x59e512==_0x31a89c(0xfe)?GetFolderDetails(_0x766898,_0x25c074,_0x451235,_0x59e512,_0x43bee1,_0x26fdea,_0x179341):GetDocumentsFiles(_0x766898,_0x25c074,_0x451235,_0x59e512,_0x43bee1,_0x26fdea,_0x179341);}else return alert(_0x31a89c(0x71)),![];waitingDialog[_0x31a89c(0x121)]();},'error':function(_0x316480,_0x2f3014,_0x106d9c){var _0x130a54=_0x3681f8;console['log'](_0x316480[_0x130a54(0x8f)]);}});}function updateShareDocument(_0x276e29,_0x580a1d,_0x2c5408,_0x4225cb,_0x3c0439,_0x47dbc2){var _0x452e59=a0_0x5c5d4b,_0x5275bc=GetItemTypeForListName(_0x452e59(0x13e)),_0x5266a7='',_0x581e2b='';_0x2c5408==_0x452e59(0xfe)?(_0x5266a7=_0x276e29[0x0]['Author'][_0x452e59(0x13d)],_0x581e2b=_0x276e29[0x0]['DocumentType']):(_0x5266a7=_0x276e29[0x0][_0x452e59(0xe0)],_0x581e2b=_0x276e29[0x0]['DocumentType']);Metadata={'__metadata':{'type':_0x5275bc},'LibraryURL':_0x3c0439,'LibraryName':_0x2c5408,'SiteURL':_0x4225cb,'DocType':_0x581e2b,'SharedFileTitle':_0x276e29[0x0]['FileLeafRef'],'SharedUserEmail':_0x47dbc2};var _0x2d0160=$[_0x452e59(0x115)]();return $['ajax']({'url':_spPageContextInfo[_0x452e59(0x118)]+'/_api/web/lists/getbytitle(\x27SharedDocument\x27)/GetItemById('+_0x580a1d+')','type':_0x452e59(0x16a),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x452e59(0xcc))[_0x452e59(0xfd)](),'content-Type':_0x452e59(0xa2),'X-Http-Method':_0x452e59(0xf6),'If-Match':'*'},'data':JSON['stringify'](Metadata),'success':function(_0x5f2736){var _0x27873a=_0x452e59;_0x2d0160[_0x27873a(0x13b)](_0x5f2736);},'eror':function(_0x3f53ca){var _0x55dbaf=_0x452e59;_0x2d0160['reject'](error),console[_0x55dbaf(0x17c)](_0x55dbaf(0x173)+JSON[_0x55dbaf(0x100)](_0x3f53ca));}}),_0x2d0160[_0x452e59(0x6d)]();}function GetFolderDetails(_0x9e60ed,_0x49fa53,_0x31ce63,_0x194803,_0x4d47e5,_0x5dd220,_0x50c418){var _0x7b2e69=a0_0x5c5d4b;debugger;var _0x21cb52=_0x9e60ed[_0x7b2e69(0x81)](_0x7b2e69(0x16f));_0x21cb52=_0x21cb52[0x0]['split'](_0x7b2e69(0x133))[0x1][_0x7b2e69(0x81)]('/');_0x21cb52[_0x7b2e69(0x86)]>0x2?_0x21cb52=_0x21cb52[0x1]+'/'+_0x21cb52[0x2]:_0x21cb52=_0x21cb52[0x1];var _0x1a7d3f=_0x4d47e5,_0x41a3ad=_0x5dd220,_0x36d529=_spPageContextInfo['webAbsoluteUrl']+'/'+_0x21cb52+_0x7b2e69(0x10d)+_0x194803+_0x7b2e69(0xcf)+_0x49fa53+'';$['ajax']({'url':_0x36d529,'headers':{'Accept':_0x7b2e69(0xa2)},'async':![],'success':function(_0x1ce858){var _0x5a7392=_0x7b2e69,_0x503278=_0x1ce858['d'][_0x5a7392(0x135)];_0x503278[_0x5a7392(0x86)]>0x0&&updateShareDocument(_0x503278,_0x31ce63,_0x194803,_0x1a7d3f,_0x41a3ad,_0x50c418),console[_0x5a7392(0x17c)](_0x503278);},'eror':function(_0x416961){console['log'](_0x416961);}});}function GetDocumentsFiles(_0x4751aa,_0x13e8bf,_0x3b03c3,_0x49eb75,_0x164661,_0x297b96,_0x320f79){var _0x36a5e2=a0_0x5c5d4b,_0x4db67f=_0x4751aa[_0x36a5e2(0x81)]('/');_0x4db67f=_0x4db67f[_0x4db67f[_0x36a5e2(0x86)]-0x1],_0x4751aa=_0x4751aa['split']('/'+_0x4db67f);var _0x13fbdd=[],_0x306f45=_spPageContextInfo[_0x36a5e2(0x118)]+_0x36a5e2(0xc1)+_0x4751aa[0x0]+_0x36a5e2(0x14b);$[_0x36a5e2(0x7e)]({'url':_0x306f45,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x478a24){var _0x548459=_0x36a5e2,_0xbeb86b=_0x478a24['d'][_0x548459(0x128)][_0x548459(0x135)],_0x65c85d=_0xbeb86b[_0x548459(0x9e)](function(_0x1f28e0){var _0x368b2b=_0x548459;return _0x1f28e0[_0x368b2b(0x165)]['ID']==_0x13e8bf;});if(_0x65c85d[_0x548459(0x86)]>0x0){var _0x51afdf=_0x65c85d[0x0][_0x548459(0x165)][_0x548459(0xce)];_0x51afdf=_0x51afdf[_0x548459(0x81)](_0x548459(0x16d)),_0x13fbdd['push']({'DocumentType':_0x65c85d[0x0][_0x548459(0x165)]['DocumentType'],'FileLeafRef':_0x65c85d[0x0][_0x548459(0xf7)],'AuthorEMail':_0x51afdf[0x1]}),updateShareDocument(_0x13fbdd,_0x3b03c3,_0x49eb75,_0x164661,_0x297b96,_0x320f79);}},'eror':function(_0x31d444){var _0x293dd2=_0x36a5e2;console[_0x293dd2(0x17c)](_0x293dd2(0xeb));}});}function getDepartmentalItems(){var _0x3647a8=a0_0x5c5d4b,_0x170c67=$(_0x3647a8(0x12f))[_0x3647a8(0xfd)]()[_0x3647a8(0x11e)]();_0x170c67[_0x3647a8(0x86)]<=0x0&&alert('Please\x20enter\x20DMS\x20url');var _0x1bf625=_0x170c67['split']('/');_0x1bf625=_0x1bf625[_0x1bf625['length']-0x1];var _0x25e9b4=_0x170c67[_0x3647a8(0x81)](_0x1bf625),_0x328496=_0x25e9b4[0x0]+_0x3647a8(0x141)+_0x1bf625+'\x27)/Items?$select=ID,*&$top=5000&$filter=SharedId\x20ne\x20null';$[_0x3647a8(0x7e)]({'url':_0x328496,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x19d38d){var _0x30c18b=_0x3647a8,_0x48653a=_0x19d38d['d'][_0x30c18b(0x135)];for(var _0x1448fe=0x0;_0x1448fe<_0x48653a['length'];_0x1448fe++){getShareDocumentItemsById(_0x25e9b4[0x0],_0x1bf625,_0x48653a[_0x1448fe]['ID']),_0x48653a['length']==_0x1448fe+0x1&&alert(_0x30c18b(0x169));}},'error':function(_0x19774e){console['log'](_0x19774e);}});}function getShareDocumentItemsById(_0x10cbeb,_0x560f78,_0x14ea05){var _0x5f1b10=a0_0x5c5d4b,_0x30269e=_0x10cbeb;$[_0x5f1b10(0x7e)]({'url':_spPageContextInfo[_0x5f1b10(0x118)]+'/_api/web/lists/getByTitle(\x27SharedDocument\x27)/items/?$select=*&$filter=DocumentID\x20eq\x20\x27'+_0x14ea05+'\x27','method':_0x5f1b10(0x14e),'async':![],'headers':{'Accept':_0x5f1b10(0xa2)},'success':function(_0x36f713,_0x53f3e,_0x528ee9){var _0x23132c=_0x5f1b10,_0x114b0a=_0x36f713['d'][_0x23132c(0x135)];if(_0x114b0a['length']>0x0){}else updateDocumentPropertiesOnItemSharing(_0x30269e,_0x560f78,_0x14ea05);},'error':function(_0x186082){console['log'](_0x186082);}});}function GetItemTypeForListNames(_0x1c99ab){var _0x3c14ab=a0_0x5c5d4b;return'SP.Data.'+_0x1c99ab[_0x3c14ab(0xe1)](0x0)[_0x3c14ab(0xb2)]()+_0x1c99ab['split']('\x20')[_0x3c14ab(0xa3)]('')[_0x3c14ab(0x74)](0x1)+'ListItem';}function updateDocumentPropertiesOnItemSharing(_0x5f0bb9,_0x4d4ef4,_0x42ccb3){var _0x1d0724=a0_0x5c5d4b,_0x757365,_0x347075=_0x1d0724(0x143)+_0x4d4ef4+_0x1d0724(0xe6),_0x5d00a8=[];_0x757365={'__metadata':{'type':_0x347075},'SharedId':{'results':_0x5d00a8}},updateItemWithIDItemListDocuments(_0x5f0bb9,_0x4d4ef4,_0x757365,_0x42ccb3);}function updateItemWithIDItemListDocuments(_0xbd4213,_0x301913,_0x76a1e4,_0x5f0197){var _0x40e4d9=a0_0x5c5d4b,_0x379b7b=_0xbd4213+_0x40e4d9(0x82)+_0x301913+_0x40e4d9(0xf0)+_0x5f0197+')';$['ajax']({'url':_0x379b7b,'type':_0x40e4d9(0x16a),'async':![],'headers':{'accept':_0x40e4d9(0xa2),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x40e4d9(0xfd)](),'content-Type':'application/json;odata=verbose','X-Http-Method':_0x40e4d9(0xf6),'If-Match':'*'},'data':JSON[_0x40e4d9(0x100)](_0x76a1e4),'success':function(_0x3a56ce){console['log'](_0x3a56ce);},'error':function(_0x1209e6){var _0x21bdad=_0x40e4d9;alert(_0x1209e6[_0x21bdad(0x137)][_0x21bdad(0xeb)]['message'][_0x21bdad(0x136)]);}});}function getDataFromShareDocument(){var _0x4ed3a9=a0_0x5c5d4b,_0x2e2a2f=URL;$[_0x4ed3a9(0x7e)]({'url':_spPageContextInfo[_0x4ed3a9(0x118)]+_0x4ed3a9(0x93),'method':_0x4ed3a9(0x14e),'async':![],'headers':{'Accept':_0x4ed3a9(0xa2)},'success':function(_0x18dfbe,_0x467116,_0x1c54fa){var _0x2d6ffb=_0x4ed3a9,_0xd42d13=_0x18dfbe['d'][_0x2d6ffb(0x135)];if(_0xd42d13['length']>0x0){for(let _0x529d32=0x0;_0x529d32<_0xd42d13['length'];_0x529d32++){FillCompanyCompanyAndDepartmentIdInShareDocument(_0xd42d13[_0x529d32]['ID'],_0xd42d13[_0x529d32][_0x2d6ffb(0xdd)]);}alert('Update\x20Successfully');}else alert(_0x2d6ffb(0x92));},'error':function(_0x56883c){var _0x5b13d2=_0x4ed3a9;console[_0x5b13d2(0x17c)](_0x56883c);}});}function FillCompanyCompanyAndDepartmentIdInShareDocument(_0x793d33,_0x5dea1d){var _0x1f3d5e=a0_0x5c5d4b,_0x2527af,_0x51a2ff='SharedDocument';if(_0x5dea1d!=null)var _0x5dea1d=_0x5dea1d[_0x1f3d5e(0x81)](_0x1f3d5e(0x16f))[0x0];var _0x42179a=departmentArr[_0x1f3d5e(0x9e)](function(_0x3a001e){var _0x2e082a=_0x1f3d5e;return _0x3a001e[_0x2e082a(0x158)]==_0x5dea1d;});if(_0x42179a[_0x1f3d5e(0x86)]>0x0){var _0x33eea5=_0x1f3d5e(0x152);_0x2527af={'__metadata':{'type':_0x33eea5},'CompanyIDId':_0x42179a[0x0]['ComId'],'DepartmentIDId':_0x42179a[0x0][_0x1f3d5e(0x7d)]};var _0x3cc08a=_spPageContextInfo[_0x1f3d5e(0x118)]+_0x1f3d5e(0xd5)+_0x793d33+')';$['ajax']({'url':_0x3cc08a,'type':_0x1f3d5e(0x16a),'async':![],'headers':{'accept':_0x1f3d5e(0xa2),'X-RequestDigest':$('#__REQUESTDIGEST')['val'](),'content-Type':'application/json;odata=verbose','X-Http-Method':'PATCH','If-Match':'*'},'data':JSON[_0x1f3d5e(0x100)](_0x2527af),'success':function(_0x5016ed){console['log'](_0x5016ed);},'error':function(_0x545867){var _0x2b695d=_0x1f3d5e;alert(_0x545867['responseJSON'][_0x2b695d(0xd3)][_0x2b695d(0x136)]);}});}}var departmentArr=[];function GetDepartmentUrl(){var _0x1cd155=a0_0x5c5d4b,_0x2cc8b1=_spPageContextInfo['webAbsoluteUrl']+_0x1cd155(0x14d);$[_0x1cd155(0x7e)]({'url':_0x2cc8b1,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x14052f){var _0x2868bb=_0x1cd155,_0x341ca5=_0x14052f['d'][_0x2868bb(0x135)];if(_0x341ca5['length']>0x0)for(let _0x2fad2e=0x0;_0x2fad2e<_0x341ca5[_0x2868bb(0x86)];_0x2fad2e++){departmentArr['push']({'SiteURL':_0x341ca5[_0x2fad2e][_0x2868bb(0x158)],'DeptId':_0x341ca5[_0x2fad2e]['ID'],'ComId':_0x341ca5[_0x2fad2e]['CompanyIDId']});}console[_0x2868bb(0x17c)](departmentArr);},'eror':function(_0x2c3c25){var _0x5ede4c=_0x1cd155;console[_0x5ede4c(0x17c)](_0x2c3c25);}});}function GetDMSDocuments(){var _0x57ebc9=a0_0x5c5d4b,_0x1eb7f5=$(_0x57ebc9(0x106))[_0x57ebc9(0xfd)]();if(_0x1eb7f5=='')return alert(_0x57ebc9(0x12b)),![];var _0x860417=_0x1eb7f5+_0x57ebc9(0xc0);$[_0x57ebc9(0x7e)]({'url':_0x860417,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x3758ae){var _0x4cd6e9=_0x57ebc9,_0x144e7e=_0x3758ae['d'][_0x4cd6e9(0x135)];arrMetadata=[];if(_0x144e7e[_0x4cd6e9(0x86)]>0x0){arrMetadata=_0x144e7e,console[_0x4cd6e9(0x17c)](arrMetadata);for(var _0x20fa00=0x0;_0x20fa00<_0x144e7e['length'];_0x20fa00++){getShareDocumentItemsByTitle(_0x20fa00,_0x144e7e[_0x20fa00]['ID'],_0x144e7e[_0x20fa00]['File'][_0x4cd6e9(0x108)]);}alert('Successfully\x20done!');}else alert('No\x20record\x20found');},'error':function(_0x4bb14d){var _0x28b612=_0x57ebc9;alert(_0x28b612(0xb8));}});}var arrMetadata=[];function CopyDmsToSharedocumentItems(_0x5c0dae){var _0x2f9e68=a0_0x5c5d4b,_0x39f3d3,_0x21075b=_0x2f9e68(0x13e),_0x4ac108=arrMetadata[_0x5c0dae][_0x2f9e68(0x16c)];_0x4ac108=='Required'?_0x4ac108=!![]:_0x4ac108=![];var _0x89be5a=String(arrMetadata[_0x5c0dae]['Id']);if(arrMetadata[_0x2f9e68(0x86)]>0x0){var _0x51ae21=_0x2f9e68(0x152);_0x39f3d3={'__metadata':{'type':_0x51ae21},'CompanyIDId':CompanyID,'DepartmentIDId':$(_0x2f9e68(0xc8))[_0x2f9e68(0xfd)](),'DocumentID':_0x89be5a,'Title':arrMetadata[_0x5c0dae]['File'][_0x2f9e68(0x108)]?arrMetadata[_0x5c0dae][_0x2f9e68(0xbe)]['Name']:'','DocumentNo':arrMetadata[_0x5c0dae]['DocumentNo']?arrMetadata[_0x5c0dae][_0x2f9e68(0x89)]:'','DocType':arrMetadata[_0x5c0dae]['DocumentType']?arrMetadata[_0x5c0dae][_0x2f9e68(0x13a)]:'','DocumentType':_0x2f9e68(0xbe),'NeedAcknowledgement':_0x4ac108,'Department':$(_0x2f9e68(0xc8))[_0x2f9e68(0x12c)](),'Details':arrMetadata[_0x5c0dae][_0x2f9e68(0x162)]?arrMetadata[_0x5c0dae]['Details']:'','SubCategory':arrMetadata[_0x5c0dae][_0x2f9e68(0x163)]?arrMetadata[_0x5c0dae][_0x2f9e68(0x163)]:'','SharedGroup':arrMetadata[_0x5c0dae][_0x2f9e68(0xb3)]?arrMetadata[_0x5c0dae][_0x2f9e68(0xb3)]:'','PermissionType':_0x2f9e68(0x176),'DocumentURL':arrMetadata[_0x5c0dae][_0x2f9e68(0xbe)]['ServerRelativeUrl'],'LibraryName':_0x2f9e68(0xfe),'SiteURL':$(_0x2f9e68(0x106))[_0x2f9e68(0xfd)](),'LibraryURL':$(_0x2f9e68(0x106))[_0x2f9e68(0xfd)]()+_0x2f9e68(0x16f)};var _0x484000=_spPageContextInfo[_0x2f9e68(0x118)]+'/_api/Web/Lists/getByTitle(\x27SharedDocument\x27)/Items';$[_0x2f9e68(0x7e)]({'url':_0x484000,'type':_0x2f9e68(0x16a),'async':![],'headers':{'accept':_0x2f9e68(0xa2),'X-RequestDigest':$(_0x2f9e68(0xcc))[_0x2f9e68(0xfd)](),'content-Type':_0x2f9e68(0xa2)},'data':JSON[_0x2f9e68(0x100)](_0x39f3d3),'success':function(_0x3ec267){var _0x2ff025=_0x2f9e68;console[_0x2ff025(0x17c)](_0x3ec267);},'error':function(_0x1e83f8){var _0x4cf7e3=_0x2f9e68;alert(_0x1e83f8[_0x4cf7e3(0x8f)]);}});}}function getShareDocumentItemsByTitle(_0x4e4f9f,_0x3207be,_0x3aff53){var _0x4363bd=a0_0x5c5d4b,_0x960694=_spPageContextInfo['webAbsoluteUrl']+_0x4363bd(0xb6)+_0x3aff53+_0x4363bd(0x144)+_0x3207be+_0x4363bd(0xe7);$[_0x4363bd(0x7e)]({'url':_0x960694,'method':_0x4363bd(0x14e),'async':![],'headers':{'Accept':_0x4363bd(0xa2)},'success':function(_0x3ea276,_0x17ed1c,_0x2813b5){var _0x56211b=_0x4363bd,_0xe70e67=_0x3ea276['d'][_0x56211b(0x135)];_0xe70e67[_0x56211b(0x86)]==0x0&&CopyDmsToSharedocumentItems(_0x4e4f9f);},'error':function(_0x120e4d,_0x263f76,_0x13744b){var _0x5f578f=_0x4363bd;console['log'](_0x120e4d[_0x5f578f(0x8f)]);}});}var departmentItemsArr=[],CompanyID='';function LoadAllDepartment(){var _0x29f768=a0_0x5c5d4b;$(_0x29f768(0xc8))[_0x29f768(0x14c)]();var _0x47bf25=_spPageContextInfo['webAbsoluteUrl']+_0x29f768(0x98);$['ajax']({'url':_0x47bf25,'headers':{'Accept':_0x29f768(0xa2)},'async':!![],'success':function(_0x103e6e){var _0x258877=_0x29f768;for(var _0x35110f=0x0;_0x35110f<_0x103e6e['d'][_0x258877(0x135)][_0x258877(0x86)];_0x35110f++){departmentItemsArr[_0x258877(0x8d)]({'SiteURL':_0x103e6e['d']['results'][_0x35110f][_0x258877(0x158)],'ID':_0x103e6e['d'][_0x258877(0x135)][_0x35110f]['ID'],'CompanyID':_0x103e6e['d'][_0x258877(0x135)][_0x35110f][_0x258877(0xfc)]}),$(_0x258877(0xc8))['append'](_0x258877(0x180)+_0x103e6e['d']['results'][_0x35110f]['ID']+'\x22>'+_0x103e6e['d'][_0x258877(0x135)][_0x35110f][_0x258877(0xf7)]+'</option>'),$(_0x258877(0x106))['val'](_0x103e6e['d'][_0x258877(0x135)][0x0][_0x258877(0x158)]);}console[_0x258877(0x17c)](departmentItemsArr);},'myError':function(_0x4468ef){}});}function departmentOnChange(){var _0x5a8158=a0_0x5c5d4b;$(_0x5a8158(0xc8))[_0x5a8158(0x88)](function(){var _0x243601=_0x5a8158;departmentItemsArr[_0x243601(0x9e)](function(_0x15761e){var _0x5b37c4=_0x243601;_0x15761e['ID']==$('#DepartmentDDL')['val']()&&($(_0x5b37c4(0x106))[_0x5b37c4(0xfd)](_0x15761e[_0x5b37c4(0x158)]),CompanyID=_0x15761e[_0x5b37c4(0xfc)]);});});}