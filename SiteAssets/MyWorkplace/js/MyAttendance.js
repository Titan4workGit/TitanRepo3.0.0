var a0_0x491849=a0_0x3652;function a0_0xb3ff(){var _0x4ebbac=['#MyAttendance','getQueryStringParameter','ajax','/_api/web/lists/getbytitle(\x27Employees\x27)/items?$filter=LogonName\x20eq\x20(\x27','display','219020VSLgbT','7HRhGHd','AttendanceType','text','Attendance\x20has\x20been\x20saved.','modal','toggle','#Reports-menu>ul\x20li','dd/mm/yy','#HolidayMessage','stringify','29123568lKJrPs','\x27&$top=200&$orderby=Holiday_start\x20asc','disabled','Title','results','/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items(\x27','This\x20feature\x20has\x20been\x20deactivated\x20!','hide','SP.Data.EmpAttendanceListItem','inline-block','ManagerLoginNameId','#__REQUESTDIGEST','POST','1441815JkibXE','datepicker','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?$filter=OfficeLocationID\x20eq\x20(\x27','/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items','ready','length','none','MERGE','application/json;odata=verbose','Plese\x20select\x20proper\x20attandence.','1725234nvMLCF','#AttendanceDDL','#Submit-attendance','val','\x27\x20and\x20AttendanceDate\x20eq\x20\x27','This\x20is\x20a\x20Holiday,\x20are\x20you\x20sure\x20to\x20submit\x20your\x20attendance.','setDate','split','HrAction','Attendance\x20Entry','webAbsoluteUrl','Timesheet\x20Entry','prop','/_api/web/lists/getbytitle(\x27EmpAttendance\x27)/items?$filter=EmployeeId\x20eq\x20\x27','#HR-Message','800952bfKpWu','#timesheetdate','CompanyId','userId','75501lmJNTN','getMonth','Active','12ljhBAr','5277426mRnvLn','10VKANbw','log','GET','getFullYear','css','#Timesheet-toggle-li','456DiBlSj','An\x20error\x20occurred.\x20Please\x20try\x20again.','block','UpdateAttendance\x20function\x20failed','Attendance\x20function\x20failed','3CLZTVu','getDate','#HolidayMessagediv','Holiday','\x27\x20and\x20CompanyID\x20eq\x20\x27','\x27\x20\x20'];a0_0xb3ff=function(){return _0x4ebbac;};return a0_0xb3ff();}(function(_0x506542,_0x143c17){var _0x38dfe7=a0_0x3652,_0x47791a=_0x506542();while(!![]){try{var _0xf45d67=-parseInt(_0x38dfe7(0xf2))/0x1*(-parseInt(_0x38dfe7(0xad))/0x2)+parseInt(_0x38dfe7(0xde))/0x3*(-parseInt(_0x38dfe7(0xe5))/0x4)+-parseInt(_0x38dfe7(0xc5))/0x5+parseInt(_0x38dfe7(0xcf))/0x6*(-parseInt(_0x38dfe7(0xae))/0x7)+parseInt(_0x38dfe7(0xed))/0x8*(-parseInt(_0x38dfe7(0xe2))/0x9)+parseInt(_0x38dfe7(0xe7))/0xa*(-parseInt(_0x38dfe7(0xe6))/0xb)+parseInt(_0x38dfe7(0xb8))/0xc;if(_0xf45d67===_0x143c17)break;else _0x47791a['push'](_0x47791a['shift']());}catch(_0x2beae3){_0x47791a['push'](_0x47791a['shift']());}}}(a0_0xb3ff,0x66b5d));var Attendancechck=!![];$(document)[a0_0x491849(0xc9)](function(){authentication(),GetManagerID();});function Attendance(){var _0x4b1e39=a0_0x491849,_0x5db04b=_spPageContextInfo[_0x4b1e39(0xe1)];if(Attendancechck==![])return alert(_0x4b1e39(0xbe)),$(_0x4b1e39(0xa8))[_0x4b1e39(0xb2)](_0x4b1e39(0xb3)),![];var _0x5f4c45=new Date(ConvertDateTimeFormat($('#timesheetdate')[_0x4b1e39(0xd2)](),'/')),_0x86f72d=_0x5f4c45[_0x4b1e39(0xea)]()+'-'+(_0x5f4c45[_0x4b1e39(0xe3)]()+0x1)+'-'+_0x5f4c45[_0x4b1e39(0xf3)](),_0x4d71ab=_spPageContextInfo[_0x4b1e39(0xd9)]+_0x4b1e39(0xdc)+_0x5db04b+_0x4b1e39(0xd3)+_0x86f72d+_0x4b1e39(0xf7);$['ajax']({'url':_0x4d71ab,'headers':{'Accept':_0x4b1e39(0xcd)},'async':![],'success':function(_0xbf8133){var _0x3b3575=_0x4b1e39,_0x423154=_0xbf8133['d'][_0x3b3575(0xbc)];if(_0x423154['length']>0x0){if(G_Validateholiday==!![]){if(confirm(_0x3b3575(0xd4))){var _0x434e6d=_0x423154[0x0]['ID'];UpdateAttendance(_0x434e6d);}}else{var _0x434e6d=_0x423154[0x0]['ID'];UpdateAttendance(_0x434e6d);}}else G_Validateholiday==!![]?confirm(_0x3b3575(0xd4))&&SetAttendance():SetAttendance();},'error':function(_0x1889f4){var _0x3a7cd7=_0x4b1e39;console['log'](_0x3a7cd7(0xf1)),console[_0x3a7cd7(0xe8)](_0x1889f4);}});}function UpdateAttendance(_0x44199d){var _0x51db27=a0_0x491849,_0x53aa22=ConvertDateTimeFormat($(_0x51db27(0xdf))[_0x51db27(0xd2)](),'/');_0x53aa22=new Date(_0x53aa22);;var _0x44cc18=_spPageContextInfo[_0x51db27(0xe1)];$(_0x51db27(0xd0))[_0x51db27(0xd2)]()!='0'&&$(_0x51db27(0xd0))[_0x51db27(0xd2)]()!=_0x51db27(0xf5)||G_Validateholiday==!![]?$[_0x51db27(0xaa)]({'url':_spPageContextInfo[_0x51db27(0xd9)]+_0x51db27(0xbd)+_0x44199d+'\x27)','type':_0x51db27(0xc4),'data':JSON[_0x51db27(0xb7)]({'__metadata':{'type':_0x51db27(0xc0)},'Title':'Attendance','EmployeeId':_0x44cc18,'ManagerIDId':parseInt(G_ManagerID),'AttendanceType':$(_0x51db27(0xd0))[_0x51db27(0xd2)](),'AttendanceDate':_0x53aa22}),'headers':{'Accept':'application/json;odata=verbose','Content-Type':_0x51db27(0xcd),'X-RequestDigest':$(_0x51db27(0xc3))['val'](),'IF-MATCH':'*','X-HTTP-Method':_0x51db27(0xcc)},'success':function(_0x1c4778,_0x401225,_0x26226b){var _0x567a51=_0x51db27;alert('Attendance\x20has\x20been\x20saved.'),$(_0x567a51(0xa8))[_0x567a51(0xb2)](_0x567a51(0xb3)),$(_0x567a51(0xdf))[_0x567a51(0xc6)]({'dateFormat':'dd/mm/yy','maxDate':0x0})[_0x567a51(0xc6)](_0x567a51(0xd5),new Date());},'error':function(_0x19a24d){var _0x173aae=_0x51db27;console['log'](_0x173aae(0xf0)),console[_0x173aae(0xe8)](_0x19a24d);}}):alert('Plese\x20select\x20proper\x20attandence.');}function SetAttendance(){var _0x21692e=a0_0x491849,_0x32909b=ConvertDateTimeFormat($(_0x21692e(0xdf))[_0x21692e(0xd2)](),'/');_0x32909b=new Date(_0x32909b);;var _0x255ee6=_spPageContextInfo[_0x21692e(0xe1)];$('#AttendanceDDL')['val']()!='0'&&$(_0x21692e(0xd0))['val']()!='Holiday'||G_Validateholiday==!![]?$[_0x21692e(0xaa)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x21692e(0xc8),'type':_0x21692e(0xc4),'data':JSON[_0x21692e(0xb7)]({'__metadata':{'type':_0x21692e(0xc0)},'Title':'Attendance','EmployeeId':_0x255ee6,'ManagerIDId':parseInt(G_ManagerID),'AttendanceType':$(_0x21692e(0xd0))['val'](),'AttendanceDate':_0x32909b}),'headers':{'Accept':'application/json;odata=verbose','Content-Type':'application/json;odata=verbose','X-RequestDigest':$('#__REQUESTDIGEST')[_0x21692e(0xd2)](),'X-HTTP-Method':_0x21692e(0xc4)},'success':function(_0x41f33b,_0x7de04c,_0x38c356){var _0x54e91e=_0x21692e;alert(_0x54e91e(0xb1)),$(_0x54e91e(0xa8))[_0x54e91e(0xb2)](_0x54e91e(0xb3)),$('#timesheetdate')[_0x54e91e(0xc6)]({'dateFormat':_0x54e91e(0xb5),'maxDate':0x0})[_0x54e91e(0xc6)](_0x54e91e(0xd5),new Date());},'error':function(_0x36b86d){var _0x1af4ef=_0x21692e;console[_0x1af4ef(0xe8)]('SetAttendance\x20function\x20failed'),console['log'](_0x36b86d);}}):alert(_0x21692e(0xce));}function SetAttendanceDDL(){var _0x383549=a0_0x491849,_0x4fd75f=_spPageContextInfo[_0x383549(0xe1)],_0x50f623=new Date(ConvertDateTimeFormat($(_0x383549(0xdf))['val'](),'/')),_0x350c4f=_0x50f623[_0x383549(0xea)]()+'-'+(_0x50f623['getMonth']()+0x1)+'-'+_0x50f623[_0x383549(0xf3)]();GetHolidays(_0x350c4f);var _0x4bc33e=_spPageContextInfo[_0x383549(0xd9)]+_0x383549(0xdc)+_0x4fd75f+_0x383549(0xd3)+_0x350c4f+'\x27';$[_0x383549(0xaa)]({'url':_0x4bc33e,'headers':{'Accept':_0x383549(0xcd)},'async':![],'success':function(_0x108e25){var _0x1369fb=_0x383549,_0x381629=_0x108e25['d']['results'];_0x381629['length']>0x0?($('#AttendanceDDL')[_0x1369fb(0xd2)](_0x381629[0x0][_0x1369fb(0xaf)]),_0x381629[0x0][_0x1369fb(0xd7)]==!![]?($('#AttendanceDDL')[_0x1369fb(0xdb)](_0x1369fb(0xba),!![]),$(_0x1369fb(0xdd))['css'](_0x1369fb(0xac),_0x1369fb(0xef)),$(_0x1369fb(0xd1))[_0x1369fb(0xeb)](_0x1369fb(0xac),'none')):($(_0x1369fb(0xd0))[_0x1369fb(0xdb)](_0x1369fb(0xba),![]),$(_0x1369fb(0xdd))['css'](_0x1369fb(0xac),_0x1369fb(0xcb)),$('#Submit-attendance')[_0x1369fb(0xeb)]('display','inline-block'))):($(_0x1369fb(0xd0))[_0x1369fb(0xd2)]()=='0'&&$('#AttendanceDDL')[_0x1369fb(0xd2)]('0'),$('#AttendanceDDL')['prop'](_0x1369fb(0xba),![]),$(_0x1369fb(0xdd))[_0x1369fb(0xeb)](_0x1369fb(0xac),_0x1369fb(0xcb)),$('#AttendanceDDL')[_0x1369fb(0xd2)]('0'),$('#Submit-attendance')[_0x1369fb(0xeb)](_0x1369fb(0xac),_0x1369fb(0xc1)));},'error':function(_0x24adc9){var _0x25176a=_0x383549;console[_0x25176a(0xe8)](_0x25176a(0xf1)),console[_0x25176a(0xe8)](_0x24adc9);}});}function ConvertDateTimeFormat(_0x595b63,_0x596ded){var _0x5d05fd=a0_0x491849;return _0x595b63[_0x5d05fd(0xd6)](_0x596ded)[0x1]+''+_0x596ded+''+_0x595b63[_0x5d05fd(0xd6)](_0x596ded)[0x0]+''+_0x596ded+''+_0x595b63[_0x5d05fd(0xd6)](_0x596ded)[0x2];}var G_ManagerID=0x0;function a0_0x3652(_0x43381f,_0xf394ab){var _0xb3ffe7=a0_0xb3ff();return a0_0x3652=function(_0x365269,_0xfa5d8d){_0x365269=_0x365269-0xa8;var _0x51a95f=_0xb3ffe7[_0x365269];return _0x51a95f;},a0_0x3652(_0x43381f,_0xf394ab);}function GetManagerID(){var _0x465cc8=a0_0x491849,_0x7bda56=_spPageContextInfo[_0x465cc8(0xd9)]+_0x465cc8(0xab)+_spPageContextInfo[_0x465cc8(0xe1)]+'\x27)';$[_0x465cc8(0xaa)]({'url':_0x7bda56,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x2e99d5){var _0xcdaf0c=_0x465cc8,_0x499172=_0x2e99d5['d'][_0xcdaf0c(0xbc)];_0x499172[_0xcdaf0c(0xca)]>0x0?G_ManagerID=_0x499172[0x0][_0xcdaf0c(0xc2)]:G_ManagerID=0x0;},'error':function(_0x1e43af){var _0x1cd110=_0x465cc8;alert(_0x1cd110(0xee));}});}function SetCurrentdate(){var _0x3a5885=a0_0x491849;$(_0x3a5885(0xdf))[_0x3a5885(0xc6)]({'dateFormat':'dd/mm/yy','maxDate':0x0})['datepicker'](_0x3a5885(0xd5),new Date());}var G_Validateholiday=![];function GetHolidays(_0x4ce84e){var _0x235d28=a0_0x491849,_0x591930=_spPageContextInfo[_0x235d28(0xd9)]+_0x235d28(0xc7)+Logged_Location+'\x27)and\x20Holiday_start\x20eq\x20\x27'+_0x4ce84e+_0x235d28(0xf6)+titanForWork[_0x235d28(0xa9)](_0x235d28(0xe0))+_0x235d28(0xb9);$[_0x235d28(0xaa)]({'url':_0x591930,'headers':{'Accept':_0x235d28(0xcd)},'async':![],'success':function(_0x5540ca){var _0x5081c1=_0x235d28,_0xaa62fb=_0x5540ca['d'][_0x5081c1(0xbc)];_0xaa62fb[_0x5081c1(0xca)]>0x0?($(_0x5081c1(0xf4))[_0x5081c1(0xb0)](_0xaa62fb[0x0]['Title']),$(_0x5081c1(0xb6))[_0x5081c1(0xeb)]('display',_0x5081c1(0xef)),G_Validateholiday=!![]):($('#HolidayMessagediv')[_0x5081c1(0xb0)](''),$(_0x5081c1(0xb6))['css']('display','none'),G_Validateholiday=![]);},'error':function(_0x162bc3){var _0x559ef6=_0x235d28;alert(_0x559ef6(0xee));}});}var AttendanceEntry=!![];function authentication(){var _0xbc4600=a0_0x491849,_0x59c528=_spPageContextInfo['userDisplayName'],_0x35bee2=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27EnvironmentalSettings\x27)/items?$select=Title,Active,ListOfUsers/Title&$filter=Title\x20eq\x20\x27Attendance\x20Entry\x27\x20or\x20Title\x20eq\x20\x27Timesheet\x20Entry\x27\x20&$expand=ListOfUsers/Id';$[_0xbc4600(0xaa)]({'url':_0x35bee2,'async':![],'type':_0xbc4600(0xe9),'headers':{'accept':'application/json;\x20odata=verbose'},'success':function(_0x63784d){var _0xe116b3=_0xbc4600,_0x46384b=_0x63784d['d'][_0xe116b3(0xbc)];if(_0x46384b['length']>0x0)for(var _0x290068=0x0;_0x290068<_0x46384b[_0xe116b3(0xca)];_0x290068++){_0x46384b[_0x290068][_0xe116b3(0xbb)]==_0xe116b3(0xda)&&(_0x46384b[_0x290068][_0xe116b3(0xe4)]==![]&&(Attendancechck=![],$(_0xe116b3(0xec))[_0xe116b3(0xbf)](),$(_0xe116b3(0xb4))['eq'](0x2)[_0xe116b3(0xeb)](_0xe116b3(0xac),_0xe116b3(0xcb)))),_0x46384b[_0x290068][_0xe116b3(0xbb)]==_0xe116b3(0xd8)&&(_0x46384b[_0x290068][_0xe116b3(0xe4)]==![]&&($('#Attendance-toggle-li')['hide'](),$(_0xe116b3(0xb4))['eq'](0x0)[_0xe116b3(0xeb)](_0xe116b3(0xac),_0xe116b3(0xcb)),$(_0xe116b3(0xb4))['eq'](0x1)[_0xe116b3(0xeb)]('display',_0xe116b3(0xcb))));}},'error':function(_0x43c86e){var _0x2f232e=_0xbc4600;alert(JSON[_0x2f232e(0xb7)](_0x43c86e));}});}