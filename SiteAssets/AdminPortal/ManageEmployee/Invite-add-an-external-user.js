var a0_0x184682=a0_0x1937;(function(_0x15ab60,_0xdf5f5d){var _0x4824d6=a0_0x1937,_0x1e51ab=_0x15ab60();while(!![]){try{var _0x531d58=parseInt(_0x4824d6(0x20d))/0x1*(-parseInt(_0x4824d6(0x2a0))/0x2)+parseInt(_0x4824d6(0x1ef))/0x3+parseInt(_0x4824d6(0x23c))/0x4*(-parseInt(_0x4824d6(0x2ae))/0x5)+parseInt(_0x4824d6(0x2d5))/0x6*(-parseInt(_0x4824d6(0x29a))/0x7)+-parseInt(_0x4824d6(0x28c))/0x8*(-parseInt(_0x4824d6(0x1f5))/0x9)+parseInt(_0x4824d6(0x2c6))/0xa*(-parseInt(_0x4824d6(0x1f8))/0xb)+parseInt(_0x4824d6(0x24a))/0xc*(parseInt(_0x4824d6(0x29c))/0xd);if(_0x531d58===_0xdf5f5d)break;else _0x1e51ab['push'](_0x1e51ab['shift']());}catch(_0x195de8){_0x1e51ab['push'](_0x1e51ab['shift']());}}}(a0_0x1a70,0x24f8d));var token,peoplePickerDiv='',peoplePickerDivsuper='',GroupId='',email='',IsUpdate=![],userListItemId='',GuestUserEmail='',UserListId=[],Client_Id;function initializePeoplePicker(_0x3cd89c,_0x25905b){var _0xf23d7a=a0_0x1937,_0x45e894={};_0x45e894[_0xf23d7a(0x2c1)]=_0xf23d7a(0x2c9),_0x45e894[_0xf23d7a(0x28f)]=0xf,_0x45e894['ResolvePrincipalSource']=0xf,_0x45e894['AllowMultipleValues']=_0x25905b,_0x45e894['MaximumEntitySuggestions']=0x32,_0x45e894[_0xf23d7a(0x2cc)]=_0xf23d7a(0x220),this[_0xf23d7a(0x202)](_0x3cd89c,null,_0x45e894),$('.sp-peoplepicker-editorInput')[_0xf23d7a(0x2e6)](0xfa);}$(function(){var _0x27699b=a0_0x1937;$('#datepickerAD5')[_0x27699b(0x291)]({'changeMonth':!![],'changeYear':!![]});});function GetGueastEmployee(_0x12fc71){var _0x2cbe2e=a0_0x1937,_0x92d574='https://graph.microsoft.com/v1.0/users?$filter=mail\x20eq\x20\x27'+_0x12fc71+'\x27';return DeferredObj=$[_0x2cbe2e(0x21e)](),$[_0x2cbe2e(0x2d1)]({'method':_0x2cbe2e(0x272),'url':_0x92d574,'headers':{'Authorization':'Bearer\x20'+token,'Content-Type':_0x2cbe2e(0x2dd)},'async':![],'success':function(_0x149d0d){var _0x7a1278=_0x2cbe2e;DeferredObj[_0x7a1278(0x2c5)](_0x149d0d[_0x7a1278(0x293)]);},'error':function(_0x5adfb4){var _0x1dddc7=_0x2cbe2e;DeferredObj['reject'](_0x5adfb4),alert(_0x1dddc7(0x1df)+JSON['stringify'](_0x5adfb4));}}),DeferredObj[_0x2cbe2e(0x2d2)]();}function GetGueastUsers(_0x230c15){var _0x6ff55f=a0_0x1937,_0x3820eb=_0x6ff55f(0x258)+_0x230c15+'\x27';return DeferredObj=$[_0x6ff55f(0x21e)](),$[_0x6ff55f(0x2d1)]({'method':_0x6ff55f(0x272),'url':_0x3820eb,'headers':{'Authorization':'Bearer\x20'+token,'Content-Type':_0x6ff55f(0x2dd)},'async':![],'success':function(_0x48b495){var _0x424027=_0x6ff55f;DeferredObj[_0x424027(0x2c5)](_0x48b495[_0x424027(0x293)]);},'error':function(_0x45a8ff){var _0x427d05=_0x6ff55f;DeferredObj['reject'](_0x45a8ff),alert('error1'+JSON[_0x427d05(0x24f)](_0x45a8ff));}}),DeferredObj[_0x6ff55f(0x2d2)]();}function GetCategoryMaster(){var _0x1a7ba4=a0_0x1937,_0x492d3b=_0x1a7ba4(0x251),_0xad8907=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/GetByTitle(\x27'+_0x492d3b+_0x1a7ba4(0x232);$[_0x1a7ba4(0x2d1)]({'url':_0xad8907,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x30abf4){var _0x466a71=_0x1a7ba4,_0x1c9473=document['getElementById'](_0x466a71(0x275));_0x1c9473[_0x466a71(0x254)]='';for(var _0x3a7c00=0x0;_0x3a7c00<_0x30abf4['d']['results'][_0x466a71(0x292)];_0x3a7c00++){var _0x3c3d2a=_0x30abf4['d']['results'][_0x3a7c00][_0x466a71(0x1e9)],_0x41845d=_0x30abf4['d'][_0x466a71(0x27e)][_0x3a7c00][_0x466a71(0x1e9)];opt=document[_0x466a71(0x261)]('option'),opt[_0x466a71(0x293)]=_0x41845d,opt[_0x466a71(0x219)]=_0x3c3d2a,_0x1c9473[_0x466a71(0x25c)](opt);}},'error':function(_0x30cbb6){var _0x6bead6=_0x1a7ba4;console[_0x6bead6(0x2ad)](_0x30cbb6);}});}function GetUserId(_0x247cc3){var _0x479dea=a0_0x1937,_0x5a708b='',_0xe03ed4=_0x479dea(0x2b4),_0x44d340=_spPageContextInfo[_0x479dea(0x206)],_0x1f797f=_0xe03ed4+_0x247cc3;return $[_0x479dea(0x2d1)]({'url':_0x44d340+'/_api/web/siteusers(@v)?@v=\x27'+encodeURIComponent(_0x1f797f)+'\x27','method':_0x479dea(0x272),'headers':{'Accept':_0x479dea(0x2d4)},'async':![],'success':function(_0x289d0c){_0x5a708b=_0x289d0c['d']['Id'];},'error':function(_0x4515ea){var _0x20e629=_0x479dea;console[_0x20e629(0x2ad)](JSON['stringify'](_0x4515ea));}}),_0x5a708b;}function GetUserName(_0x2a733d){var _0x8b6730=a0_0x1937,_0x36629d='',_0x222035=_0x8b6730(0x2b4),_0x732184=_spPageContextInfo[_0x8b6730(0x206)],_0x374f99=_0x222035+_0x2a733d;return $['ajax']({'url':_0x732184+_0x8b6730(0x287)+encodeURIComponent(_0x374f99)+'\x27','method':_0x8b6730(0x272),'headers':{'Accept':_0x8b6730(0x2d4)},'async':![],'success':function(_0x48176b){var _0xb6047b=_0x8b6730;_0x36629d=_0x48176b['d'][_0xb6047b(0x2a8)];},'error':function(_0x3e781c){var _0x27ab8c=_0x8b6730;console['log'](JSON[_0x27ab8c(0x24f)](_0x3e781c));}}),_0x36629d;}function AddNewGuest(){var _0x555fac=a0_0x1937;try{var _0x2a52d1=_0x555fac(0x21c),_0x261d81=SPClientPeoplePicker['SPClientPeoplePickerDict'][peoplePickerDiv[0x0]['id']],_0x24ff84=_0x261d81[_0x555fac(0x28b)](),_0x23d0af=[];for(var _0x2a71a8=0x0;_0x2a71a8<_0x24ff84[_0x555fac(0x292)];_0x2a71a8++){var _0x170b40=GetUserId(_0x24ff84[_0x2a71a8]['EntityData'][_0x555fac(0x250)]);_0x23d0af['push'](_0x170b40),UserListId[_0x555fac(0x205)](_0x170b40);}_0x261d81=SPClientPeoplePicker[_0x555fac(0x23d)][peoplePickerDivsuper[0x0]['id']],_0x24ff84=_0x261d81[_0x555fac(0x28b)]();var _0x36e5f4=GetUserId(_0x24ff84[0x0][_0x555fac(0x28a)]['Email']);UserListId[_0x555fac(0x205)](_0x36e5f4);GroupId==''&&GetGroupIDByGroupName();AddUserinSharePointGroup($(_0x555fac(0x214))['val']());var _0x45b846=GetUserId($(_0x555fac(0x214))['val']());UserListId[_0x555fac(0x205)](_0x45b846);var _0x52eb56=_spPageContextInfo[_0x555fac(0x1f9)]+_0x555fac(0x1d8)+$(_0x555fac(0x256))[_0x555fac(0x2bd)]()['trim']()[_0x555fac(0x2b6)](/ /g,'')+_0x555fac(0x259),_0x5943d7,_0xce7155=GetItemTypeForListName(_0x2a52d1);_0x5943d7={'__metadata':{'type':_0xce7155},'LoginNameId':_0x45b846,'Title':$('#txtExtEmail')['val'](),'email':$(_0x555fac(0x214))[_0x555fac(0x2bd)](),'Designation':$('#txtExtDesignation')[_0x555fac(0x2bd)](),'Organization':$('#txtAddOrganization')[_0x555fac(0x2bd)](),'ReferenceCode':$(_0x555fac(0x1f2))['val'](),'TemplateType':$(_0x555fac(0x267),$('#TemplateType'))[_0x555fac(0x2bd)](),'InternalStakeholdersId':{'results':_0x23d0af},'SupervisorId':_0x36e5f4,'Client_NameId':Client_Id,'External_Supervisor':$('#txtExternalSupervisor')[_0x555fac(0x2bd)](),'ValidUpto':$(_0x555fac(0x222))[_0x555fac(0x2bd)](),'CollaborationType':$('option:selected',$(_0x555fac(0x289)))[_0x555fac(0x2bd)](),'Status':$('option:selected',$(_0x555fac(0x1e0)))[_0x555fac(0x2bd)](),'DocumentLibrary':_0x52eb56},AddItemToList(_0x2a52d1,_0x5943d7,UserListId);}catch(_0xa96164){console[_0x555fac(0x2ad)](_0xa96164[_0x555fac(0x21b)]);}}function cleartextBox(){var _0x55c045=a0_0x1937;$(_0x55c045(0x2b9))[_0x55c045(0x2bd)](''),$(_0x55c045(0x214))[_0x55c045(0x2bd)](''),$('#txtExtDesignation')[_0x55c045(0x2bd)](''),$(_0x55c045(0x1f2))[_0x55c045(0x2bd)](''),$('#txtExtOrganizationName')[_0x55c045(0x2bd)](''),$(_0x55c045(0x1fe))[_0x55c045(0x2a3)](_0x55c045(0x2e5),_0x55c045(0x2a2)),initializePeoplePicker('InternalStakeholders',!![]),peoplePickerDiv=$('[id$=\x27InternalStakeholders_TopSpan\x27]'),initializePeoplePicker(_0x55c045(0x21a),![]),peoplePickerDivsuper=$(_0x55c045(0x21f));}function AddItemToList(_0x1d5db9,_0x31e171,_0x4feeb7){var _0x2a4c9e=a0_0x1937,_0x29110c=$['Deferred']();return $[_0x2a4c9e(0x2d1)]({'url':_spPageContextInfo[_0x2a4c9e(0x1f9)]+'/_api/web/lists/getbytitle(\x27'+_0x1d5db9+'\x27)/items','type':'POST','async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$('#__REQUESTDIGEST')['val'](),'content-Type':_0x2a4c9e(0x24d)},'data':JSON[_0x2a4c9e(0x24f)](_0x31e171),'success':function(_0x4169df){var _0xfe6f9d=_0x2a4c9e;if(document[_0xfe6f9d(0x1d5)](_0xfe6f9d(0x1e7))[_0xfe6f9d(0x25a)][_0xfe6f9d(0x292)]===0x0){}else UploadAttachement(_0x4169df['d']['ID']);console[_0xfe6f9d(0x2ad)](_0x4169df),IsExistOrNotLibrary($(_0xfe6f9d(0x256))[_0xfe6f9d(0x2bd)]()[_0xfe6f9d(0x1ed)]()[_0xfe6f9d(0x2b6)](/ /g,''))?AssignTheEditRole($(_0xfe6f9d(0x256))['val']()[_0xfe6f9d(0x1ed)]()[_0xfe6f9d(0x2b6)](/ /g,''),_0x4feeb7):(createNewLibraryByRest($('#txtAddOrganization')['val']()[_0xfe6f9d(0x1ed)]()[_0xfe6f9d(0x2b6)](/ /g,'')),AssignTheEditRole($(_0xfe6f9d(0x256))['val']()[_0xfe6f9d(0x1ed)]()[_0xfe6f9d(0x2b6)](/ /g,''),_0x4feeb7)),alert(_0xfe6f9d(0x215)),cleartextBox();},'error':function(_0x542796){var _0x1e3758=_0x2a4c9e;console['log'](JSON[_0x1e3758(0x24f)](_0x542796)),_0x29110c[_0x1e3758(0x1e6)](_0x542796);}}),_0x29110c['promise']();}function a0_0x1937(_0x4b5403,_0x36c02a){var _0x1a70d5=a0_0x1a70();return a0_0x1937=function(_0x193713,_0x453772){_0x193713=_0x193713-0x1d1;var _0x4e57b1=_0x1a70d5[_0x193713];return _0x4e57b1;},a0_0x1937(_0x4b5403,_0x36c02a);}function UpdateGeustuser(_0x2d14aa){var _0x420417=a0_0x1937,_0x544fbd=_0x420417(0x21c),_0x33ea5f=SPClientPeoplePicker[_0x420417(0x23d)][peoplePickerDiv[0x0]['id']],_0x5d577d=_0x33ea5f[_0x420417(0x28b)](),_0x2ab6db=[];for(var _0x52cbe0=0x0;_0x52cbe0<_0x5d577d['length'];_0x52cbe0++){var _0x28813c=GetUserId(_0x5d577d[_0x52cbe0][_0x420417(0x28a)][_0x420417(0x250)]);_0x2ab6db[_0x420417(0x205)](_0x28813c),UserListId[_0x420417(0x205)](_0x28813c);}_0x33ea5f=SPClientPeoplePicker[_0x420417(0x23d)][peoplePickerDivsuper[0x0]['id']],_0x5d577d=_0x33ea5f[_0x420417(0x28b)]();var _0x120ae2=GetUserId(_0x5d577d[0x0][_0x420417(0x28a)][_0x420417(0x250)]);UserListId[_0x420417(0x205)](_0x120ae2);var _0x5c3d5b=GetUserId($(_0x420417(0x214))[_0x420417(0x2bd)]());UserListId[_0x420417(0x205)](_0x5c3d5b),GuestUserEmail=$(_0x420417(0x214))[_0x420417(0x2bd)]();var _0x4dfccb=_spPageContextInfo[_0x420417(0x1f9)]+_0x420417(0x1d8)+$(_0x420417(0x256))[_0x420417(0x2bd)]()['trim']()[_0x420417(0x2b6)](/ /g,'')+_0x420417(0x259);_0x5c3d5b==''&&(GetGroupIDByGroupName(),AddUserinSharePointGroup($('#txtExtEmail')['val']()));var _0x1113fc,_0x549bea=GetItemTypeForListName(_0x544fbd);_0x1113fc={'__metadata':{'type':_0x549bea},'Designation':$(_0x420417(0x1d7))[_0x420417(0x2bd)](),'LoginNameId':_0x5c3d5b,'Organization':$(_0x420417(0x256))[_0x420417(0x2bd)](),'ReferenceCode':$('#txtReferenceCodeExt')['val'](),'TemplateType':$(_0x420417(0x267),$(_0x420417(0x208)))['val'](),'InternalStakeholdersId':{'results':_0x2ab6db},'SupervisorId':_0x120ae2,'Client_NameId':Client_Id,'ValidUpto':$(_0x420417(0x222))[_0x420417(0x2bd)](),'CollaborationType':$('option:selected',$(_0x420417(0x289)))[_0x420417(0x2bd)](),'Status':$(_0x420417(0x267),$('#txtExtStatus'))['val'](),'DocumentLibrary':_0x4dfccb};var _0x18322f=$[_0x420417(0x21e)]();return $[_0x420417(0x2d1)]({'url':_spPageContextInfo[_0x420417(0x1f9)]+_0x420417(0x23e)+_0x544fbd+_0x420417(0x235)+_0x2d14aa+')','type':_0x420417(0x25d),'async':![],'headers':{'accept':_0x420417(0x24d),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x420417(0x2bd)](),'content-Type':_0x420417(0x24d),'IF-MATCH':'*','X-HTTP-Method':_0x420417(0x211)},'data':JSON[_0x420417(0x24f)](_0x1113fc),'success':function(_0x1d4043){var _0x3d5791=_0x420417;if(document[_0x3d5791(0x1d5)](_0x3d5791(0x1e7))['files'][_0x3d5791(0x292)]===0x0){}else UploadAttachement(_0x2d14aa);console[_0x3d5791(0x2ad)](_0x1d4043),IsExistOrNotLibrary($('#txtAddOrganization')[_0x3d5791(0x2bd)]()[_0x3d5791(0x1ed)]()[_0x3d5791(0x2b6)](/ /g,''))?AssignTheEditRole($(_0x3d5791(0x256))[_0x3d5791(0x2bd)]()[_0x3d5791(0x1ed)]()['replace'](/ /g,''),UserListId):(createNewLibraryByRest($(_0x3d5791(0x256))[_0x3d5791(0x2bd)]()['trim']()[_0x3d5791(0x2b6)](/ /g,'')),AssignTheEditRole($(_0x3d5791(0x256))[_0x3d5791(0x2bd)]()[_0x3d5791(0x1ed)]()[_0x3d5791(0x2b6)](/ /g,''),UserListId)),alert(_0x3d5791(0x1d9));},'error':function(_0x149134){var _0x4cf92a=_0x420417;console[_0x4cf92a(0x2ad)](JSON[_0x4cf92a(0x24f)](_0x149134)),_0x18322f[_0x4cf92a(0x1e6)](_0x149134);}}),_0x18322f[_0x420417(0x2d2)]();}function GetItemToList(_0x5adfba){var _0x12000e=a0_0x1937,_0x13f2ff=_0x12000e(0x21c),_0xaf3618=$[_0x12000e(0x21e)]();return $['ajax']({'url':_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27'+_0x13f2ff+_0x12000e(0x29d)+_0x5adfba+'\x27','type':_0x12000e(0x201),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x12000e(0x263))[_0x12000e(0x2bd)](),'content-Type':_0x12000e(0x24d)},'success':function(_0x4366dc){var _0x41f78c=_0x12000e;_0xaf3618['resolve'](_0x4366dc['d'][_0x41f78c(0x27e)]),console[_0x41f78c(0x2ad)](_0x4366dc);},'error':function(_0x347c5a){var _0x65a85c=_0x12000e;console[_0x65a85c(0x2ad)](JSON['stringify'](_0x347c5a)),_0xaf3618[_0x65a85c(0x1e6)](_0x347c5a);}}),_0xaf3618[_0x12000e(0x2d2)]();}function GetItemToListchoice(){var _0x38b8e8=a0_0x1937,_0x147edf=_0x38b8e8(0x21c),_0x3e7ea2=$['Deferred']();return $[_0x38b8e8(0x2d1)]({'url':_spPageContextInfo[_0x38b8e8(0x1f9)]+'/_api/web/lists/getbytitle(\x27'+_0x147edf+_0x38b8e8(0x2d9),'type':_0x38b8e8(0x201),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x38b8e8(0x263))[_0x38b8e8(0x2bd)](),'content-Type':_0x38b8e8(0x24d)},'success':function(_0x467edb){var _0x30d6b8=_0x38b8e8;_0x3e7ea2[_0x30d6b8(0x2c5)](_0x467edb['d'][_0x30d6b8(0x27e)][0x0][_0x30d6b8(0x217)]['results']),console[_0x30d6b8(0x2ad)](_0x467edb);},'error':function(_0x3b5af0){var _0x259e65=_0x38b8e8;console[_0x259e65(0x2ad)](JSON[_0x259e65(0x24f)](_0x3b5af0)),_0x3e7ea2[_0x259e65(0x1e6)](_0x3b5af0);}}),_0x3e7ea2[_0x38b8e8(0x2d2)]();}function GetItemToClientMaster(){var _0x26bc20=a0_0x1937,_0x546419='ClientMaster',_0x37945d=$[_0x26bc20(0x21e)]();return $['ajax']({'url':_spPageContextInfo[_0x26bc20(0x1f9)]+_0x26bc20(0x295)+_0x546419+_0x26bc20(0x1f7),'type':'get','async':![],'headers':{'accept':_0x26bc20(0x24d),'X-RequestDigest':$(_0x26bc20(0x263))[_0x26bc20(0x2bd)](),'content-Type':_0x26bc20(0x24d)},'success':function(_0x4abf2b){var _0x32ec73=_0x26bc20;_0x37945d[_0x32ec73(0x2c5)](_0x4abf2b['d'][_0x32ec73(0x27e)]),console[_0x32ec73(0x2ad)](_0x4abf2b);},'error':function(_0x3c8fad){var _0xe84ddc=_0x26bc20;console['log'](JSON[_0xe84ddc(0x24f)](_0x3c8fad)),_0x37945d['reject'](_0x3c8fad);}}),_0x37945d['promise']();}function requestToken(){var _0x2c8a67=a0_0x1937;$['ajax']({'async':!![],'crossDomain':!![],'url':ClientUrl,'method':'POST','headers':{'content-type':_0x2c8a67(0x2c4)},'data':{'grant_type':_0x2c8a67(0x2a4),'client_id\x20':ClientId,'client_secret':ClentSecret,'scope\x20':_0x2c8a67(0x268)},'success':function(_0x204b19){var _0x881c9c=_0x2c8a67;console['log'](_0x204b19),token=_0x204b19[_0x881c9c(0x244)];},'error':function(_0x4b03ce){var _0x5b8677=_0x2c8a67;console[_0x5b8677(0x2ad)](JSON[_0x5b8677(0x24f)](_0x4b03ce));}});}function ClientCredentialss(){var _0x3308f2=a0_0x1937,_0x29a1a8=_0x3308f2(0x279),_0x3af921=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/GetByTitle(\x27'+_0x29a1a8+'\x27)/items?$filter=Title\x20eq\x20\x27Client_Credentials\x27\x20';$[_0x3308f2(0x2d1)]({'url':_0x3af921,'headers':{'Accept':_0x3308f2(0x24d)},'async':![],'success':function(_0x5845a0){var _0x138c90=_0x3308f2,_0x5cd50d=_0x5845a0['d'][_0x138c90(0x27e)];ClientId=_0x5cd50d[0x0][_0x138c90(0x248)],ClentSecret=_0x5cd50d[0x0][_0x138c90(0x22b)],ClientUrl=_0x5cd50d[0x0][_0x138c90(0x2e1)],requestToken();},'error':function(_0x3fb75f){var _0x107d22=_0x3308f2;console[_0x107d22(0x2ad)](_0x3fb75f);}});}function GraphAccessTokenTogetUserDetails(){var _0x2ac25f=a0_0x1937,_0x202223=new jQuery[(_0x2ac25f(0x21e))](),_0x362622={'X-RequestDigest':$(_0x2ac25f(0x263))[_0x2ac25f(0x2bd)](),'accept':_0x2ac25f(0x28e),'content-type':_0x2ac25f(0x28e)},_0x300e03={'resource':'https://graph.microsoft.com'};return $[_0x2ac25f(0x2d1)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x2ac25f(0x255),'headers':_0x362622,'type':_0x2ac25f(0x25d),'data':JSON[_0x2ac25f(0x24f)](_0x300e03),'success':function(_0xdefe22){var _0x457036=_0x2ac25f;token=_0xdefe22['access_token'],token_=token,_0x202223[_0x457036(0x2c5)](token);},'error':function(_0x8483c0,_0xde00f8,_0x52ce40){var _0x34cce5=_0x2ac25f;console[_0x34cce5(0x2ad)](_0x8483c0[_0x34cce5(0x1ea)]),_0x202223['reject'](_0x8483c0['responseText']);}}),_0x202223['promise']();}var Errorcount=0x1,Ischeckerror=![];function Inviteuser(){var _0x12204c=a0_0x1937,_0x7586b7=$(_0x12204c(0x286))[_0x12204c(0x2bd)](),_0x218e9e=$(_0x12204c(0x1ec))[_0x12204c(0x2bd)](),_0x2c8f36=$('#txtinvitemessage')[_0x12204c(0x2bd)]();Errorcount=0x1,$[_0x12204c(0x2d1)]({'url':'https://graph.microsoft.com/v1.0/invitations','type':_0x12204c(0x25d),'headers':{'Authorization':_0x12204c(0x29f)+token,'content-type':_0x12204c(0x2dd)},'data':JSON['stringify']({'invitedUserDisplayName':_0x218e9e,'invitedUserEmailAddress':_0x7586b7,'inviteRedirectUrl':_spPageContextInfo[_0x12204c(0x1f9)]+'/SitePages/Thankyou.aspx','sendInvitationMessage':!![],'invitedUserMessageInfo':{'customizedMessageBody':_0x2c8f36}}),'async':![],'success':function(_0x4aba82){var _0x4826e1=_0x12204c;console[_0x4826e1(0x2ad)](_0x4aba82),$(_0x4826e1(0x286))[_0x4826e1(0x2bd)](''),$(_0x4826e1(0x1ec))[_0x4826e1(0x2bd)](''),$('#txtinvitemessage')[_0x4826e1(0x2bd)]('');GroupId==''&&GetGroupIDByGroupName();GuestUserEmail=_0x4aba82[_0x4826e1(0x2e2)];try{$[_0x4826e1(0x2c8)](AddUserinSharePointGroup(_0x4aba82[_0x4826e1(0x2e2)]))[_0x4826e1(0x1e8)](function(_0x1ea893){var _0x2efec7=_0x4826e1;Ischeckerror=![],_0x1ea893==_0x2efec7(0x245)?alert(_0x2efec7(0x22e)):alert('Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.');});}catch(_0x549cfd){alert(_0x4826e1(0x266));}},'error':function(_0xbf4036){var _0x7f10a9=_0x12204c;_0xbf4036[_0x7f10a9(0x246)]==_0x7f10a9(0x237)?alert(_0xbf4036[_0x7f10a9(0x246)]+_0x7f10a9(0x26d)):(alert(_0x7f10a9(0x1da)),console['log'](JSON[_0x7f10a9(0x24f)](_0xbf4036)));}}),Ischeckerror&&alert(_0x12204c(0x266));}function a0_0x1a70(){var _0x3419bf=['166lXBmUF','<label><input\x20type=\x22checkbox\x22\x20id=\x22Check_','https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo3.0@latest/SiteAssets/AdminPortal/ManageEmployee/assets/images/user_pic.jpg','attr','client_credentials','Incase\x20of\x20any\x20help\x20needed\x20or\x20if\x20you\x20are\x20facing\x20any\x20problem\x20in\x20accessing\x20this\x20portal,\x20please\x20send\x20an\x20e-mail\x20to\x20<\x20e-mail\x20ID\x20of\x20\x20admin\x20(s)\x20>','name','Recognition\x20has\x20been\x20submitted\x20\x20!!','Title','</div>','This\x20user\x20is\x20not\x20invited\x20at.\x0a\x20Send\x20invitation\x20to\x20this\x20guest\x20user\x20first.','<p>Please\x20click\x20on\x20the\x20following\x20link\x20to\x20access\x20this\x20portal.\x20</p>','css','log','285ucdmyk','get_web','\x22></label>','Accepted','d-block','shift','i:0#.f|membership|','fail','replace','/GuestUserDocuments/_api/web/lists/?$filter=Title\x20eq\x20\x27','byteLength','#txtExtLoginName','Client_Code','ready','EMail','val','InternalStakeholders','display','<span>','PrincipalAccountType','click','Attn_Name','application/x-www-form-urlencoded','resolve','51490uRaiCg','.toHide','when','User,DL,SecGroup,SPGroup','Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.\x0a\x20Enter\x20valid\x20email\x20address\x20or\x20check\x20the\x20external\x20sharing\x20features\x20is\x20enabled.','Contributors','Width','</td>','input:checkbox','From:\x20no-reply@sharepointonline.com','<p>Welcome\x20to\x20the\x20','ajax','promise','AttachmentFiles','application/json;\x20odata=verbose','258LzIxkR','onload','userEmail','[name=UpdateEmp]','\x27)/fields?&$select=*&$filter=EntityPropertyName\x20eq\x20\x27TemplateType\x27','input[name=UpdateEmp][value=','CustType','\x20\x20<tr\x20class=\x22text-center\x22>','application/json','Your\x20item\x20has\x20not\x20been\x20submitted\x20successfully!','div[id^=\x27InternalStakeholders\x27]','get_message','Description','invitedUserEmailAddress','#msgExtEmail','ReferenceCode','src','width','Invite\x20to\x20guest\x20Portal','External_Supervisor','mail\x20sent\x20successfully','append','getElementById','</span>','#txtExtDesignation','/GuestUserDocuments/','Guest\x20user\x20has\x20Update\x20successfully!','Please\x20enter\x20a\x20valid\x20email\x20address\x20of\x20the\x20guest\x20user,\x20who\x20is\x20outsider\x20of\x20this\x20organization.','\x20This\x20is\x20auto\x20generated\x20e-mail,\x20please\x20do\x20not\x20respond\x20on\x20this\x20sender\x20e-mail.','indramani047@gmail.com','selected','#masterClientgrid','error1','#txtExtStatus','not','addClass','#Customer-box','The\x20new\x20cafeteria\x20is\x20open.','removeClass','reject','GueastextinputFile','done','CatogeryName','responseText','\x20portal\x20of\x20','#txtinvitename','trim','getByName','767667KDzwEu','Meet\x20for\x20lun\x20Indramani\x20Indra?','Active','#txtReferenceCodeExt','/GuestUserDocuments/_api/Web/Lists/','IsActive','9ZqpnSj','/_api/SP.Utilities.Utility.SendEmail','\x27)/items?$select=*','473pUJgdV','webAbsoluteUrl','ClientMaster','SP.List','SelfCompany','Designation','#extrenalImage','Customerdd','true','get','SPClientPeoplePicker_InitStandaloneControlWrapper','error','#btnExtSubmit','push','siteAbsoluteUrl','\x27)/roleassignments/addroleassignment(principalid=\x27','#TemplateType','#TemplateType\x20>\x20[value=','</p>','Base64EncodedByteArray','#ddlAssociation','3095ERKxbC',')/users','https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo3.0@latest/SiteAssets/Titan-External-Employee-Portal/images/user_pic.jpg','\x27)/breakroleinheritance(false)','MERGE','Guest','readAsArrayBuffer','#txtExtEmail','Guest\x20user\x20has\x20registered\x20successfully!','TemplateType','Choices','#InternalStakeholders','text','internalsupervisor','message','ExternalUsers','get_users','Deferred','[id$=\x27internalsupervisor_TopSpan\x27]','251px','</tr>','#datepickerAD5','hide','SP.Utilities.EmailProperties','prop','#GueastextinputFile','SendEmailSharedNotification\x20\x20','webServerRelativeUrl','Client_Name','onerror','ChangeFileName','result','internalsupervisor_TopSpan','Invitation\x20mail\x20has\x20been\x20sent\x20to\x20the\x20user.','</span></h3>','send','checked','\x27)/items?$filter=CategoryType\x20eq\x20\x27Guest\x20Type\x27\x20and\x20Status\x20eq\x20\x20\x27Yes\x27\x20','[id$=\x27InternalStakeholders_TopSpan\x27]','</p>\x20\x20','\x27)/items(','disabled','Unauthorized','/_api/lists/GetByTitle(\x27','SP.User','#btnExtUpdate','<option>','13484wSYXpB','SPClientPeoplePickerDict','/_api/web/lists/GetByTitle(\x27','get_stackTrace','#Employee-box','<p>Click\x20on\x20<a\x20href=\x22https://adaptindia.sharepoint.com/sites/Titan_2_2_1_DEV/SitePages/GuestPortal.aspx\x22\x20target=\x22_blank\x22>\x20this-link\x20</a></p>','empty','<td\x20class=\x22text-left\x22>','access_token','User\x20Added','statusText','change','ClientName','externalUserState','12LYhXcU','<img\x20src=\x22img/customer.png\x22\x20id=\x22logo\x22>','\x22\x20class=\x22getclientmaster\x22\x20onclick=\x22selectOnlyThis(this.id)\x22\x20\x20value=\x22','application/json;odata=verbose','#txtExtOrganizationName','stringify','Email','CategoryMaster','InternalMembers','test','innerHTML','/_api/SP.OAuth.Token/Acquire','#txtAddOrganization','false','https://graph.microsoft.com/v1.0/users?$select=id,displayName,userPrincipalName,otherMails,userType,identities,creationType,externalUserState\x20&$filter=mail\x20eq\x20\x27','/Forms/AllItems.aspx','files','.msg','appendChild','POST','Email\x20Sent\x20Successfully','Supervisor','then','createElement','Sending\x20mail\x20with\x20attach','#__REQUESTDIGEST','InternalSupervisor','PendingAcceptance','Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.','option:selected','https://graph.microsoft.com/.default','#selectByUser\x20>\x20[value=','show','#txtExternalSupervisor','getItemsWithQueryItem',':\x20\x20Compact\x20Token\x20parsing\x20failed','readAsDataURL','#internalsupervisor','SetEnabledState','.sp-peoplepicker-delImage','GET','Success','Message\x20has\x20been\x20sent.','selectByUser','d-none','<div\x20class=\x22checkbox\x20m-0\x22>','target','EnvironmentalSettings','find','#UpdateEmp-box-2','Failed','slow','results','<h3>Dear\x20<span\x20class=\x22user_name\x22>','addUser','https://graph.microsoft.com/v1.0/me/sendMail','CollaborationType','\x09<span>','<p>','displayName','#txtinviteemail','/_api/web/siteusers(@v)?@v=\x27','/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id','#selectByUser','EntityData','GetAllUserInfo','482032WUnRvR',')/AttachmentFiles/add(FileName=\x27','application/json;odata=nometadata','SearchPrincipalSource','none','datepicker','length','value','Error\x20in\x20sending\x20Email:\x20','/_api/web/lists/getbytitle(\x27','[id$=\x27','/_api/web/sitegroups(','InternalStakeholders_TopSpan','d\x20M,\x20y','31129JgvgoT','/_api/web/sitegroups/getbyname(\x27Contributors\x27)/users','9060402TTotEY','\x27)/items?$select=*,AttachmentFiles,Supervisor/Title,Supervisor/EMail,InternalStakeholders/Title,InternalStakeholders/EMail,LoginName/Title,Client_Name/Title,Client_Name/Id\x20&$expand=Supervisor,InternalStakeholders,AttachmentFiles,LoginName,Client_Name\x20&$filter=\x20email\x20eq\x20\x27','Send\x20invitation\x20to\x20this\x20guest\x20user\x20first.','Bearer\x20'];a0_0x1a70=function(){return _0x3419bf;};return a0_0x1a70();}function setPeoplePickerUsersInfoCurrent(_0x24e415,_0x48bb66){var _0x5ea7d6=a0_0x1937,_0x5e19a6=$(_0x5ea7d6(0x296)+_0x24e415+'\x27]'),_0x3c04bf=SPClientPeoplePicker[_0x5ea7d6(0x23d)][_0x5e19a6[0x0]['id']];_0x3c04bf['AddUserKeys'](_0x48bb66,![]),_0x3c04bf[_0x5ea7d6(0x270)](![]);}function readURL(_0x10aaaa){var _0x4787fa=a0_0x1937;if(_0x10aaaa[_0x4787fa(0x25a)]&&_0x10aaaa[_0x4787fa(0x25a)][0x0]){var _0x42cc8b=new FileReader();_0x42cc8b[_0x4787fa(0x2d6)]=function(_0x3f5449){var _0x8af8a7=_0x4787fa;$('#extrenalImage')['attr'](_0x8af8a7(0x2e5),_0x3f5449['target']['result']);},_0x42cc8b[_0x4787fa(0x26e)](_0x10aaaa[_0x4787fa(0x25a)][0x0]);}}function UploadAttachement(_0x5c24bf){var _0x5b6acf=a0_0x1937;try{if(document['getElementById'](_0x5b6acf(0x1e7))[_0x5b6acf(0x25a)][_0x5b6acf(0x292)]===0x0){}else{var _0x32d945=_0x5c24bf,_0x1b2b96=$(_0x5b6acf(0x226)),_0x366254=_0x1b2b96[0x0][_0x5b6acf(0x25a)]['length'],_0x2eb94e=[],_0xd10782=_0x1b2b96[0x0][_0x5b6acf(0x25a)][0x0][_0x5b6acf(0x2a6)];_0xd10782=_0x1b2b96[0x0][_0x5b6acf(0x25a)][0x0]['name'][_0x5b6acf(0x2b6)](/[^a-zA-Z0-9-. ]/g,''),_0xd10782=_0xd10782['replace'](/\s/g,'');for(var _0x51645c=0x0;_0x51645c<_0x366254;_0x51645c++){_0x2eb94e[_0x5b6acf(0x205)](_0x1b2b96[0x0]['files'][_0x51645c]);}uploadFileSP(_0x5b6acf(0x21c),_0x32d945,_0x2eb94e,_0x366254,_0xd10782);}}catch(_0x3d4c7a){alert(_0x5b6acf(0x2de));}}function getFileBuffer(_0x29d663){var _0x4d684e=a0_0x1937,_0x5a8696=$[_0x4d684e(0x21e)](),_0x453ba4=new FileReader();return _0x453ba4['onload']=function(_0xf4a8ed){var _0x161b8b=_0x4d684e;_0x5a8696[_0x161b8b(0x2c5)](_0xf4a8ed[_0x161b8b(0x278)][_0x161b8b(0x22c)]);},_0x453ba4[_0x4d684e(0x22a)]=function(_0x4cd969){var _0x7559ba=_0x4d684e;_0x5a8696[_0x7559ba(0x1e6)](_0x4cd969[_0x7559ba(0x278)][_0x7559ba(0x203)]);},_0x453ba4[_0x4d684e(0x213)](_0x29d663),_0x5a8696[_0x4d684e(0x2d2)]();}function uploadFileSP(_0x3f868d,_0x572273,_0x429439,_0x40231a,_0x3a8753){var _0x31c54e=a0_0x1937,_0x3305da=0x0,_0x49a4da=$[_0x31c54e(0x21e)](),_0x2e635e='',_0x30c699=_0x429439[0x0],_0x14c365=getFileBuffer(_0x30c699);return _0x14c365['done'](function(_0x10e87b,_0x40adfb,_0x29f07b){var _0x2588e0=_0x31c54e,_0x2b8cca=new Uint8Array(_0x10e87b),_0x5f3101=new SP[(_0x2588e0(0x20b))](),_0x299e00=_spPageContextInfo['webAbsoluteUrl']+_0x2588e0(0x238)+_0x3f868d+_0x2588e0(0x235)+_0x572273+_0x2588e0(0x28d)+_0x3a8753+'\x27)',_0x5ca121=0x0;$[_0x2588e0(0x2d1)]({'url':_0x299e00,'type':_0x2588e0(0x25d),'processData':![],'contentType':_0x2588e0(0x24d),'data':_0x10e87b,'headers':{'accept':_0x2588e0(0x24d),'X-RequestDigest':$(_0x2588e0(0x263))[_0x2588e0(0x2bd)](),'content-length':_0x10e87b[_0x2588e0(0x2b8)]},'success':function(_0x3ba9bb){var _0xa3046c=_0x2588e0;_0x3305da++,_0x2e635e=_0x3305da,_0x429439[_0xa3046c(0x2b3)]();if(_0x429439[_0xa3046c(0x292)]>0x0)uploadFileSP(_0xa3046c(0x21c),_0x572273,_0x429439,_0x429439['length']);else{}},'error':function(_0x2401e6){alert('Idea\x20has\x20been\x20submitted\x20but\x20some\x20files\x20failed\x20to\x20upload.');}}),_0x49a4da[_0x2588e0(0x2c5)](_0x2e635e);}),_0x14c365[_0x31c54e(0x2b5)](function(_0x7a65bb){var _0x3b28d5=_0x31c54e;_0x49a4da[_0x3b28d5(0x1e6)](_0x7a65bb);}),_0x49a4da[_0x31c54e(0x2d2)]();}function GetGroupIDByGroupName(){var _0x14e809=a0_0x1937,_0x28184d=_spPageContextInfo[_0x14e809(0x1f9)]+_0x14e809(0x288);$[_0x14e809(0x2d1)]({'url':_0x28184d,'method':_0x14e809(0x272),'async':![],'headers':{'Accept':_0x14e809(0x2d4)},'success':function(_0x3a7f99){GroupId=_0x3a7f99['d']['Id'];},'error':function(_0x4d21b5){var _0x1ef35e=_0x14e809;console[_0x1ef35e(0x2ad)](_0x4d21b5);}});}function AddUserToSiteGroup(_0x62aed0){var _0x61e0b3=a0_0x1937;clientContext=new SP['ClientContext']();var _0x1facb1=clientContext[_0x61e0b3(0x2af)]()['get_siteGroups']()[_0x61e0b3(0x1ee)](_0x61e0b3(0x2cb)),_0x3a5ccd=_0x1facb1[_0x61e0b3(0x21d)]();_0x3a5ccd[_0x61e0b3(0x280)](_0x62aed0),clientContext['executeQueryAsync'](onsuccess,onfailed);}function onsuccess(){var _0x398012=a0_0x1937;console[_0x398012(0x2ad)](_0x398012(0x273));}function onfailed(_0x8be345,_0x63e73c){var _0x568188=a0_0x1937;console[_0x568188(0x2ad)](_0x568188(0x27c)+_0x63e73c[_0x568188(0x2e0)]()+'\x0a'+_0x63e73c[_0x568188(0x23f)]());}function AddUserinSharePointGroup(_0x8022e6){var _0x38cedb=a0_0x1937,_0x160bfe=$[_0x38cedb(0x21e)](),_0x130123=_0x38cedb(0x2b4),_0x5f1773=_0x130123+_0x8022e6,_0x5d0634=_spPageContextInfo[_0x38cedb(0x1f9)]+_0x38cedb(0x29b);$[_0x38cedb(0x2d1)]({'url':_0x5d0634,'type':'POST','async':![],'data':JSON[_0x38cedb(0x24f)]({'__metadata':{'type':_0x38cedb(0x239)},'LoginName':_0x5f1773}),'headers':{'accept':_0x38cedb(0x24d),'content-type':_0x38cedb(0x24d),'X-RequestDigest':$(_0x38cedb(0x263))[_0x38cedb(0x2bd)]()},'success':_0x23ad11,'error':_0x55016d});function _0x23ad11(_0x437e73){var _0x251b29=_0x38cedb;Ischeckerror=!![],_0x160bfe[_0x251b29(0x2c5)]('User\x20Added'),Errorcount=0x1,console[_0x251b29(0x2ad)](_0x251b29(0x245));}function _0x55016d(_0x10f9d6){var _0x4dbdd9=_0x38cedb;console['log'](JSON['stringify'](_0x10f9d6)),(_0x10f9d6[_0x4dbdd9(0x246)]=='Not\x20Found'||_0x10f9d6[_0x4dbdd9(0x246)]==_0x4dbdd9(0x203))&&Errorcount==0xa?_0x10f9d6[_0x4dbdd9(0x246)]==_0x4dbdd9(0x203)?alert(_0x4dbdd9(0x266)):alert(_0x4dbdd9(0x2ca)):(Errorcount++,AddUserinSharePointGroup(GuestUserEmail));}return _0x160bfe['promise']();}function AddUserinSharePointGroupforEdit(_0x12cb3d){var _0x385e30=a0_0x1937,_0x2b8fa7='',_0x3796b4=_0x385e30(0x2b4),_0x2abe34=_0x3796b4+_0x12cb3d,_0x46c8dd=_spPageContextInfo['webAbsoluteUrl']+_0x385e30(0x297)+GroupId+_0x385e30(0x20e);$[_0x385e30(0x2d1)]({'url':_0x46c8dd,'type':_0x385e30(0x25d),'async':![],'data':JSON[_0x385e30(0x24f)]({'__metadata':{'type':_0x385e30(0x239)},'LoginName':_0x2abe34}),'headers':{'accept':_0x385e30(0x24d),'content-type':_0x385e30(0x24d),'X-RequestDigest':$(_0x385e30(0x263))['val']()},'success':_0x1039c2,'error':_0x31eb69});function _0x1039c2(_0x836131){var _0x4ae0b1=_0x385e30;_0x2b8fa7=_0x836131['d'],console[_0x4ae0b1(0x2ad)]('User\x20Added');}function _0x31eb69(_0x34a0df){var _0x205b4a=_0x385e30;console['log'](JSON[_0x205b4a(0x24f)](_0x34a0df));}return _0x2b8fa7;}function processSendEmails(_0x255e6a,_0x1c4bd7,_0x472b39){var _0x2b9a48=a0_0x1937,_0x40494e=[],_0x4a11e6=_0x2b9a48(0x24b)+_0x2b9a48(0x27f)+_0x255e6a+_0x2b9a48(0x22f)+_0x2b9a48(0x2d0)+_0x1c4bd7+_0x2b9a48(0x1eb)+_0x472b39+'.</p>'+_0x2b9a48(0x2ab)+_0x2b9a48(0x241)+_0x2b9a48(0x284)+'\x20Your\x20e-mail\x20configured\x20for\x20this\x20portal\x20is\x20<span\x20id=\x22user_id\x22>@info.gmail.com</span>\x20and\x20you’ll\x20be\x20able\x20to\x20login\x20using\x20your\x20existing\x20passport\x20for\x20this\x20e-mail\x20service.'+'Browsers\x20supported\x20by\x20this\x20portal\x20are\x20Chrome,\x20Microsoft\x20Edge,\x20Safari…..\x20(incase\x20you\x20want\x20to\x20specify\x20their\x20versions\x20as\x20well)'+_0x2b9a48(0x234)+'\x20<p>'+_0x2b9a48(0x2a5)+_0x2b9a48(0x1db)+_0x2b9a48(0x20a),_0x3bf39b=_0x2b9a48(0x1d1);_0x40494e['push'](email);var _0x3bb254=_spPageContextInfo[_0x2b9a48(0x2d7)],_0x455660;_0x455660={'properties':{'__metadata':{'type':_0x2b9a48(0x224)},'From':_0x3bb254,'To':{'results':_0x40494e},'Body':_0x4a11e6,'Subject':_0x3bf39b}};var _0x33fc2={'properties':{'__metadata':{'type':_0x2b9a48(0x224)},'From':_0x2b9a48(0x2cf),'To':{'results':_0x40494e},'Body':_0x4a11e6,'Subject':_0x3bf39b}},_0x45ee9d=_spPageContextInfo[_0x2b9a48(0x228)]==='/'?'/':_spPageContextInfo[_0x2b9a48(0x228)],_0x1c14cc=_0x45ee9d,_0x27a53e=_0x1c14cc+_0x2b9a48(0x1f6),_0x276804=_spPageContextInfo['webAbsoluteUrl']+'/_api/SP.Utilities.Utility.SendEmail';$['ajax']({'contentType':_0x2b9a48(0x2dd),'url':_0x276804,'type':'POST','data':JSON[_0x2b9a48(0x24f)](_0x33fc2),'async':![],'headers':{'Accept':_0x2b9a48(0x24d),'content-type':_0x2b9a48(0x24d),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x2b9a48(0x2bd)]()},'success':function(_0x3c2c09){var _0x379482=_0x2b9a48;console[_0x379482(0x2ad)](_0x379482(0x274));},'error':function(_0x3648e3){var _0x4732d=_0x2b9a48;console[_0x4732d(0x2ad)](_0x4732d(0x227)+JSON[_0x4732d(0x24f)](_0x3648e3));}});}function sendEmail(_0x5487da,_0x49bc1a,_0x49ae6b,_0x4f6580){var _0x33757f=a0_0x1937;Email[_0x33757f(0x230)]({'SecureToken':token,'To':_0x49bc1a[0x0],'From':_0x5487da,'Subject':_0x4f6580,'Body':_0x49ae6b})[_0x33757f(0x260)](_0x4d77cc=>alert(_0x33757f(0x1d3)));var _0x55eb52=_spPageContextInfo[_0x33757f(0x228)],_0x3981a3=_0x55eb52+'/_api/SP.Utilities.Utility.SendEmail';$[_0x33757f(0x2d1)]({'contentType':_0x33757f(0x2dd),'url':_0x3981a3,'type':_0x33757f(0x25d),'data':JSON['stringify']({'properties':{'__metadata':{'type':_0x33757f(0x224)},'From':_0x5487da,'To':{'results':_0x49bc1a},'Body':_0x49ae6b,'Subject':_0x4f6580}}),'headers':{'Accept':_0x33757f(0x24d),'content-type':_0x33757f(0x24d),'X-RequestDigest':jQuery(_0x33757f(0x263))[_0x33757f(0x2bd)]()},'success':function(_0x3cb573){var _0x591414=_0x33757f;alert(_0x591414(0x25e));},'error':function(_0x5b84b2){var _0x27b11e=_0x33757f;alert(_0x27b11e(0x294)+JSON[_0x27b11e(0x24f)](_0x5b84b2));}});}$(function(){var _0xa6ac69=a0_0x1937;$(_0xa6ac69(0x2d8))[_0xa6ac69(0x2c2)](function(){var _0x4074e8=_0xa6ac69;$('.toHide')['hide'](),cleartextBox(),$('#UpdateEmp-box-'+$(this)[_0x4074e8(0x2bd)]())[_0x4074e8(0x26a)](_0x4074e8(0x27d)),$(this)[_0x4074e8(0x2bd)]()=='3'&&(GetCategoryMaster(),$[_0x4074e8(0x2c8)](GetItemToListchoice())[_0x4074e8(0x1e8)](function(_0x140cbd){var _0x322740=_0x4074e8;$(_0x322740(0x208))[_0x322740(0x242)]();for(var _0x5c36c9=0x0;_0x5c36c9<_0x140cbd[_0x322740(0x292)];_0x5c36c9++){var _0x546d55=$('<option>');_0x546d55[_0x322740(0x2a3)](_0x322740(0x293),_0x140cbd[_0x5c36c9])[_0x322740(0x219)](_0x140cbd[_0x5c36c9]),$('#TemplateType')[_0x322740(0x1d4)](_0x546d55);}})),$('#msgExtEmail')[_0x4074e8(0x223)]();});});function sendEmailg(){var _0x2085a3=a0_0x1937;$[_0x2085a3(0x2d1)]({'async':![],'crossDomain':!![],'url':_0x2085a3(0x281),'method':_0x2085a3(0x25d),'headers':{'authorization':'Bearer\x20'+token_,'content-type':'application/json'},'data':JSON['stringify']({'message':{'subject':_0x2085a3(0x1f0),'body':{'contentType':'Text','content':_0x2085a3(0x1e4)},'toRecipients':[{'emailAddress':{'address':_0x2085a3(0x1dc)}}]}}),'success':function(_0x518408){var _0x17919a=_0x2085a3;alert(_0x17919a(0x2a7));},'error':function(_0x33b958){var _0x2bc85e=_0x2085a3;console['log'](_0x2bc85e(0x262)+JSON['stringify'](_0x33b958));}});}function createNewLibraryByRest(_0x41da9b){var _0x343b42=a0_0x1937,_0x2e8fc5=_0x41da9b,_0x39206f=_spPageContextInfo[_0x343b42(0x1f9)]+_0x343b42(0x1f3);$[_0x343b42(0x2d1)]({'url':_0x39206f,'method':_0x343b42(0x25d),'async':![],'data':JSON['stringify']({'__metadata':{'type':_0x343b42(0x1fb)},'AllowContentTypes':!![],'BaseTemplate':0x65,'ContentTypesEnabled':!![],'Description':'Description','OnQuickLaunch':!![],'Title':_0x41da9b}),'headers':{'content-type':_0x343b42(0x24d),'X-RequestDigest':$(_0x343b42(0x263))[_0x343b42(0x2bd)]()},'success':function(_0x44b42e){BreakRoleInheritance(_0x2e8fc5);},'error':function(_0x1af705){var _0x16b564=_0x343b42;alert(_0x1af705[_0x16b564(0x1ea)]);}});}function BreakRoleInheritance(_0xf0bc2d){var _0x3ffe86=a0_0x1937;url=_spPageContextInfo[_0x3ffe86(0x1f9)]+'/GuestUserDocuments/_api/web/lists/getbytitle(\x27'+_0xf0bc2d+_0x3ffe86(0x210),$[_0x3ffe86(0x2d1)]({'url':url,'type':_0x3ffe86(0x25d),'async':![],'headers':{'accept':_0x3ffe86(0x28e),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x3ffe86(0x2bd)]()},'success':function(_0x55a640){console['log'](_0x55a640);},'error':function(_0x3eb1a9){var _0xb37bf0=_0x3ffe86;console[_0xb37bf0(0x2ad)](_0x3eb1a9);}});}function AssignTheEditRole(_0x5ede75,_0x37286a){var _0x3d6d61=a0_0x1937;for(var _0x49c1a4=0x0;_0x49c1a4<_0x37286a['length'];_0x49c1a4++){url=_spPageContextInfo[_0x3d6d61(0x1f9)]+'/GuestUserDocuments/_api/web/lists/getbytitle(\x27'+_0x5ede75+_0x3d6d61(0x207)+_0x37286a[_0x49c1a4]+'\x27,roledefid=\x271073741830\x27)',$[_0x3d6d61(0x2d1)]({'url':url,'type':_0x3d6d61(0x25d),'async':![],'headers':{'accept':'application/json;odata=nometadata','X-RequestDigest':$(_0x3d6d61(0x263))['val']()},'success':function(_0x916897){var _0x3d80d2=_0x3d6d61;console[_0x3d80d2(0x2ad)](_0x916897);},'error':function(_0x3657f8){var _0x3235e3=_0x3d6d61;console[_0x3235e3(0x2ad)](_0x3657f8);}});}}function IsExistOrNotLibrary(_0x3596cd){var _0x1b8743=a0_0x1937,_0x434ac6='';return url=_spPageContextInfo[_0x1b8743(0x1f9)]+_0x1b8743(0x2b7)+_0x3596cd+'\x27',$[_0x1b8743(0x2d1)]({'url':url,'type':_0x1b8743(0x201),'async':![],'headers':{'accept':_0x1b8743(0x28e),'X-RequestDigest':$(_0x1b8743(0x263))['val']()},'success':function(_0x3808ea){var _0x137737=_0x1b8743;_0x3808ea[_0x137737(0x293)]['length']>0x0?_0x434ac6=!![]:_0x434ac6=![],console[_0x137737(0x2ad)](_0x3808ea);},'error':function(_0x520edf){var _0x556016=_0x1b8743;console[_0x556016(0x2ad)](_0x520edf);}}),_0x434ac6;}var SelectClientId='';function GenarateclientGrid(_0x363ae8){var _0x31b356=a0_0x1937;$(_0x31b356(0x1de))[_0x31b356(0x242)](),$('#masterClientgrid')[_0x31b356(0x1d4)](_0x363ae8);}function Selectedcclinte(){var _0x46b02a=a0_0x1937;$(_0x46b02a(0x256))['val'](ClientInternalMembers[SelectClientId][_0x46b02a(0x2a8)]),Client_Id=ClientInternalMembers[SelectClientId]['ID'];ClientInternalMembers[SelectClientId][_0x46b02a(0x25f)]!=undefined?$(_0x46b02a(0x26b))[_0x46b02a(0x2bd)](ClientInternalMembers[SelectClientId]['Supervisor']):$('#txtExternalSupervisor')[_0x46b02a(0x2bd)]($(_0x46b02a(0x214))[_0x46b02a(0x2bd)]());$(_0x46b02a(0x269)+ClientInternalMembers[SelectClientId][_0x46b02a(0x2db)]+']')['attr'](_0x46b02a(0x1dd),'true'),$(_0x46b02a(0x209)+ClientInternalMembers[SelectClientId][_0x46b02a(0x216)]+']')[_0x46b02a(0x2a3)](_0x46b02a(0x1dd),_0x46b02a(0x200)),initializePeoplePicker('InternalStakeholders',!![]),peoplePickerDiv=$('[id$=\x27InternalStakeholders_TopSpan\x27]'),initializePeoplePicker(_0x46b02a(0x21a),![]),peoplePickerDivsuper=$(_0x46b02a(0x21f));for(var _0x86a011=0x0;_0x86a011<ClientInternalMembers[SelectClientId][_0x46b02a(0x252)]['results']['length'];_0x86a011++){setPeoplePickerUsersInfoCurrent(_0x46b02a(0x298),ClientInternalMembers[SelectClientId][_0x46b02a(0x252)][_0x46b02a(0x27e)][_0x86a011][_0x46b02a(0x2bc)]);}setPeoplePickerUsersInfoCurrent(_0x46b02a(0x22d),ClientInternalMembers[SelectClientId][_0x46b02a(0x264)][_0x46b02a(0x2bc)]),$(_0x46b02a(0x2df))[_0x46b02a(0x2a3)]('contentEditable',_0x46b02a(0x257)),$('#InternalStakeholders')['attr'](_0x46b02a(0x236),'disabled'),$('#internalsupervisor')[_0x46b02a(0x2a3)](_0x46b02a(0x236),_0x46b02a(0x236)),$(peoplePickerDiv)[_0x46b02a(0x27a)](_0x46b02a(0x271))['css'](_0x46b02a(0x2bf),_0x46b02a(0x290)),$(peoplePickerDivsuper)[_0x46b02a(0x27a)](_0x46b02a(0x271))[_0x46b02a(0x2ac)](_0x46b02a(0x2bf),_0x46b02a(0x290));}var ClientInternalMembers=[];function GetClientMasterTeamDeails(){var _0x1c2c90=a0_0x1937;Taskusers=[],RestQuery='?$select=*,Id,Supervisor/Title,Supervisor/EMail\x20,InternalMembers/EMail,InternalMembers/Title,InternalSupervisor/EMail,InternalSupervisor/Title\x20&$expand=Supervisor,InternalMembers,InternalSupervisor\x20',$[_0x1c2c90(0x2c8)](CommonFunction[_0x1c2c90(0x26c)](_0x1c2c90(0x1fa),RestQuery))[_0x1c2c90(0x1e8)](function(_0x396a96){var _0x1a3118=_0x1c2c90,_0x3526b7;IsNotTeamMember='';debugger;var _0x5231c5='';for(var _0x28eb8a=0x0;_0x28eb8a<_0x396a96['results'][_0x1a3118(0x292)];_0x28eb8a++){_0x3526b7=[],_0x3526b7=_0x396a96[_0x1a3118(0x27e)][_0x28eb8a];var _0x2d1007=_0x3526b7[_0x1a3118(0x1f4)]=_0x1a3118(0x200)?_0x3526b7['IsActive']:_0x1a3118(0x1f1);_0x5231c5+=_0x1a3118(0x2dc)+_0x1a3118(0x243)+_0x1a3118(0x277)+_0x1a3118(0x2a1)+_0x28eb8a+_0x1a3118(0x24c)+_0x28eb8a+_0x1a3118(0x2b0)+_0x1a3118(0x2a9)+'</td>'+_0x1a3118(0x243)+_0x1a3118(0x2c0)+_0x3526b7['Client_Code']+_0x1a3118(0x1d6)+_0x1a3118(0x2cd)+_0x1a3118(0x243)+_0x1a3118(0x2c0)+_0x3526b7[_0x1a3118(0x2a8)]+'</span>'+_0x1a3118(0x2cd)+_0x1a3118(0x243)+_0x1a3118(0x283)+_0x3526b7[_0x1a3118(0x2c3)]+'</span>'+_0x1a3118(0x2cd)+'<td\x20class=\x22text-left\x22>'+_0x1a3118(0x2c0)+_0x2d1007+'</span>'+_0x1a3118(0x2cd)+_0x1a3118(0x221),ClientInternalMembers[_0x1a3118(0x205)]({'Title':_0x3526b7[_0x1a3118(0x2a8)],'Client_Code':_0x3526b7[_0x1a3118(0x2ba)],'Attn_Name':_0x3526b7[_0x1a3118(0x2c3)],'Supervisor':_0x3526b7['Supervisor'][_0x1a3118(0x2bc)],'SelfCompany':_0x3526b7[_0x1a3118(0x1fc)],'IsActive':_0x3526b7[_0x1a3118(0x1f4)],'CustType':_0x3526b7[_0x1a3118(0x2db)],'TemplateType':_0x3526b7[_0x1a3118(0x216)],'InternalMembers':_0x3526b7[_0x1a3118(0x252)],'InternalSupervisor':_0x3526b7[_0x1a3118(0x264)],'ID':_0x3526b7['Id']});}GenarateclientGrid(_0x5231c5);});}function selectOnlyThis(_0x7528a){var _0xfda1d4=a0_0x1937;SelectClientId='',SelectClientId=_0x7528a['split']('_')[0x1],$(_0xfda1d4(0x2ce))[_0xfda1d4(0x1e1)](this)['prop'](_0xfda1d4(0x231),![]),document['getElementById'](_0x7528a)[_0xfda1d4(0x231)]=!![];}$(document)[a0_0x184682(0x2bb)](function(){var _0x5ba411=a0_0x184682;$(_0x5ba411(0x289))['on'](_0x5ba411(0x247),function(){var _0x570b75=_0x5ba411,_0x4aae14=$(this)['find'](_0x570b75(0x267))[_0x570b75(0x2bd)]();if(_0x4aae14==_0x570b75(0x1ff))$(_0x570b75(0x1e3))[_0x570b75(0x1e5)](_0x570b75(0x2b2)),$('#Customer-box')['addClass'](_0x570b75(0x276)),$(_0x570b75(0x240))[_0x570b75(0x1e5)](_0x570b75(0x276)),$(_0x570b75(0x240))['addClass'](_0x570b75(0x2b2));else _0x4aae14==_0x570b75(0x212)&&($(_0x570b75(0x1e3))[_0x570b75(0x1e5)](_0x570b75(0x276)),$(_0x570b75(0x1e3))['addClass']('d-block'),$('#Employee-box')[_0x570b75(0x1e5)](_0x570b75(0x2b2)),$(_0x570b75(0x240))[_0x570b75(0x1e2)](_0x570b75(0x276)));}),$(_0x5ba411(0x214))['focusout'](function(){var _0x23ac4d=_0x5ba411;email=$(_0x23ac4d(0x214))[_0x23ac4d(0x2bd)]();var _0x4bd31a=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/igm;if(_0x4bd31a[_0x23ac4d(0x253)](email)){$('.msg')['hide'](),$(_0x23ac4d(0x2e3))[_0x23ac4d(0x223)](),$['when'](GetItemToListchoice(),GetItemToList(email))[_0x23ac4d(0x1e8)](function(_0x55d94e,_0x1f318d){var _0x55c3f3=_0x23ac4d;if(_0x1f318d[_0x55c3f3(0x292)]>0x0){var _0x259edd=GetUserName($(_0x55c3f3(0x214))[_0x55c3f3(0x2bd)]());_0x259edd==''&&(GroupId==''&&GetGroupIDByGroupName(),$[_0x55c3f3(0x2c8)](AddUserinSharePointGroupforEdit($(_0x55c3f3(0x214))[_0x55c3f3(0x2bd)]()))[_0x55c3f3(0x1e8)](function(_0x2c70b2){var _0x1acf11=_0x55c3f3;if(_0x2c70b2==''){cleartextBox(),$(_0x1acf11(0x2c7))[_0x1acf11(0x223)](),$(_0x1acf11(0x27b))['show'](_0x1acf11(0x27d));var _0x197af0=0x2;return $(_0x1acf11(0x2da)+_0x197af0+']')[_0x1acf11(0x225)](_0x1acf11(0x231),!![]),alert(_0x1acf11(0x2aa)),![];}else _0x259edd=_0x2c70b2[_0x1acf11(0x2a8)];}));if(_0x1f318d[0x0][_0x55c3f3(0x2d3)]['results'][_0x55c3f3(0x292)]>0x0){var _0x33d221=_0x1f318d[0x0][_0x55c3f3(0x2d3)][_0x55c3f3(0x27e)][0x0]['ServerRelativeUrl'];$(_0x55c3f3(0x1fe))[_0x55c3f3(0x2a3)](_0x55c3f3(0x2e5),_0x33d221);}else $(_0x55c3f3(0x1fe))[_0x55c3f3(0x2a3)](_0x55c3f3(0x2e5),_0x55c3f3(0x20f));IsUpdate=!![],userListItemId=_0x1f318d[0x0]['Id'],initializePeoplePicker('InternalStakeholders',!![]),peoplePickerDiv=$('[id$=\x27InternalStakeholders_TopSpan\x27]'),initializePeoplePicker(_0x55c3f3(0x21a),![]),peoplePickerDivsuper=$(_0x55c3f3(0x21f));for(var _0x54324e=0x0;_0x54324e<_0x1f318d[0x0]['InternalStakeholders'][_0x55c3f3(0x27e)][_0x55c3f3(0x292)];_0x54324e++){setPeoplePickerUsersInfoCurrent(_0x55c3f3(0x298),_0x1f318d[0x0][_0x55c3f3(0x2be)][_0x55c3f3(0x27e)][_0x54324e][_0x55c3f3(0x2bc)]);}setPeoplePickerUsersInfoCurrent(_0x55c3f3(0x22d),_0x1f318d[0x0]['Supervisor'][_0x55c3f3(0x2bc)]),$(_0x55c3f3(0x218))[_0x55c3f3(0x2a3)]('disabled',_0x55c3f3(0x236)),$(_0x55c3f3(0x26f))['attr'](_0x55c3f3(0x236),_0x55c3f3(0x236)),$(peoplePickerDiv)[_0x55c3f3(0x27a)](_0x55c3f3(0x271))[_0x55c3f3(0x2ac)]('display',_0x55c3f3(0x290)),$(peoplePickerDivsuper)[_0x55c3f3(0x27a)](_0x55c3f3(0x271))[_0x55c3f3(0x2ac)](_0x55c3f3(0x2bf),_0x55c3f3(0x290)),$(_0x55c3f3(0x23a))[_0x55c3f3(0x26a)](),$(_0x55c3f3(0x208))[_0x55c3f3(0x242)]();for(var _0x54324e=0x0;_0x54324e<_0x55d94e[_0x55c3f3(0x292)];_0x54324e++){var _0x536a05=$(_0x55c3f3(0x23b));_0x536a05['attr'](_0x55c3f3(0x293),_0x55d94e[_0x54324e])[_0x55c3f3(0x219)](_0x55d94e[_0x54324e]),$(_0x55c3f3(0x208))[_0x55c3f3(0x1d4)](_0x536a05);}$(_0x55c3f3(0x2b9))[_0x55c3f3(0x2bd)](_0x259edd),$(_0x55c3f3(0x1d7))[_0x55c3f3(0x2bd)](_0x1f318d[0x0][_0x55c3f3(0x1fd)]),$(_0x55c3f3(0x26b))[_0x55c3f3(0x2bd)](_0x1f318d[0x0][_0x55c3f3(0x1d2)]),$(_0x55c3f3(0x20c))[_0x55c3f3(0x2bd)](_0x1f318d[0x0]['Association']),$('#txtExtOrganizationName')[_0x55c3f3(0x2bd)](_0x1f318d[0x0]['Organization']),$(_0x55c3f3(0x256))['val'](_0x1f318d[0x0][_0x55c3f3(0x229)][_0x55c3f3(0x2a8)]),Client_Id=_0x1f318d[0x0][_0x55c3f3(0x229)]['Id'],$(_0x55c3f3(0x1f2))[_0x55c3f3(0x2bd)](_0x1f318d[0x0][_0x55c3f3(0x2e4)]),$(_0x55c3f3(0x209)+_0x1f318d[0x0][_0x55c3f3(0x216)]+']')[_0x55c3f3(0x2a3)](_0x55c3f3(0x1dd),'true'),$('#datepickerAD5')[_0x55c3f3(0x2bd)]($[_0x55c3f3(0x291)]['formatDate'](_0x55c3f3(0x299),new Date(_0x1f318d[0x0]['ValidUpto']))),$(_0x55c3f3(0x269)+_0x1f318d[0x0][_0x55c3f3(0x282)]+']')[_0x55c3f3(0x2a3)](_0x55c3f3(0x1dd),_0x55c3f3(0x200)),$('#btnExtSubmit')[_0x55c3f3(0x223)]();}else IsUpdate=![],$(_0x55c3f3(0x2b9))['val'](''),$(_0x55c3f3(0x1d7))[_0x55c3f3(0x2bd)](''),$(_0x55c3f3(0x24e))[_0x55c3f3(0x2bd)](''),$(_0x55c3f3(0x1f2))[_0x55c3f3(0x2bd)](''),$('option:selected',$('#TemplateType'))[_0x55c3f3(0x2bd)](''),$(_0x55c3f3(0x222))[_0x55c3f3(0x2bd)]($[_0x55c3f3(0x291)]['formatDate']('d\x20M,\x20y',new Date())),$(_0x55c3f3(0x267),$('#selectByUser'))[_0x55c3f3(0x2bd)](),$(_0x55c3f3(0x267),$(_0x55c3f3(0x1e0)))[_0x55c3f3(0x2bd)](),$(_0x55c3f3(0x23a))[_0x55c3f3(0x223)](),$(_0x55c3f3(0x1fe))[_0x55c3f3(0x2a3)]('src','https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo3.0@latest/SiteAssets/Titan-External-Employee-Portal/images/user_pic.jpg'),$(_0x55c3f3(0x226))[_0x55c3f3(0x2a3)](_0x55c3f3(0x2e5),_0x55c3f3(0x20f)),initializePeoplePicker(_0x55c3f3(0x2be),!![]),peoplePickerDiv=$(_0x55c3f3(0x233)),initializePeoplePicker(_0x55c3f3(0x21a),![]),peoplePickerDivsuper=$(_0x55c3f3(0x21f));});if(!IsUpdate)$[_0x23ac4d(0x2c8)](GetGueastUsers(email))[_0x23ac4d(0x1e8)](function(_0x234dd8){var _0x2613aa=_0x23ac4d;_0x234dd8['length']>0x0?(_0x234dd8[0x0][_0x2613aa(0x249)]==_0x2613aa(0x2b1)&&($(_0x2613aa(0x204))[_0x2613aa(0x26a)](),$(_0x2613aa(0x2e3))[_0x2613aa(0x223)](),$(_0x2613aa(0x2b9))[_0x2613aa(0x2bd)](_0x234dd8[0x0][_0x2613aa(0x285)])),_0x234dd8[0x0]['externalUserState']==_0x2613aa(0x265)&&($('#msgExtEmail')[_0x2613aa(0x219)]('Already\x20send\x20invitation\x20but\x20this\x20user\x20is\x20not\x20Accepted..'),$(_0x2613aa(0x2e3))[_0x2613aa(0x26a)](),$('#btnExtSubmit')[_0x2613aa(0x223)]())):($(_0x2613aa(0x2e3))[_0x2613aa(0x219)](_0x2613aa(0x29e)),$(_0x2613aa(0x2e3))[_0x2613aa(0x26a)](),$(_0x2613aa(0x204))[_0x2613aa(0x223)]());});else{}}else $(_0x23ac4d(0x25b))[_0x23ac4d(0x223)](),$('.error')['show'](),$(_0x23ac4d(0x2e3))[_0x23ac4d(0x223)](),$(_0x23ac4d(0x204))[_0x23ac4d(0x223)]();}),$(_0x5ba411(0x204))[_0x5ba411(0x2c2)](function(){AddNewGuest();}),$(_0x5ba411(0x23a))[_0x5ba411(0x2c2)](function(){UpdateGeustuser(userListItemId);}),$('#GueastextinputFile')[_0x5ba411(0x247)](function(){readURL(this);}),$('#btnotherOrganizationSearch')[_0x5ba411(0x2c2)](function(){try{}catch(_0x295ae8){alert(_0x295ae8);}});});