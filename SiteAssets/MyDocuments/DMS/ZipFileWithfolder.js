var a0_0x22149c=a0_0x4b8e;(function(_0xda4f79,_0xceb000){var _0x37aba4=a0_0x4b8e,_0x153a68=_0xda4f79();while(!![]){try{var _0x435eac=-parseInt(_0x37aba4(0x1a3))/0x1+parseInt(_0x37aba4(0x193))/0x2+parseInt(_0x37aba4(0x164))/0x3+-parseInt(_0x37aba4(0x15b))/0x4*(-parseInt(_0x37aba4(0x18d))/0x5)+-parseInt(_0x37aba4(0x17a))/0x6*(parseInt(_0x37aba4(0x173))/0x7)+-parseInt(_0x37aba4(0x183))/0x8+-parseInt(_0x37aba4(0x18e))/0x9*(-parseInt(_0x37aba4(0x184))/0xa);if(_0x435eac===_0xceb000)break;else _0x153a68['push'](_0x153a68['shift']());}catch(_0x56dbf5){_0x153a68['push'](_0x153a68['shift']());}}}(a0_0x561a,0x210b2));const selectedFolders=[];function a0_0x561a(){var _0x3b8317=['Folders','\x27)?$expand=Folders,Files,\x20ListItemAllFields/EffectiveBasePermissions,\x20Files/ListItemAllFields/EffectiveBasePermissions','fadeIn','prop','initPropertiesFromJson','Yes','lastIndexOf','This\x20is\x20an\x20empty\x20folder\x20&\x20can\x27t\x20be\x20downloaded.','when','results','</table>','reject','\x27)/GetFolderByServerRelativeUrl(\x27','60413VBypeQ','DemoLibrary','catch','name','application/json;\x20odata=verbose','then','log','indexOf','Restricted\x20file(s)\x20are\x20skipped\x20to\x20download','createElement','<input\x20type=\x27checkbox\x27\x20name=\x27files\x27\x20value=\x27','application/json;odata=verbose','all','Deferred','ajax','ListItemAllFields','hide','.zip','push','1008MohMHn','&$skiptoken=','fileserverrelativeurl','files_','fail','resolve','\x27)?$select=ID,EncodedAbsUrl,File_x0020_Type&$expand=Folders,Folders/ListItemAllFields/HasUniqueRoleAssignments,Files/ModifiedBy/Title,Files/ListItemAllFields/HasUniqueRoleAssignments,Folders/ListItemAllFields,Files,Files/ListItemAllFields,Files/ListItemAllFields/FileSizeDisplay&$orderby=Modified\x20desc','https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js','LibraryName','455151ozgDgZ','getScript','.chkShareToMe','SelectedLibrary','__next','map','done','GET','\x20Files/folders\x20with\x20restricted\x20view\x20permission\x20can\x27t\x20be\x20downloaded.','forEach','apply','BasePermissions','portalUrl','/_api/web/GetFolderByServerRelativeUrl(\x27','blob','63WRUcXw','</td></tr>','FileFolderName','openItems','<tr><th>Select</th><th>Name</th></tr>','FileRef','</td><td>','114132rTXkpS','skiptoken=','ServerRelativeUrl','Files','/_api/web/GetFolderByServerRelativePath(\x27','/_api/web/lists/getbytitle(\x27','has','There\x20was\x20a\x20problem\x20with\x20the\x20fetch\x20operation:','concat','664472UgZyAA','160vXBHMc','checked','file','SiteURL','download','toJSON','href','PermissionKind','webAbsoluteUrl','785ZZhCmU','117189wTyGPa','error','<tr><td>','promise','Error\x20checking\x20file\x20permissions:\x20','100798RoYjeF','length','<table>'];a0_0x561a=function(){return _0x3b8317;};return a0_0x561a();}var zip,listName=a0_0x22149c(0x1a4),folderName=[];const myTimeout='';var messagetext='',Ismessage=![],IsleftRestritcfile=![];function a0_0x4b8e(_0x1cc796,_0x40eb01){var _0x561a17=a0_0x561a();return a0_0x4b8e=function(_0x4b8e6b,_0x117a97){_0x4b8e6b=_0x4b8e6b-0x155;var _0x244acc=_0x561a17[_0x4b8e6b];return _0x244acc;},a0_0x4b8e(_0x1cc796,_0x40eb01);}async function downloadSelectedFilesAsZip(_0x19371c){var _0x4d2364=a0_0x22149c;$[_0x4d2364(0x165)](_0x4d2364(0x162),function(){var _0x33e4be=_0x4d2364;_0x19371c[0x0][_0x33e4be(0x167)]==undefined?(listName=_0x19371c[0x0][_0x33e4be(0x163)],SiteUrl=_0x19371c[0x0][_0x33e4be(0x187)]):listName=_0x19371c[0x0][_0x33e4be(0x167)];var _0x53a27e=[];Ismessage=![],folderName=[],messagetext='';var _0x41c21a=_0x19371c['map'](function(_0x3ec46d){var _0x12320a=_0x33e4be;folderName[_0x12320a(0x15a)](_0x3ec46d[_0x12320a(0x175)]),_0x3ec46d['IsBlock']!=_0x12320a(0x19b)?_0x3ec46d[_0x12320a(0x15d)]==undefined?$[_0x12320a(0x19e)](getFolderFilesAndSubFolders(_0x3ec46d['ServerURL'],_0x53a27e))[_0x12320a(0x16a)](function(_0x19e6d5){return _0x41c21a=_0x19e6d5;}):$[_0x12320a(0x19e)](getFolderFilesAndSubFolders(_0x3ec46d[_0x12320a(0x15d)],_0x53a27e))[_0x12320a(0x16a)](function(_0x404f2c){return _0x41c21a=_0x404f2c;}):(Ismessage=!![],messagetext=_0x12320a(0x16c));}),_0x182205='';_0x53a27e[_0x33e4be(0x194)]>0x0?Promise[_0x33e4be(0x1af)](_0x41c21a)[_0x33e4be(0x1a8)](function(){var _0x16b7ae=_0x33e4be;zip=new JSZip();var _0x913847=_0x53a27e['map'](function(_0x4fafbc){var _0x5ec30a=a0_0x4b8e,_0x186f13=_spPageContextInfo[_0x5ec30a(0x170)]+_0x4fafbc;return fetch(_0x186f13)['then'](function(_0x21eff1){var _0x1b5a56=_0x5ec30a;if(!_0x21eff1['ok'])throw new Error('Network\x20response\x20was\x20not\x20ok');return _0x21eff1[_0x1b5a56(0x172)]();})['then'](function(_0x32b1d8){var _0x5a70c6=_0x5ec30a,_0x2db432=_0x4fafbc['substring'](_0x4fafbc['indexOf'](listName)+listName[_0x5a70c6(0x194)]+0x1);zip[_0x5a70c6(0x186)](_0x2db432,_0x32b1d8);})[_0x5ec30a(0x1a5)](_0x2f7eae=>{var _0xdce60a=_0x5ec30a;console[_0xdce60a(0x18f)](_0xdce60a(0x181),_0x2f7eae);});});Promise[_0x16b7ae(0x1af)](_0x913847)[_0x16b7ae(0x1a8)](function(){dowloadZip();});}):(Ismessage?alert(messagetext):alert(_0x33e4be(0x19d)),IsleftRestritcfile=![],waitingDialog[_0x33e4be(0x158)]());});}function dowloadZip(){var _0x449e1a=a0_0x22149c;zip['generateAsync']({'type':_0x449e1a(0x172)})[_0x449e1a(0x1a8)](function(_0x2b07b1){var _0x19ec3f=_0x449e1a,_0xf40bc9=document[_0x19ec3f(0x1ac)]('a');_0xf40bc9[_0x19ec3f(0x18a)]=URL['createObjectURL'](_0x2b07b1),_0xf40bc9[_0x19ec3f(0x188)]=_0x19ec3f(0x15e)+new Date()[_0x19ec3f(0x189)]()['slice'](0x0,0x14)+_0x19ec3f(0x159),_0xf40bc9['click'](),waitingDialog[_0x19ec3f(0x158)](),IsleftRestritcfile&&(alert(_0x19ec3f(0x1ab)),IsleftRestritcfile=![]),$('.chkFileFolder')[_0x19ec3f(0x199)](_0x19ec3f(0x185),![]),$(_0x19ec3f(0x166))[_0x19ec3f(0x199)](_0x19ec3f(0x185),![]),arrFileFolder=[];});}function getFilesFromLibrary(_0x410583){var _0x178aa7=a0_0x22149c,_0x645cb5=_0x410583+'/_api/web/lists/getByTitle(\x27DemoLibrary\x27)/items?$select=FileRef&$orderby=FileLeafRef&$filter=FSObjType\x20eq\x201';$[_0x178aa7(0x156)]({'url':_0x645cb5,'type':_0x178aa7(0x16b),'headers':{'Accept':_0x178aa7(0x1ae)},'beforeSend':function(){var _0x4e36f0=_0x178aa7;$('#overlaysearch')[_0x4e36f0(0x198)]();},'success':function(_0x3c5bbc){var _0x1989dc=_0x178aa7,_0x585669=_0x3c5bbc['d']['results'],_0x21516b=[];_0x585669[_0x1989dc(0x16d)](function(_0x454bdd){var _0x52478d=_0x1989dc,_0x39e486=_0x454bdd['FileRef']['substring'](_0x454bdd['FileRef'][_0x52478d(0x19c)]('/')+0x1),_0x57aeb1={'name':_0x39e486,'url':_0x454bdd['FileRef'],'checkbox':_0x52478d(0x1ad)+_0x454bdd[_0x52478d(0x178)]+'\x27>'};_0x21516b['push'](_0x57aeb1);});var _0x50ae8b=_0x1989dc(0x195);_0x50ae8b+=_0x1989dc(0x177),_0x21516b['forEach'](function(_0x45e15c){var _0x182ec8=_0x1989dc;_0x50ae8b+=_0x182ec8(0x190)+_0x45e15c['checkbox']+_0x182ec8(0x179)+_0x45e15c[_0x182ec8(0x1a6)]+_0x182ec8(0x174);}),_0x50ae8b+=_0x1989dc(0x1a0),$('#fileList')['html'](_0x50ae8b);},'error':function(_0x57aa6f){console['log'](_0x57aa6f);}});}function getFolderFilesAndSubFolders(_0x5a314b,_0x4bd146){var _0x591d61=a0_0x22149c,_0x1ca0c0=SiteUrl+_0x591d61(0x171)+_0x5a314b+_0x591d61(0x197);return jQuery[_0x591d61(0x156)]({'url':_0x1ca0c0,'type':_0x591d61(0x16b),'async':![],'headers':{'accept':_0x591d61(0x1ae)},'beforeSend':function(){},'success':function(_0x1d132c){var _0x5438f3=_0x591d61,_0x1bc29c=parseBasePermissionss(_0x1d132c['d'][_0x5438f3(0x157)]['EffectiveBasePermissions']);if(_0x1bc29c!=![]){var _0x55a83c=_0x1d132c['d'][_0x5438f3(0x17d)][_0x5438f3(0x19f)];_0x55a83c[_0x5438f3(0x16d)](function(_0x582f4e){var _0x5d189c=_0x5438f3;parseBasePermissionss(_0x582f4e[_0x5d189c(0x157)]['EffectiveBasePermissions'])!=![]?_0x4bd146[_0x5d189c(0x15a)](_0x582f4e[_0x5d189c(0x17c)]):IsleftRestritcfile=!![];});var _0x66fc4d=_0x1d132c['d'][_0x5438f3(0x196)]['results'],_0x44ddc9=_0x66fc4d[_0x5438f3(0x169)](function(_0x50364e){var _0x4cb64f=_0x5438f3;getFolderFilesAndSubFolders(_0x50364e[_0x4cb64f(0x17c)],_0x4bd146);});}else IsleftRestritcfile=!![];},'error':function(_0x430e32){var _0x57adb2=_0x591d61;console[_0x57adb2(0x1a9)](_0x430e32);}}),_0x4bd146;}function parseBasePermissionss(_0x4d8c18){var _0x1479df=a0_0x22149c,_0x448211=new SP[(_0x1479df(0x16f))]();return _0x448211[_0x1479df(0x19a)](_0x4d8c18),_0x448211[_0x1479df(0x180)](SP[_0x1479df(0x18b)][_0x1479df(0x176)]);}var Isnotpermission=![];function checkFilePermission(_0x3d0611){var _0x213bfb=a0_0x22149c;Isnotpermission=![];var _0x28e70b=SiteUrl+_0x213bfb(0x17e)+_0x3d0611+_0x213bfb(0x161);return $[_0x213bfb(0x156)]({'url':_0x28e70b,'type':_0x213bfb(0x16b),'async':![],'headers':{'accept':'application/json;odata=verbose'},'success':function(_0x58c046){debugger;},'error':function(_0x50521f){var _0x4dd8ea=_0x213bfb;console[_0x4dd8ea(0x1a9)](_0x4dd8ea(0x192)+JSON['stringify'](_0x50521f));}}),Isnotpermission;}function retrieveAllItemsFromFolder(_0x59d79a,_0x49886f){var _0x467491=a0_0x22149c,_0x3e0da8=$[_0x467491(0x155)](),_0xa20b6=[];_0x1042e2(_0x59d79a,_0x49886f,null,_0xa20b6);function _0x1042e2(_0x302c70,_0xc303fb,_0x2de965,_0x2e6413){var _0x38f521=_0x467491,_0x5cb72d=_spPageContextInfo[_0x38f521(0x18c)]+_0x38f521(0x17f)+_0x302c70+'\x27)/items?$top=5000';_0xc303fb&&(_0x5cb72d+='&$filter=FileDirRef\x20eq\x20\x27'+_0xc303fb+'\x27'),_0x2de965&&(_0x5cb72d+=_0x38f521(0x15c)+encodeURIComponent(_0x2de965)),$[_0x38f521(0x156)]({'url':_0x5cb72d,'method':_0x38f521(0x16b),'headers':{'Accept':_0x38f521(0x1a7)},'success':function(_0x48dbe8){var _0x2cf896=_0x38f521;_0x2e6413=_0x2e6413[_0x2cf896(0x182)](_0x48dbe8['d'][_0x2cf896(0x19f)]);if(_0x48dbe8['d'][_0x2cf896(0x168)]){var _0xde08=_0x48dbe8['d'][_0x2cf896(0x168)],_0x5ca114=_0xde08['substring'](_0xde08[_0x2cf896(0x1aa)](_0x2cf896(0x17b))+0xa);_0x1042e2(_0x302c70,_0xc303fb,_0x5ca114,_0x2e6413);}else _0x25591a(_0x302c70,_0xc303fb,_0x2e6413)['then'](function(_0x208da3){_0x3e0da8['resolve'](_0x208da3);})[_0x2cf896(0x15f)](function(_0x1263fb){_0x3e0da8['reject'](_0x1263fb);});},'error':function(_0x2be7b7){var _0x19b406=_0x38f521;_0x3e0da8[_0x19b406(0x1a1)](_0x2be7b7);}});}function _0x25591a(_0x55fea1,_0x3d938a,_0x30312d){var _0xb21ac9=_0x467491,_0x46072a=$[_0xb21ac9(0x155)](),_0x2f0fe5=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27'+_0x55fea1+_0xb21ac9(0x1a2)+_0x3d938a+'\x27)/folders';return $['ajax']({'url':_0x2f0fe5,'method':_0xb21ac9(0x16b),'headers':{'Accept':_0xb21ac9(0x1a7)},'success':function(_0x3dfca7){var _0x46f906=_0xb21ac9,_0x191ed6=_0x3dfca7['d'][_0x46f906(0x19f)],_0x3e223c=$[_0x46f906(0x169)](_0x191ed6,function(_0xcdaaf6){var _0xf85c66=_0x46f906,_0xea532=_0xcdaaf6[_0xf85c66(0x17c)];return _0x1042e2(_0x55fea1,_0xea532,null,_0x30312d);});$['when'][_0x46f906(0x16e)]($,_0x3e223c)[_0x46f906(0x16a)](function(){var _0x48e043=_0x46f906,_0x1239ec=[];for(var _0x32c7b7=0x0;_0x32c7b7<arguments[_0x48e043(0x194)];_0x32c7b7++){_0x1239ec=_0x1239ec['concat'](arguments[_0x32c7b7]);}var _0x2a4c91=_0x30312d['concat'](_0x1239ec);_0x46072a[_0x48e043(0x160)](_0x2a4c91);})[_0x46f906(0x15f)](function(_0x177e4f){var _0x4d1dfe=_0x46f906;_0x46072a[_0x4d1dfe(0x1a1)](_0x177e4f);});},'error':function(_0x1185f3){_0x46072a['reject'](_0x1185f3);}}),_0x46072a[_0xb21ac9(0x191)]();}return _0x3e0da8['promise']();}