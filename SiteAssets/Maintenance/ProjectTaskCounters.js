var a0_0x4cf87c=a0_0x5b37;(function(_0x5c97c1,_0x2882d0){var _0x1f2323=a0_0x5b37,_0x5a58d8=_0x5c97c1();while(!![]){try{var _0x5cc236=parseInt(_0x1f2323(0xeb))/0x1*(-parseInt(_0x1f2323(0xe9))/0x2)+parseInt(_0x1f2323(0x130))/0x3+parseInt(_0x1f2323(0x13d))/0x4+parseInt(_0x1f2323(0x14b))/0x5*(parseInt(_0x1f2323(0x12d))/0x6)+parseInt(_0x1f2323(0x10f))/0x7+parseInt(_0x1f2323(0xdf))/0x8*(parseInt(_0x1f2323(0x13e))/0x9)+-parseInt(_0x1f2323(0x109))/0xa*(parseInt(_0x1f2323(0x135))/0xb);if(_0x5cc236===_0x2882d0)break;else _0x5a58d8['push'](_0x5a58d8['shift']());}catch(_0x4c79ac){_0x5a58d8['push'](_0x5a58d8['shift']());}}}(a0_0x5e96,0x7a28a));function getProjects(){var _0x27d48d=a0_0x5b37,_0x2a3344=_0x27d48d(0xef);return DeferredObj=$['Deferred'](),$[_0x27d48d(0x149)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x27d48d(0x125)+_0x2a3344+'\x27)/items/?$select=*&$top=5000','type':_0x27d48d(0x144),'async':![],'headers':{'ACCEPT':'application/json;odata=verbose','X-RequestDigest':$(_0x27d48d(0x13a))[_0x27d48d(0x133)]()},'success':function(_0x517fb0){var _0xc44546=_0x27d48d,_0x458a2e=_0x517fb0['d']['results'];if(_0x458a2e[_0xc44546(0xf0)]>0x0){for(var _0x44d881=0x0;_0x44d881<_0x458a2e[_0xc44546(0xf0)];_0x44d881++){getEmployeeTaskDetails(_0x458a2e[_0x44d881]['ID']);}alert(_0xc44546(0x140));}waitingDialog['hide']();},'error':function(_0x41c722){var _0xd3a6c=_0x27d48d;alert(JSON[_0xd3a6c(0x122)](_0x41c722)),DeferredObj[_0xd3a6c(0xf9)](_0x41c722);}}),DeferredObj[_0x27d48d(0xec)]();};function getEmployeeTaskDetails(_0x47d3fd){var _0x5f4f25=a0_0x5b37;$[_0x5f4f25(0x149)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x5f4f25(0x13c)+_0x47d3fd+_0x5f4f25(0x10c),'method':_0x5f4f25(0x144),'async':![],'headers':{'Accept':_0x5f4f25(0x131)},'success':function(_0x523d16,_0x413c2a,_0x37444b){var _0x2376fe=_0x5f4f25,_0x401ebc=_0x523d16['d']['results'],_0x2e2cb9,_0x28a6ac,_0x34fbfc,_0x18c021,_0x3d6cc4=0x0;_0x401ebc[_0x2376fe(0xf0)]>0x0&&(_0x2e2cb9=_0x401ebc[_0x2376fe(0xf6)](function(_0x58704f){var _0x45afb4=_0x2376fe;return _0x58704f[_0x45afb4(0x132)]==_0x45afb4(0x115);}),_0x28a6ac=_0x401ebc[_0x2376fe(0xf6)](function(_0x26307b){var _0x5274b2=_0x2376fe;return _0x26307b[_0x5274b2(0x132)]==_0x5274b2(0x107);}),_0x34fbfc=_0x401ebc['filter'](function(_0xe61f3f){var _0x36aac9=_0x2376fe;return _0xe61f3f[_0x36aac9(0x132)]==_0x36aac9(0x101);}),_0x18c021=_0x401ebc[_0x2376fe(0xf6)](function(_0x17b7ce){var _0x3ba1ab=_0x2376fe;return _0x17b7ce['CurrentPhase']==_0x3ba1ab(0x13b);}),_0x3d6cc4=_0x401ebc[_0x2376fe(0xf6)](function(_0x2d6feb){var _0x2dc21e=_0x2376fe;return _0x2d6feb[_0x2dc21e(0x132)]==_0x2dc21e(0x126);}),_0x2e2cb9=_0x2e2cb9[_0x2376fe(0xf0)],_0x28a6ac=_0x28a6ac[_0x2376fe(0xf0)],_0x34fbfc=_0x34fbfc['length'],_0x18c021=_0x18c021[_0x2376fe(0xf0)],_0x3d6cc4=_0x3d6cc4['length']),updateProjectCounter(_0x47d3fd,_0x2e2cb9,_0x28a6ac,_0x34fbfc,_0x18c021,_0x3d6cc4);},'error':function(_0x576bfc,_0x2c8105,_0x4e70db){var _0x39cee1=_0x5f4f25;console[_0x39cee1(0x119)](_0x576bfc[_0x39cee1(0x104)]);}});}function updateProjectCounter(_0x3d47cb,_0x5b5447,_0x17b90d,_0x1919ab,_0x5d25c3,_0x350ec2){var _0x56bb83=a0_0x5b37,_0x4caa3f=GetItemTypeForListName('ProjectDetails');Metadata={'__metadata':{'type':_0x4caa3f},'OpenTasks':_0x5b5447,'OnHoldTasks':_0x17b90d,'CompletedTasks':_0x1919ab,'CloseTasks':_0x5d25c3,'CompletedTasks':_0x350ec2};var _0x4cb4a4=$[_0x56bb83(0x138)]();return $[_0x56bb83(0x149)]({'url':_spPageContextInfo[_0x56bb83(0x106)]+_0x56bb83(0x127)+_0x3d47cb+')','type':'POST','async':![],'headers':{'accept':_0x56bb83(0x131),'X-RequestDigest':$(_0x56bb83(0x13a))[_0x56bb83(0x133)](),'content-Type':'application/json;odata=verbose','X-Http-Method':_0x56bb83(0x11f),'If-Match':'*'},'data':JSON[_0x56bb83(0x122)](Metadata),'success':function(_0xd3e4f3){var _0x59357d=_0x56bb83;_0x4cb4a4['resolve'](_0xd3e4f3),console[_0x59357d(0x119)](_0x59357d(0xe3));},'eror':function(_0x240a09){var _0xacff64=_0x56bb83;_0x4cb4a4['reject'](error),console[_0xacff64(0x119)](_0xacff64(0x141)+JSON[_0xacff64(0x122)](_0x240a09));}}),_0x4cb4a4[_0x56bb83(0xec)]();}function addEnvironmentalSettingsEntry(){var _0x42f89e=a0_0x5b37;listItems=[_0x42f89e(0xfd),_0x42f89e(0xfa),'Timesheet',_0x42f89e(0x11e)];for(var _0xb72f01=0x0;_0xb72f01<=0x3;_0xb72f01++){var _0x28327f=_0x42f89e(0x11b),_0x209fe3;_0x209fe3={'__metadata':{'type':_0x42f89e(0x123)},'Title':listItems[_0xb72f01],'Active':_0x42f89e(0x11a)};var _0x51bb41=getItemByTitle(listItems[_0xb72f01]);_0x51bb41['length']==0x0&&$[_0x42f89e(0x134)](AddItemEmp(_0x28327f,_0x209fe3))[_0x42f89e(0xf2)](function(_0xffa030){var _0x211931=_0x42f89e;_0xb72f01==0x4&&alert(_0x211931(0x146));});}}function getItemByTitle(_0x2e9728){var _0x3f0082=a0_0x5b37,_0x3c49f2=_0x3f0082(0x11b),_0x524b26='';return DeferredObj=$[_0x3f0082(0x138)](),$[_0x3f0082(0x149)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x3f0082(0x125)+_0x3c49f2+_0x3f0082(0x142)+_0x2e9728+'\x27','type':'GET','async':![],'headers':{'ACCEPT':_0x3f0082(0x131),'X-RequestDigest':$(_0x3f0082(0x13a))[_0x3f0082(0x133)]()},'success':function(_0x42192a){var _0x436700=_0x3f0082;return _0x524b26=_0x42192a['d'][_0x436700(0x118)],_0x524b26;},'error':function(_0x1387a6){var _0x321bb7=_0x3f0082;alert(JSON[_0x321bb7(0x122)](_0x1387a6)),DeferredObj[_0x321bb7(0xf9)](_0x1387a6);}}),_0x524b26;};function getTaskItemByTaskCategory(){var _0x58a1e0=a0_0x5b37,_0x1d8513=_0x58a1e0(0x10d);return DeferredObj=$[_0x58a1e0(0x138)](),$['ajax']({'url':_spPageContextInfo[_0x58a1e0(0x106)]+'/_api/web/lists/getbytitle(\x27'+_0x1d8513+_0x58a1e0(0xe6),'type':_0x58a1e0(0x144),'async':![],'headers':{'ACCEPT':_0x58a1e0(0x131),'X-RequestDigest':$(_0x58a1e0(0x13a))[_0x58a1e0(0x133)]()},'success':function(_0x7cb342){var _0x4b1429=_0x58a1e0,_0x5c02ef=_0x7cb342['d'][_0x4b1429(0x118)];if(_0x5c02ef[_0x4b1429(0xf0)]>0x0){for(var _0x5c596a=0x0;_0x5c596a<_0x5c02ef[_0x4b1429(0xf0)];_0x5c596a++){updateTaskCategory(_0x5c02ef[_0x5c596a]['ID']);}alert(_0x4b1429(0x140));}waitingDialog[_0x4b1429(0xff)]();},'error':function(_0x22f763){var _0x5526d7=_0x58a1e0;alert(JSON[_0x5526d7(0x122)](_0x22f763)),DeferredObj['reject'](_0x22f763);}}),DeferredObj['promise']();};function updateTaskCategory(_0xc50f12){var _0x4d4b0d=a0_0x5b37,_0x4ec725=GetItemTypeForListName('EmployeeTaskDetails');Metadata={'__metadata':{'type':_0x4ec725},'TaskCategory':_0x4d4b0d(0xf5)};var _0x4ebd21=$['Deferred']();return $[_0x4d4b0d(0x149)]({'url':_spPageContextInfo[_0x4d4b0d(0x106)]+_0x4d4b0d(0xed)+_0xc50f12+'\x27)','type':_0x4d4b0d(0x13f),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x4d4b0d(0x13a))['val'](),'content-Type':_0x4d4b0d(0x131),'X-Http-Method':_0x4d4b0d(0x11f),'If-Match':'*'},'data':JSON['stringify'](Metadata),'success':function(_0x15ed63){var _0x5eaabf=_0x4d4b0d;_0x4ebd21[_0x5eaabf(0x137)](_0x15ed63),console[_0x5eaabf(0x119)](_0x5eaabf(0x12a));},'eror':function(_0x3ea29e){var _0x585561=_0x4d4b0d;_0x4ebd21[_0x585561(0xf9)](error),console['log'](_0x585561(0x12c)+JSON[_0x585561(0x122)](_0x3ea29e));}}),_0x4ebd21['promise']();}function a0_0x5b37(_0x2f1923,_0x52381f){var _0x5e9684=a0_0x5e96();return a0_0x5b37=function(_0x5b375e,_0x4fb901){_0x5b375e=_0x5b375e-0xdf;var _0x37d1d9=_0x5e9684[_0x5b375e];return _0x37d1d9;},a0_0x5b37(_0x2f1923,_0x52381f);}var CompanySiteURL='';function getCurrentCopaniesURL(){var _0x5ac069=a0_0x5b37,_0x35b60d=_0x5ac069(0x129),_0x51d5f3=Logged_CompanyId;siteURL=_spPageContextInfo[_0x5ac069(0x106)]+_0x5ac069(0x125)+_0x35b60d+_0x5ac069(0x143)+_0x51d5f3+'\x27',$[_0x5ac069(0x149)]({'url':siteURL,'headers':{'Accept':_0x5ac069(0x131)},'async':![],'success':function(_0x3810b1){var _0x449afb=_0x5ac069,_0xf89242=_0x3810b1['d'][_0x449afb(0x118)];_0xf89242[_0x449afb(0xf0)]>0x0&&(CompanySiteURL=_0xf89242[0x0]['SiteURL'],waitingDialog[_0x449afb(0xe7)](),setTimeout(function(){getMediaGalleryAllItems();},0x1f4));},'eror':function(_0xb1daa8){var _0x54de74=_0x5ac069;alert($(_0x54de74(0x12b))[_0x54de74(0x133)]());}});}function getMediaGalleryAllItems(){var _0x66b7be=a0_0x5b37,_0x333bd0=CompanySiteURL+'/_api/Web/lists/GetByTitle(\x27MediaGallery\x27)/rootfolder/folders?$select=*,FileRef,FileLeafRef&$orderby=TimeCreated\x20desc&$top=5000';$[_0x66b7be(0x149)]({'url':_0x333bd0,'headers':{'Accept':_0x66b7be(0x131)},'async':![],'success':function(_0x1008d7){var _0x23f78b=_0x66b7be,_0x5434ee=_0x1008d7['d'][_0x23f78b(0x118)];console[_0x23f78b(0x119)](_0x1008d7),$(_0x23f78b(0xfc))[_0x23f78b(0x111)](),mediaGalleryCounter=0x0;for(var _0xd36cf6=0x0;_0xd36cf6<_0x5434ee[_0x23f78b(0xf0)];_0xd36cf6++){if(_0x5434ee[_0xd36cf6][_0x23f78b(0xf8)]!=_0x23f78b(0x139)&&_0x5434ee[_0xd36cf6][_0x23f78b(0xf8)]!='_t'&&_0x5434ee[_0xd36cf6]['Name']!='_w'){var _0x33545c=_0x5434ee[_0xd36cf6][_0x23f78b(0xfe)];GetFolderDetails(_0x33545c);}}alert(_0x23f78b(0x102)),waitingDialog[_0x23f78b(0xff)]();},'error':function(_0x1eb02e){alert(_0x1eb02e);}});}function GetFolderDetails(_0x38070f){var _0x19294e=a0_0x5b37;fileLeafRef=_0x38070f;var _0x2167a4=CompanySiteURL+_0x19294e(0x10a)+_0x38070f+_0x19294e(0xf1);$['ajax']({'url':_0x2167a4,'headers':{'Accept':_0x19294e(0x131)},'async':![],'success':function(_0x178ab7){var _0x513e2a=_0x19294e,_0x5a8fff=_0x178ab7['d'][_0x513e2a(0x118)];if(_0x5a8fff['length']>0x0){var _0x2eb9e8=_0x5a8fff[0x0][_0x513e2a(0x108)],_0x1cb156=_0x5a8fff[0x0]['Id'],_0x1902c0=_0x5a8fff[0x0][_0x513e2a(0x112)];fillDateTakenInMedia(_0x1cb156,_0x2eb9e8,_0x1902c0);}},'error':function(_0x5a24c6){alert(_0x5a24c6);}});}function fillDateTakenInMedia(_0x7f39f8,_0x557d6a,_0x18ed38){var _0x2cf73d=a0_0x5b37,_0x323004=new Date(_0x18ed38);_0x323004=_0x323004[_0x2cf73d(0xe8)]('MM/dd/yyyy'),$[_0x2cf73d(0x149)]({'url':CompanySiteURL+_0x2cf73d(0xe0)+_0x7f39f8+'\x27)','type':_0x2cf73d(0x13f),'async':![],'data':JSON[_0x2cf73d(0x122)]({'__metadata':{'type':_0x2cf73d(0x120)},'Title':_0x557d6a,'ImageCreateDate':_0x323004}),'headers':{'Accept':_0x2cf73d(0x131),'Content-Type':_0x2cf73d(0x131),'X-RequestDigest':$(_0x2cf73d(0x13a))[_0x2cf73d(0x133)](),'IF-MATCH':'*','X-HTTP-Method':_0x2cf73d(0x121)},'success':function(_0x325ce5,_0x254f40,_0x189611){var _0x357a42=_0x2cf73d;console['log'](_0x357a42(0x148));},'error':function(_0x53a0af){alert(_0x53a0af);}});}function Addto_outlook(_0x311807){var _0x5a4cc4=a0_0x5b37,_0x16aca6=titanForWork[_0x5a4cc4(0xe2)](_0x5a4cc4(0xea))+_0x5a4cc4(0x110)+_0x311807+'\x27)&$select=FieldValuesAsText/EventDate';$[_0x5a4cc4(0x149)]({'url':_0x16aca6,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x4d227b){var _0x32ff35=_0x5a4cc4,_0x885241=_0x4d227b['d']['results'];if(_0x885241[_0x32ff35(0xf0)]>0x0)var _0x2ae57f=_0x885241[0x0][_0x32ff35(0x12e)],_0x577e10=_0x885241[0x0]['EndDate'],_0x447966=_0x885241[0x0][_0x32ff35(0x10b)],_0x2da567=_0x885241[0x0][_0x32ff35(0x147)],_0x303047=_0x885241[0x0][_0x32ff35(0xf3)],_0x46241d=_0x885241[0x0][_0x32ff35(0x11d)],_0x2eed92=_0x885241[0x0]['Location'];},'error':function(_0xe0c4ca){var _0x3aa1b2=_0x5a4cc4;console[_0x3aa1b2(0x119)](_0xe0c4ca);}});}$('#document')[a0_0x4cf87c(0xe5)](function(){var _0x507118=a0_0x4cf87c;$(_0x507118(0x117))[_0x507118(0x10e)](function(){uploadUserphoto();});});var uploadUserphoto=()=>{var _0x412cf9=a0_0x4cf87c;try{ClientCredentials();var _0x1dae2e=new FileReader();fileInput=document[_0x412cf9(0xf7)](_0x412cf9(0x116));var _0x565747={'Authorization':_0x412cf9(0x11c)+accessToken,'content-type':_0x412cf9(0x128)};_0x1dae2e[_0x412cf9(0x103)]=function(_0x5d493b){var _0x52e7df=_0x412cf9,_0x360d5e=_0x5d493b[_0x52e7df(0x113)][_0x52e7df(0x124)],_0x328704=$[_0x52e7df(0x149)]({'url':_0x52e7df(0x14a),'method':_0x52e7df(0xfb),'headers':_0x565747,'body':_0x360d5e,'success':function(_0x23c4dc){var _0x272519=_0x52e7df;console[_0x272519(0x119)]('Profile\x20picture\x20updated\x20successfully!');},'error':function(_0x361e2f){var _0x72f1e0=_0x52e7df;console[_0x72f1e0(0x119)](_0x72f1e0(0x100),_0x361e2f[_0x72f1e0(0xf4)],_0x361e2f[_0x72f1e0(0x14c)]);}});},_0x1dae2e[_0x412cf9(0xee)](fileInput[_0x412cf9(0x105)][0x0]);}catch(_0x1aeaeb){alert(_0x1aeaeb);}},ClientUrl='',ClientId='',ClentSecret='',accessToken='';function a0_0x5e96(){var _0x825cf2=['CurrentPhase','val','when','3388187uitkVb','client_credentials','resolve','Deferred','Forms','#__REQUESTDIGEST','Close','/_api/web/lists/getByTitle(\x27EmployeeTaskDetails\x27)/items/?$top=5000&$filter=ProjectIDId\x20eq\x20','1302828dWEypJ','143541UZwbKj','POST','Successfully!','An\x20error\x20occurred\x20while\x20deleting\x20Application.\x20','\x27)/items/?$select=Id,Title&$filter=Title\x20eq\x20\x27','\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20\x27','GET','/_api/web/lists/GetByTitle(\x27','Submit\x20successfully','Category','Updated!','ajax','https://graph.microsoft.com/v1.0/users/lakhan.sharma@adapt-india.com/photo/$value','25OeDnvn','statusText','376mKkNpI','/_api/web/lists/GetByTitle(\x27MediaGallery\x27)/items(\x27','CompanyId','getQueryStringParameter','Successfully.','access_token','ready','\x27)/items/?$select=*&$top=5000&$filter=TaskCategory\x20eq\x20null','show','format','1522766eWKfHb','CompanySiteUrl','1JbHRzR','promise','/_api/web/lists/getbytitle(\x27EmployeeTaskDetails\x27)/GetItemById(\x27','readAsArrayBuffer','ProjectDetails','length','\x27\x20and\x20ImageCreateDate\x20eq\x20null','done','Department','status','General','filter','getElementById','Name','reject','Attendance\x20Entry','PUT','#galleryFirstImgThumb','Timesheet\x20Entry','ServerRelativeUrl','hide','Profile\x20picture\x20update\x20failed:','Completed','Successfully\x20done!','onload','responseText','files','webAbsoluteUrl','Hold','FileLeafRef','50aLwfXO','/_api/Web/lists/GetByTitle(\x27MediaGallery\x27)/Items?$select=*,File_x0020_Type,Author/Title,Author/EMail,FileRef,FileLeafRef&$expand=Author/Title&$filter=FileRef\x20eq\x20\x27','Title','&$select=ID,CurrentPhase','EmployeeTaskDetails','click','4661860ZtiQJJ','/_api/web/lists/getbytitle(\x27Event\x27)/items?$filter=ID\x20eq\x20(\x27','empty','Created','target','https://graph.microsoft.com/.default','Open','uploadUserImage','#btnUploadImage','results','log','Yes','EnvironmentalSettings','Bearer\x20','Description','Attendance','PATCH','SP.Data.MediaGalleryItem','MERGE','stringify','SP.Data.EnvironmentalSettingsListItem','result','/_api/web/lists/getbytitle(\x27','Cancelled','/_api/web/lists/getbytitle(\x27ProjectDetails\x27)/GetItemById(','image/jpeg','Companies','All\x20Task\x27s\x20Priority\x20has\x20been\x20changed.','#txtSomethingWentWrong','An\x20error\x20occurred\x20while\x20deleting\x20task.\x20','443766wVRFEt','EventDate','\x27)/items?$filter=Title\x20eq\x20\x27Client_Credentials\x27\x20','2072205iIIjLg','application/json;odata=verbose'];a0_0x5e96=function(){return _0x825cf2;};return a0_0x5e96();}function requestToken(){var _0x2b345f=a0_0x4cf87c;$['ajax']({'async':![],'crossDomain':!![],'url':ClientUrl,'method':_0x2b345f(0x13f),'headers':{'Authorization':'Bearer','Content-Type':'application/x-www-form-urlencoded'},'data':{'grant_type':_0x2b345f(0x136),'client_id':ClientId,'client_secret':ClentSecret,'scope':_0x2b345f(0x114)},'success':function(_0x4a9850){var _0x2b18e5=_0x2b345f;console[_0x2b18e5(0x119)](_0x4a9850),accessToken=_0x4a9850[_0x2b18e5(0xe4)];},'error':function(_0x351f31){var _0xd04663=_0x2b345f;console[_0xd04663(0x119)](JSON[_0xd04663(0x122)](_0x351f31));}});}function ClientCredentials(){var _0x5388a3=a0_0x4cf87c,_0x18b512=_0x5388a3(0x11b),_0x443ed3=titanForWork['getQueryStringParameter'](_0x5388a3(0xe1)),_0x4d5953=_spPageContextInfo['webAbsoluteUrl']+_0x5388a3(0x145)+_0x18b512+_0x5388a3(0x12f);$[_0x5388a3(0x149)]({'url':_0x4d5953,'headers':{'Accept':_0x5388a3(0x131)},'async':![],'success':function(_0x2115ea){var _0x835654=_0x5388a3,_0x187b09=_0x2115ea['d'][_0x835654(0x118)];ClientId=_0x187b09[0x0]['ClientName'],ClentSecret=_0x187b09[0x0]['ChangeFileName'],ClientUrl=_0x187b09[0x0][_0x835654(0x11d)],requestToken();},'error':function(_0x4f3cec){var _0x50ec25=_0x5388a3;console[_0x50ec25(0x119)](_0x4f3cec);}});}