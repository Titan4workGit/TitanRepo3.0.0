var a0_0x4fde84=a0_0x15a7;(function(_0x5851c6,_0x4d928e){var _0x271c64=a0_0x15a7,_0x5b771b=_0x5851c6();while(!![]){try{var _0x355c0b=-parseInt(_0x271c64(0x2a7))/0x1*(-parseInt(_0x271c64(0x259))/0x2)+parseInt(_0x271c64(0x2d5))/0x3*(-parseInt(_0x271c64(0x241))/0x4)+parseInt(_0x271c64(0x299))/0x5*(parseInt(_0x271c64(0x231))/0x6)+parseInt(_0x271c64(0x2ca))/0x7+-parseInt(_0x271c64(0x20c))/0x8+parseInt(_0x271c64(0x283))/0x9*(parseInt(_0x271c64(0x2e6))/0xa)+parseInt(_0x271c64(0x285))/0xb;if(_0x355c0b===_0x4d928e)break;else _0x5b771b['push'](_0x5b771b['shift']());}catch(_0x5eafd3){_0x5b771b['push'](_0x5b771b['shift']());}}}(a0_0x26a0,0x4bd84));function a0_0x26a0(){var _0x344b2c=['yyyy','False','attr','OfficeLocation','/_api/web/lists/getbytitle(\x27ProjectTeamDetails\x27)/items?$select=ID,TeamMemberId&$filter=ProjectId\x20eq\x20\x27','Title','/_api/web','PlanedEndDate','{{Status}}','SP.Data.ProjectTeamDetailsListItem','Body','SP.Data.','option','indexOf','<option\x20value=\x22','MaximumEntitySuggestions','/_api/web/lists/getByTitle(\x27Documents\x27)/roleassignments/getbyprincipalid(','Please\x20fill\x20all\x20required\x20fields.','prop','.txtPlannedEndDate','{{ProjectManager}}','ready','sourceLocation','OLD\x20PROJECT\x20MANAGER\x20RELESED!','{{PlannedEndDate}}','dateFormat','1755565WLPlNd','when','GetAllUserInfo','SponsorTeamEmployeePicker','load','Deferred','get_lists','true','__next','ManagerNameId','Terminated','735VMbyTs','\x20Successfully\x20removed\x20Permission\x20!','dd/MM/yyyy','</ul>','#txtProjectName','<select\x20name=\x22officeLocation\x22\x20id=\x22departmentDetails\x22\x20class=\x22form-control\x22>','Project\x20Details\x20Updated\x20Successfully','{{ProjectClientName}}','GET','DepartmentId','Estimated\x20hours\x20cannot\x20be\x20less\x20than\x20zero.','<span\x20title=\x22','EntityType','#SponsorTeam','#departmentDiv','undefined','push','14320FVGRGw','toString','../Pages/Default.aspx?WebAppId=','checked','.txtActualStartDate','/_api/web/lists/getbytitle(\x27Employees\x27)/items/','-Select-','Department','TeamPermission','Relesed','.multiSel','?$select=Email,LogonName/EMail,Status&$expand=LogonName&$filter=\x20Status\x20eq\x20\x27Active\x27\x20and\x20(LogonName/EMail\x20eq\x20\x27','\x27\x20or\x20Email\x20eq\x20\x27','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?select=*,ID,Title&$filter=OfficeLocationID\x20eq\x20\x27','Project\x20site','location','#__REQUESTDIGEST','{{Location}}','click','.multiSel\x20span','ProjectDescription','CloseWaitDialog','/_api/web/lists/getbytitle(\x27ProgramList\x27)/items?select=ID,Title&$top=5000&$orderby=Title\x20asc','appendTo','#ProjectStatus\x20option[value=','input[type=\x22checkbox\x22]','getFullYear','CompanySiteUrl','OfficeLocationID','/_api/web/lists/getByTitle(\x27Documents\x27)/roleassignments/addroleassignment(principalid=','User\x20has\x20been\x20assigned\x20permission\x20.','ClientName','Key','ProjectSiteURL','parents','Consultant_List','disabled','ListItem','.sp-peoplepicker-delImage','SPClientPeoplePickerDict','ProjectID','add\x20success','keyCode','select#departmentDetails\x20option:selected','Permission\x20has\x20been\x20assigned\x20successfully!','error\x20:\x20Project\x20Details\x20web\x20part','.dropdown\x20dd\x20ul','</span>','sp.js','getItems','keypress','AllowMultipleValues','.txtPlannedStartDate','text','</select>','/_api/Web/Lists/GetByTitle(\x27ProjectDetails\x27)/Items?$select=Title&$filter=ProjectCode\x20eq\x20\x27','format','getItemsWithQueryItem','/_api/web/lists/getbytitle(\x27ProjectDetails\x27)/items?$expand=ProgramID,MultipleStackeholder,ManagerName,Stackeholder,MultipleSponsor,ClientID,Sponsor,Author&$select=*,ProgramID/Id,ProgramID/Title,Stackeholder/UserName,Sponsor/UserName,MultipleStackeholder/UserName,MultipleSponsor/UserName,ManagerName/Title,ManagerName/UserName,ClientID/Title,Author/ID,Author/Title,Author/EMail&$filter=ID\x20eq\x20\x27','\x27\x20and\x20CompanyID\x20eq\x20\x27','ClientContext','ajax','ERROR\x20:\x20OLD\x20PROJECT\x20MANAGER\x20RELESED!','userId','.ActualEndDate','round','ProjectInternalName','.txtActualEndDate\x20','#txtSomethingWentWrong','reject','EstimatedWorkHours','get_current','getQueryStringParameter','ProcessApprovers','Completed','ActualStartDate','dropdown','ConsultantName','Employees','/_api/web/lists/GetByTitle(\x27ProjectTeamDetails\x27)/items(\x27','ProjectTeamDetails','/Pages/ViewProjectDetails.aspx?WebAppId=','slideToggle','Please\x20Fill\x20the\x20Manager','{{PlannedStartDate}}','SearchPrincipalSource','MultipleStackeholder','\x27\x20and\x20Holiday_start\x20ge\x20\x27','Stakeholders\x20should\x20be\x20internal\x20employeees\x20only.','getTime','SP.User','#txtWorkingDays','ExpectedReleseDate','.SideTabMenu','MERGE','atob','Actual\x20End\x20Date\x20can\x20not\x20less\x20than\x20Actual\x20Start\x20Date.','#txtTechnology\x20option','select#TaskTeamDetails\x20option[value=\x22','getDate','GetProjectManager','replace','\x27\x20and\x20Holiday_start\x20le\x20\x27','TaskPermission','data','.MandActDate','Remove','.messageCheckbox','TeamMemberId','Author','#ProjectStatus','selected','application/json;odata=verbose','json','i:0#.f|membership|','ResolvePrincipalSource','stackToUsers','#ddlProgramList','MultipleSponsor','#CreatedOn','getByTitle','#txtDomain','Project\x20Manager\x20Added\x20As\x20A\x20Default\x20Team\x20Member.','slice','Status','=([^&#]*)','error','#StackeholderTeam','remove','projecttouser','1073741826','webAbsoluteUrl','ProgramID','3664840GqKItH','toISOString','User','SiteURL','Permission\x20has\x20been\x20removed\x20successfully!','.hida','CamlQuery','#officeLocation','/_api/Web/Lists/GetByTitle(\x27ProjectDetails\x27)/Items?$select=Title&$filter=CompanyId\x20eq\x20\x27','resolve','\x27)/items','get_web','ProjectDetails','href','append','isSiteAdmin','executeQueryAsync','ClientID','<option\x20value=\x220\x22>-Select-</option>','dt\x20a\x20span.value','SP.Utilities.EmailProperties','concat','.mutliSelect','#EstimatedTime','focus','empty','change','[?&]','Active','#createNewProjectSite','includes','hide','select#officeLocationDetails\x20option:selected','promise','Project\x20Manager','StackeholderTeamEmployeePicker','POST','18588nbVkyT','Add','#TaskTeamDetails','CatogeryName','DepartmentName','\x27\x20and\x20CompanyId\x20eq\x20\x27','SOD','ActualEndDate','/_api/web/lists/getbytitle(\x27CategoryMaster\x27)/items?$select=CategoryType,CatogeryName&$filter=CategoryType\x20eq\x20\x27Project\x20Type\x27\x20and\x20Status\x20eq\x20\x27Yes\x27','trim','</option>','&ProjectName=','length','Please\x20enter\x20Actual\x20End\x20Date.','join','True','7328sIvWNL','each','split','fast','#txtTechnology','datepicker','ProjectManagerEmployeePicker','Width','#clientTitle','ProjectCode','\x27\x20and\x20Role\x20eq\x20\x27Project\x20Manager\x27\x20and\x20Status\x20eq\x20\x27Active\x27&$OrderBy\x20ID\x20desc','find','siteAbsoluteUrl','html','Project\x20name\x20already\x20exist.','1073741829','results','Employee\x20is\x20not\x20active\x20','UserName','&ProjectID=','dd-M-yy','#masterFooter','MM\x20dd,\x20yy','#officeLocationDetails','38908jIhmtH','#txtDescription','IsModal','get_item','Unauthorized\x20access!','\x20and\x20LogonNameId\x20eq\x20','done','\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20\x27','/_api/SP.Utilities.Utility.SendEmail','{{Department}}','Sponsor','/_api/web/lists/getbytitle(\x27ProjectTeamDetails\x27)/items?$select=*,ID&$filter=ProjectId\x20eq\x20\x27','.txtActualEndDate','stringify','#s4-bodyContainer\x20.navbar-custom','Stackeholder','toLowerCase','ProjectName','forEach','StackeholderId','executeOrDelayUntilScriptLoaded','DocumentPermission','Message\x20has\x20been\x20sent.','application/json;\x20odata=verbose','\x27\x20and\x20ContributorsId\x20eq\x20\x27','TechnologyUsed','/_api/web/siteusers(@v)?@v=\x27','getMonth','#txtProjectCode','{{ProjectCode}}','ManagerName','charAt','\x27)/GetItemById(\x27','[id^=\x27','moveNext','set_viewXml','filter','log','#departmentDetails','sponsorToUsers','val','-50:+50','3222uizltM','getEnumerator','248248ExSjud','#ProjectManagerEmployeePicker_TopSpan_ResolvedList','message','&&ProjectName=','userEmail','\x27)/items?$select=*,Department/DepartmentName,Department/ID&$expand=Department&$filter=CompanyId\x20eq\x20\x27','Subject','webServerRelativeUrl','PlanedStartDate','PATCH','Project','formatDate','charCode',':checked','Project\x20Admin','\x27\x20and\x20(WebPartName\x20eq\x20\x27Project\x20Admin\x27\x20or\x20WebPartName\x20eq\x20\x27Project\x27)','OnHold','Please\x20enter\x20Actual\x20Start\x20Date.','<li><input\x20class=\x22messageCheckbox\x22\x20type=\x22checkbox\x22\x20value=','\x27\x20and\x20Id\x20ne\x20\x27','100qzYbdQ','WebPartName','Live','.dropdown\x20dd\x20ul\x20li\x20a','/_api/web/lists/getbytitle(\x27','CompanyId','<ul>','\x27&$OrderBy\x20ID\x20desc','bind','An\x20error\x20occurred\x20in\x20Program\x20method.','.dropdown\x20dt\x20a','/DMS/','#cancelProjectEdit','OfficeName','19SgMViO','urlParam','toUpperCase','SP.Web','Domain','<View><OrderBy><FieldRef\x20Name=\x27ID\x27\x20Ascending=\x27False\x27/></OrderBy></View>','show','Planned\x20End\x20Date\x20can\x20not\x20less\x20than\x20Planned\x20Start\x20Date.','Departments'];a0_0x26a0=function(){return _0x344b2c;};return a0_0x26a0();}var projectInternalName='',projectItemID='',CreatedId='';$(document)[a0_0x4fde84(0x2c5)](function(){var _0x36bb0b=a0_0x4fde84;SP[_0x36bb0b(0x237)][_0x36bb0b(0x26d)](Initialization_ProjectSite,_0x36bb0b(0x316));}),$(document)['ready'](function(){var _0x40eedb=a0_0x4fde84;companyID=Logged_CompanyId,getProjectRights(),projecttouser='',InitializePeoplePicker(_0x40eedb(0x247),![]),InitializePeoplePicker(_0x40eedb(0x2cd),!![]),InitializePeoplePicker(_0x40eedb(0x22f),!![]),$('.dropdown\x20dt\x20a')['on'](_0x40eedb(0x2f8),function(){var _0x393250=_0x40eedb;$(_0x393250(0x314))[_0x393250(0x338)](_0x393250(0x244));}),$(_0x40eedb(0x29c))['on'](_0x40eedb(0x2f8),function(){var _0x3fcbec=_0x40eedb;$(_0x3fcbec(0x314))[_0x3fcbec(0x22b)]();});function _0x1906f5(_0x992595){var _0x777501=_0x40eedb;return $('#'+_0x992595)[_0x777501(0x24c)](_0x777501(0x21f))['html']();}$(document)[_0x40eedb(0x2a1)](_0x40eedb(0x2f8),function(_0x2e5252){var _0x38b028=_0x40eedb,_0x15e48a=$(_0x2e5252['target']);if(!_0x15e48a[_0x38b028(0x308)]()['hasClass'](_0x38b028(0x332)))$(_0x38b028(0x314))[_0x38b028(0x22b)]();}),$('.txtPlannedStartDate')[_0x40eedb(0x246)]({'changeMonth':!![],'changeYear':!![],'yearRange':'-50:+50'}),$(_0x40eedb(0x31a))[_0x40eedb(0x246)](_0x40eedb(0x2bc),_0x40eedb(0x2c9),_0x40eedb(0x257)),$(_0x40eedb(0x2ea))[_0x40eedb(0x246)]({'changeMonth':!![],'changeYear':!![],'yearRange':'-50:+50'}),$(_0x40eedb(0x2ea))[_0x40eedb(0x246)](_0x40eedb(0x2bc),_0x40eedb(0x2c9),_0x40eedb(0x257)),$(_0x40eedb(0x265))[_0x40eedb(0x246)]({'changeMonth':!![],'changeYear':!![],'yearRange':_0x40eedb(0x282)}),$('.txtActualEndDate')['datepicker'](_0x40eedb(0x2bc),_0x40eedb(0x2c9),_0x40eedb(0x257)),$(_0x40eedb(0x2d9))['blur'](function(){var _0x15f694=_0x40eedb,_0x160fd9=$(_0x15f694(0x2d9))[_0x15f694(0x281)]();$[_0x15f694(0x23a)]($(_0x15f694(0x2d9))[_0x15f694(0x281)]())!=''&&CheckProjectCodeExistOrNot(_0x15f694(0x240),_0x160fd9);}),window['atob']($[_0x40eedb(0x2a8)](_0x40eedb(0x25b)))==_0x40eedb(0x2d1)&&($(_0x40eedb(0x267))['hide'](),$(_0x40eedb(0x343))[_0x40eedb(0x22b)](),$('#ms-designer-ribbon')[_0x40eedb(0x22b)](),$(_0x40eedb(0x256))[_0x40eedb(0x22b)]());}),$['urlParam']=function(_0x55ca81){var _0x480a8e=a0_0x4fde84,_0x12101d=new RegExp(_0x480a8e(0x227)+_0x55ca81+_0x480a8e(0x204))['exec'](window['location'][_0x480a8e(0x219)]);return _0x12101d==null?_0x12101d='null':_0x12101d[0x1]||0x0;};function InitializePeoplePicker(_0x428278,_0x5a30ad){var _0x49f0cd=a0_0x4fde84;_0x5a30ad==null&&(_0x5a30ad=![]);var _0x10044d={};_0x10044d['PrincipalAccountType']=_0x49f0cd(0x20e),_0x10044d[_0x49f0cd(0x33b)]=0xf,_0x10044d[_0x49f0cd(0x1fa)]=0xf,_0x10044d[_0x49f0cd(0x319)]=_0x5a30ad,_0x10044d[_0x49f0cd(0x2bf)]=0x32,_0x10044d[_0x49f0cd(0x248)]='100%',SPClientPeoplePicker_InitStandaloneControlWrapper(_0x428278,null,_0x10044d);}function getPeopleUserInfoGroups(_0x5c6966){var _0x2a87e2=a0_0x4fde84,_0x1fe899=new Array(),_0x2ad564=$('[id^=\x27'+_0x5c6966+'\x27]'),_0x2c779a=SPClientPeoplePicker[_0x2a87e2(0x30d)][_0x2ad564[0x1]['id']],_0x1412f2=_0x2c779a[_0x2a87e2(0x2cc)]();if(_0x1412f2[_0x2a87e2(0x23d)]>0x0)for(var _0x1bb270=0x0;_0x1bb270<_0x1412f2[_0x2a87e2(0x23d)];_0x1bb270++){_0x1fe899[_0x2a87e2(0x2e5)](GetUserIdGroups(_0x1412f2[_0x1bb270][_0x2a87e2(0x306)]));}return _0x1fe899;}function GetUserIdGroups(_0x14ee6d){var _0x23aac0=a0_0x4fde84,_0x3631ad='',_0x4cdc21=_0x23aac0(0x1f9),_0x1df8dd=_spPageContextInfo[_0x23aac0(0x24d)],_0x33bcf4=_0x14ee6d;return $[_0x23aac0(0x323)]({'url':_0x1df8dd+_0x23aac0(0x273)+encodeURIComponent(_0x33bcf4)+'\x27','method':_0x23aac0(0x2dd),'headers':{'Accept':'application/json;\x20odata=verbose'},'async':![],'success':function(_0x21db60){_0x3631ad=_0x21db60['d']['Id'];},'error':function(_0x116def){var _0x396ad2=_0x23aac0;console[_0x396ad2(0x27e)](JSON[_0x396ad2(0x266)](_0x116def));}}),_0x3631ad;}function getmultiselctValue(){var _0x5eca8c=a0_0x4fde84;$('.mutliSelect\x20input[type=\x22checkbox\x22]')['on'](_0x5eca8c(0x2f8),function(){var _0xba0526=_0x5eca8c,_0x1d365c=$(this)['closest']('.mutliSelect')[_0xba0526(0x24c)](_0xba0526(0x2ff))[_0xba0526(0x281)](),_0x1d365c=$(this)['val']()+',';if($(this)['is'](_0xba0526(0x292))){var _0x30627f=_0xba0526(0x2e0)+_0x1d365c+'\x22>'+_0x1d365c+_0xba0526(0x315);$(_0xba0526(0x2f0))[_0xba0526(0x21a)](_0x30627f),$(_0xba0526(0x211))[_0xba0526(0x22b)]();}else{$('span[title=\x22'+_0x1d365c+'\x22]')[_0xba0526(0x207)]();var _0x54bbeb=$('.hida');$(_0xba0526(0x2a3))['append'](_0x54bbeb);}}),$('#txtProjectCode')['blur'](function(){var _0x5087ae=_0x5eca8c,_0x1ef034=$(_0x5087ae(0x275))[_0x5087ae(0x281)]();$[_0x5087ae(0x23a)]($(_0x5087ae(0x275))['val']())!=''&&CheckProjectCodeExistOrNot('False',_0x1ef034);});var _0x2d7181=new Array();_0x2d7181['push'](0x8),_0x2d7181[_0x5eca8c(0x2e5)](0x9),_0x2d7181[_0x5eca8c(0x2e5)](0x2e),_0x2d7181['push'](0x24),_0x2d7181['push'](0x23),_0x2d7181[_0x5eca8c(0x2e5)](0x25),_0x2d7181[_0x5eca8c(0x2e5)](0x27),_0x2d7181[_0x5eca8c(0x2e5)](0x20),$(_0x5eca8c(0x2d9))[_0x5eca8c(0x318)](function(_0x49ca9b){var _0x1ce15e=_0x5eca8c,_0x1cca09=_0x49ca9b[_0x1ce15e(0x310)]==0x0?_0x49ca9b[_0x1ce15e(0x291)]:_0x49ca9b[_0x1ce15e(0x310)],_0x838a36=_0x1cca09>=0x30&&_0x1cca09<=0x39||_0x1cca09>=0x41&&_0x1cca09<=0x5a||_0x1cca09>=0x61&&_0x1cca09<=0x7a||_0x2d7181[_0x1ce15e(0x2bd)](_0x49ca9b[_0x1ce15e(0x310)])!=-0x1&&_0x49ca9b[_0x1ce15e(0x291)]!=_0x49ca9b[_0x1ce15e(0x310)]||_0x49ca9b[_0x1ce15e(0x310)]==0x20;return _0x838a36;});}function a0_0x15a7(_0x4bf560,_0x44cfc9){var _0x26a0c8=a0_0x26a0();return a0_0x15a7=function(_0x15a750,_0x50c930){_0x15a750=_0x15a750-0x1ef;var _0x13c081=_0x26a0c8[_0x15a750];return _0x13c081;},a0_0x15a7(_0x4bf560,_0x44cfc9);}function Initialization_ProjectSite(){var _0x29c569=a0_0x4fde84;departmentID=titanForWork[_0x29c569(0x32e)]('DepartmentId'),companyID=Logged_CompanyId;if(companyID>0x0&&departmentID>0x0)getCurrentURL_EventCreateProjectSite(_0x29c569(0x2af),departmentID);else companyID>0x0&&departmentID!=_0x29c569(0x2e4)&&getCurrentURL_EventCreateProjectSite('Companies',companyID);}function getCurrentURL_EventCreateProjectSite(_0x955db4,_0x11e94d){var _0x37131b=a0_0x4fde84;siteURLProjects=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27'+_0x955db4+_0x37131b(0x260)+_0x11e94d+'\x27',$[_0x37131b(0x323)]({'url':siteURLProjects,'headers':{'Accept':_0x37131b(0x1f7)},'async':![],'success':function(_0x25f1f8){var _0x3e80e1=_0x37131b,_0xfc1655=_0x25f1f8['d'][_0x3e80e1(0x251)];_0xfc1655[_0x3e80e1(0x23d)]>0x0&&(siteURL=_0xfc1655[0x0][_0x3e80e1(0x20f)],siteclientContext=new SP['ClientContext'](siteURL),getConsultantDetails(siteclientContext),getDepartment(),officeLocation(),bindProjectType(),setTimeout(function(){GetProjectDetails();},0x7d0));},'error':function(_0x5a4967){var _0x1f923d=_0x37131b;console['log']($(_0x1f923d(0x32a))[_0x1f923d(0x281)]());}});}function getDepartment(){var _0x3332eb=a0_0x4fde84,_0x266882=titanForWork[_0x3332eb(0x32e)](_0x3332eb(0x29e)),_0x51efde=new SP[(_0x3332eb(0x322))](),_0x1a7f08=_0x51efde[_0x3332eb(0x217)]()[_0x3332eb(0x2d0)]()[_0x3332eb(0x1ff)]('Departments'),_0x58cfd1=new SP[(_0x3332eb(0x212))](),_0x3ec093='<View><Query><Where><Eq><FieldRef\x20Name=\x27CompanyID\x27\x20/><Value\x20Type=\x27Lookup\x27>'+_0x266882+'</Value></Eq></Where><OrderBy><FieldRef\x20Name=\x27Title\x27/></OrderBy></Query></View>';_0x58cfd1[_0x3332eb(0x27c)](_0x3ec093);var _0x1ac2bf=_0x1a7f08[_0x3332eb(0x317)](_0x58cfd1);_0x51efde[_0x3332eb(0x2ce)](_0x1ac2bf),_0x51efde[_0x3332eb(0x21c)](function(){var _0x44dd91=_0x3332eb,_0x212226=_0x1ac2bf[_0x44dd91(0x284)](),_0x84c6ae=0x1,_0x446a6b=_0x44dd91(0x2da);_0x446a6b+=_0x44dd91(0x21e);while(_0x212226[_0x44dd91(0x27b)]()){var _0x3f3766=_0x212226['get_current'](),_0x207b25=_0x3f3766[_0x44dd91(0x25c)]('ID'),_0x33bd7d=_0x3f3766['get_item'](_0x44dd91(0x2b5));_0x446a6b+=_0x44dd91(0x2be)+_0x207b25+'\x22>'+_0x33bd7d+_0x44dd91(0x23b),_0x84c6ae++;}_0x446a6b+=_0x44dd91(0x31c),$('#departmentDiv')['append'](_0x446a6b),IsProjectAdmin==!![]?($('#departmentDetails')[_0x44dd91(0x2c2)](_0x44dd91(0x30a),![]),$(_0x44dd91(0x2d9))[_0x44dd91(0x2c2)](_0x44dd91(0x30a),![])):($(_0x44dd91(0x27f))['prop'](_0x44dd91(0x30a),!![]),$('#txtProjectName')['prop']('disabled',!![]));},function(){var _0x38309a=_0x3332eb;console[_0x38309a(0x27e)](_0x38309a(0x313));});}function officeLocation(){var _0x3f146c=a0_0x4fde84,_0x22a76a=titanForWork['getQueryStringParameter']('CompanyId'),_0x3dbe5c=new SP['ClientContext'](),_0x3027a0=_0x3dbe5c['get_web']()[_0x3f146c(0x2d0)]()[_0x3f146c(0x1ff)]('OfficeLocation'),_0x4625b8=new SP[(_0x3f146c(0x212))](),_0x40a6fc='<View><Query><Where><And><Eq><FieldRef\x20Name=\x27CompanyID\x27\x20/><Value\x20Type=\x27Lookup\x27>'+_0x22a76a+'</Value></Eq><Eq><FieldRef\x20Name=\x27OfficeLocationId\x27\x20/><Value\x20Type=\x27Text\x27>0</Value></Eq></And></Where><OrderBy><FieldRef\x20Name=\x27OfficeName\x27/></OrderBy></Query></View>';_0x4625b8[_0x3f146c(0x27c)](_0x40a6fc);var _0x385bab=_0x3027a0[_0x3f146c(0x317)](_0x4625b8);_0x3dbe5c['load'](_0x385bab),_0x3dbe5c[_0x3f146c(0x21c)](function(){var _0x4e9f90=_0x3f146c,_0x516c9f=_0x385bab[_0x4e9f90(0x284)](),_0xeb0240=0x1,_0x5c9abb='<select\x20name=\x22officeLocation\x22\x20id=\x22officeLocationDetails\x22\x20class=\x22form-control\x22>';_0x5c9abb+=_0x4e9f90(0x21e);while(_0x516c9f[_0x4e9f90(0x27b)]()){var _0x2a34d5=_0x516c9f[_0x4e9f90(0x32d)](),_0x25e411=_0x2a34d5[_0x4e9f90(0x25c)]('ID'),_0x48b0f7=_0x2a34d5[_0x4e9f90(0x25c)](_0x4e9f90(0x2a6));_0x5c9abb+=_0x4e9f90(0x2be)+_0x25e411+'\x22>'+_0x48b0f7+'</option>',_0xeb0240++;}_0x5c9abb+=_0x4e9f90(0x31c),$(_0x4e9f90(0x213))[_0x4e9f90(0x21a)](_0x5c9abb);},function(){var _0x4e83ad=_0x3f146c;console[_0x4e83ad(0x27e)](_0x4e83ad(0x313));});}function getConsultantDetails(_0x25d714){var _0x1dd243=a0_0x4fde84,_0x2480b5=_0x25d714['get_web']()[_0x1dd243(0x2d0)]()['getByTitle'](_0x1dd243(0x309)),_0x418373=new SP[(_0x1dd243(0x212))]();_0x418373[_0x1dd243(0x27c)](_0x1dd243(0x2ac));var _0x4c7504=_0x2480b5[_0x1dd243(0x317)](_0x418373);_0x25d714['load'](_0x4c7504),_0x25d714[_0x1dd243(0x21c)](function(){var _0x5653d9=_0x1dd243,_0x2ba083=_0x5653d9(0x29f),_0x31372a=_0x4c7504[_0x5653d9(0x284)](),_0xc898bb=_0x4c7504['get_count'](),_0x3d96ea=0x1;if(_0xc898bb>0x0){while(_0x31372a[_0x5653d9(0x27b)]()){var _0x33b0cb=_0x31372a['get_current'](),_0x4bdea0=_0x33b0cb[_0x5653d9(0x25c)]('Consultant_Comp');_0x2ba083+=_0x5653d9(0x297)+_0x4bdea0+'\x20/>'+_0x4bdea0+'</li>',_0x3d96ea++;}_0x2ba083+=_0x5653d9(0x2d8),$(_0x5653d9(0x222))[_0x5653d9(0x21a)](_0x2ba083),getmultiselctValue();}},function(){});}function getConsultantValue(){var _0x1ef60c=a0_0x4fde84,_0x42c1b2='';return $(_0x1ef60c(0x2f9))[_0x1ef60c(0x242)](function(){var _0x5a5125=_0x1ef60c;_0x42c1b2+=$(this)[_0x5a5125(0x24e)]();}),_0x42c1b2;}function setPeoplePickerUsersInfoCurrentGroups(_0x5187f7,_0x992536){var _0x446799=a0_0x4fde84,_0x174bf0=$(_0x446799(0x27a)+_0x5187f7+'\x27]'),_0x77968=SPClientPeoplePicker['SPClientPeoplePickerDict'][_0x174bf0[0x1]['id']];_0x77968['AddUserKeys'](_0x992536,![]);}var OldPMNameID='';function GetProjectDetails(){var _0x2a3f8a=a0_0x4fde84;BindPrograms();var _0x2a6857=titanForWork[_0x2a3f8a(0x32e)](_0x2a3f8a(0x30e));siteURL=_spPageContextInfo['webAbsoluteUrl']+_0x2a3f8a(0x320)+_0x2a6857+'\x27',$[_0x2a3f8a(0x323)]({'url':siteURL,'headers':{'Accept':_0x2a3f8a(0x1f7)},'async':![],'success':function(_0x5288ee){var _0x45703d=_0x2a3f8a,_0x4786d9=_0x5288ee['d']['results'],_0x4b2ba7=_0x4786d9[0x0][_0x45703d(0x2d3)];if(_0x4b2ba7!=_spPageContextInfo[_0x45703d(0x325)]&&IsProjectAdmin!=!![]&&IsDeptmentAdmin!=!![])alert(_0x45703d(0x25d)),window[_0x45703d(0x2f5)][_0x45703d(0x219)]=_0x45703d(0x2e8)+titanForWork[_0x45703d(0x32e)](_0x45703d(0x29e))+'';else{_0x4786d9[0x0]['ProjectInternalName']==null||_0x4786d9[0x0]['ProjectInternalName']==''?projectInternalName=_0x4786d9[0x0][_0x45703d(0x26a)]:projectInternalName=_0x4786d9[0x0][_0x45703d(0x328)];var _0x48bfda=_0x4786d9[0x0]['Author']['Title'];CreatedId=_0x4786d9[0x0][_0x45703d(0x1f4)]['ID'];var _0x4721c9=new Date(_0x4786d9[0x0]['Created']);_0x4721c9=$[_0x45703d(0x246)]['formatDate'](_0x45703d(0x255),_0x4721c9),$('#createdByName')[_0x45703d(0x31b)](_0x48bfda),$(_0x45703d(0x1fe))[_0x45703d(0x31b)](_0x4721c9);_0x4786d9[0x0][_0x45703d(0x268)]['UserName']!=null&&setPeoplePickerUsersInfoCurrentGroups('StackeholderTeamEmployeePicker',_0x4786d9[0x0]['Stackeholder'][_0x45703d(0x253)]);_0x4786d9[0x0][_0x45703d(0x263)][_0x45703d(0x253)]!=null&&setPeoplePickerUsersInfoCurrentGroups(_0x45703d(0x2cd),_0x4786d9[0x0][_0x45703d(0x263)][_0x45703d(0x253)]);if(_0x4786d9[0x0][_0x45703d(0x33c)][_0x45703d(0x251)]!=null)for(var _0x3a26cd=0x0;_0x3a26cd<_0x4786d9[0x0]['MultipleStackeholder']['results'][_0x45703d(0x23d)];_0x3a26cd++){setPeoplePickerUsersInfoCurrentGroups(_0x45703d(0x22f),_0x4786d9[0x0][_0x45703d(0x33c)][_0x45703d(0x251)][_0x3a26cd][_0x45703d(0x253)]);}if(_0x4786d9[0x0][_0x45703d(0x1fd)][_0x45703d(0x251)]!=null)for(var _0x3a26cd=0x0;_0x3a26cd<_0x4786d9[0x0][_0x45703d(0x1fd)][_0x45703d(0x251)][_0x45703d(0x23d)];_0x3a26cd++){setPeoplePickerUsersInfoCurrentGroups('SponsorTeamEmployeePicker',_0x4786d9[0x0][_0x45703d(0x1fd)][_0x45703d(0x251)][_0x3a26cd]['UserName']);}var _0x31cd83=_0x4786d9[0x0][_0x45703d(0x21d)][_0x45703d(0x2b5)];;var _0x44a582=_0x4786d9[0x0][_0x45703d(0x203)],_0x50c48f=_0x4786d9[0x0]['ID'];projectItemID=_0x50c48f;var _0x417691=_0x4786d9[0x0][_0x45703d(0x333)];if(_0x417691!=null){var _0x1b38e2=_0x417691['split'](',');$('.mutliSelect\x20li')[_0x45703d(0x242)](function(_0x7bf564){var _0x5c6b80=_0x45703d,_0x24dd5d=$(this)['text'](),_0x39896a=_0x1b38e2[_0x5c6b80(0x2bd)](_0x24dd5d);if(_0x39896a>-0x1){$(this)[_0x5c6b80(0x24c)](_0x5c6b80(0x1f2))[_0x5c6b80(0x2c2)](_0x5c6b80(0x2e9),!![]),title=_0x24dd5d+',';var _0x4d71f8=_0x5c6b80(0x2e0)+title+'\x22>'+title+_0x5c6b80(0x315);$('.multiSel')[_0x5c6b80(0x21a)](_0x4d71f8),$(_0x5c6b80(0x211))['hide']();}});}var _0x373209=new Date(_0x4786d9[0x0][_0x45703d(0x28d)]);_0x373209=$[_0x45703d(0x246)][_0x45703d(0x290)](_0x45703d(0x257),_0x373209),$(_0x45703d(0x31a))['val'](_0x373209);var _0x1b50bf=new Date(_0x4786d9[0x0][_0x45703d(0x2b7)]);$(_0x45703d(0x2c3))['datepicker']({'changeMonth':!![],'changeYear':!![],'yearRange':'-50:+50','minDate':new Date(_0x4786d9[0x0]['PlanedStartDate'])}),$(_0x45703d(0x2c3))[_0x45703d(0x246)](_0x45703d(0x2bc),'dateFormat',_0x45703d(0x257)),_0x1b50bf=$[_0x45703d(0x246)][_0x45703d(0x290)](_0x45703d(0x257),_0x1b50bf),$(_0x45703d(0x2c3))[_0x45703d(0x281)](_0x1b50bf);var _0x4b2907=_0x4786d9[0x0][_0x45703d(0x331)];_0x4b2907!=null&&(_0x4b2907=new Date(_0x4786d9[0x0][_0x45703d(0x331)]),_0x4b2907=$[_0x45703d(0x246)][_0x45703d(0x290)]('MM\x20dd,\x20yy',_0x4b2907),$('.txtActualStartDate')[_0x45703d(0x281)](_0x4b2907));var _0x2cc7a9=_0x4786d9[0x0][_0x45703d(0x238)];_0x2cc7a9!=null&&(_0x2cc7a9=new Date(_0x4786d9[0x0][_0x45703d(0x238)]),_0x2cc7a9=$[_0x45703d(0x246)][_0x45703d(0x290)]('MM\x20dd,\x20yy',_0x2cc7a9),$('.txtActualEndDate')[_0x45703d(0x281)](_0x2cc7a9));$(_0x45703d(0x275))[_0x45703d(0x281)](_0x4786d9[0x0][_0x45703d(0x24a)]),$(_0x45703d(0x2d9))['val'](_0x4786d9[0x0][_0x45703d(0x26a)]),$(_0x45703d(0x200))['val'](_0x4786d9[0x0][_0x45703d(0x2ab)]);var _0x520916=_0x4786d9[0x0][_0x45703d(0x2de)];$(_0x45703d(0x27f))[_0x45703d(0x281)](_0x520916);var _0x37d713=_0x4786d9[0x0][_0x45703d(0x302)];$(_0x45703d(0x258))['val'](_0x37d713);var _0x4b2ba7=_0x4786d9[0x0][_0x45703d(0x2d3)];OldPMNameID=_0x4786d9[0x0][_0x45703d(0x2d3)];var _0x18d68b=_0x4786d9[0x0][_0x45703d(0x277)][_0x45703d(0x253)];setPeoplePickerUsersInfoCurrentGroups(_0x45703d(0x247),_0x18d68b);var _0x502332=_0x4786d9[0x0][_0x45703d(0x26c)];$(_0x45703d(0x206))[_0x45703d(0x24c)](_0x45703d(0x348)+_0x502332+'\x22]')[_0x45703d(0x2b2)](_0x45703d(0x1f6),_0x45703d(0x1f6));var _0x64459e=_0x4786d9[0x0]['SponsorId'];$(_0x45703d(0x2e2))['find'](_0x45703d(0x348)+_0x64459e+'\x22]')[_0x45703d(0x2b2)](_0x45703d(0x1f6),_0x45703d(0x1f6));var _0x41a014=_0x4786d9[0x0][_0x45703d(0x21d)][_0x45703d(0x2b5)],_0x2a4ea5=_0x4786d9[0x0]['ClientIDId'];$(_0x45703d(0x249))['val'](_0x41a014),$('#clientTitle')[_0x45703d(0x2c2)](_0x45703d(0x30a),!![]);_0x44a582!=''&&$(_0x45703d(0x2fe)+_0x44a582+']')[_0x45703d(0x2b2)](_0x45703d(0x1f6),_0x45703d(0x1f6));if(_0x44a582==_0x45703d(0x29b)||_0x44a582=='OnHold')$(_0x45703d(0x326))[_0x45703d(0x22b)]();else(_0x44a582==_0x45703d(0x330)||_0x44a582==_0x45703d(0x2d4))&&$('.ActualEndDate')[_0x45703d(0x2ad)]();var _0x1c8c3d=$(_0x45703d(0x347))[_0x45703d(0x27d)](function(_0x44431b,_0x435a9c){var _0x1f3fbf=_0x45703d;return $(_0x435a9c)[_0x1f3fbf(0x281)]()==_0x4786d9[0x0]['TechnologyUsed'];});_0x1c8c3d[_0x45703d(0x23d)]>0x0?$('#txtTechnology')[_0x45703d(0x281)](_0x4786d9[0x0][_0x45703d(0x272)]):$(_0x45703d(0x245))['append']('<option\x20value=\x22'+_0x4786d9[0x0][_0x45703d(0x272)]+'\x22selected>'+_0x4786d9[0x0][_0x45703d(0x272)]+'</option>');_0x4786d9[0x0][_0x45703d(0x32c)]!=null?$(_0x45703d(0x223))[_0x45703d(0x281)](_0x4786d9[0x0]['EstimatedWorkHours']):$(_0x45703d(0x223))[_0x45703d(0x281)]('0');var _0x3d6f1e=$(_0x45703d(0x2c3))[_0x45703d(0x246)](_0x45703d(0x349)),_0x5e66ec=$(_0x45703d(0x31a))[_0x45703d(0x246)](_0x45703d(0x349)),_0x5af770=(_0x3d6f1e-_0x5e66ec)/(0x3e8*0x3c*0x3c*0x18),_0x5952bd=Math[_0x45703d(0x327)](_0x5af770)+0x1,_0x37f41f=LoadAllHolidays();$(_0x45703d(0x341))[_0x45703d(0x31b)](_0x5952bd+0x2-parseInt(_0x37f41f)),$(_0x45703d(0x25a))[_0x45703d(0x281)](_0x4786d9[0x0][_0x45703d(0x2fa)]);if(CreatedId!=_spPageContextInfo[_0x45703d(0x325)]&&_spPageContextInfo[_0x45703d(0x21b)]!=!![]){var _0x17c927=$(_0x45703d(0x27a)+'ProjectManagerEmployeePicker'+'\x27]');_0x17c927=SPClientPeoplePicker['SPClientPeoplePickerDict'][_0x17c927[0x1]['id']],_0x17c927['SetEnabledState'](![]),$(_0x45703d(0x286))[_0x45703d(0x24c)](_0x45703d(0x30c))['hide']();}(_0x4786d9[0x0][_0x45703d(0x203)]==_0x45703d(0x295)||_0x4786d9[0x0][_0x45703d(0x203)]==_0x45703d(0x29b))&&(_0x4786d9[0x0][_0x45703d(0x1f4)]['EMail']['toLowerCase']()==_spPageContextInfo['userEmail'][_0x45703d(0x269)]()||_0x4786d9[0x0]['ManagerName'][_0x45703d(0x253)][_0x45703d(0x269)]()==_spPageContextInfo[_0x45703d(0x289)][_0x45703d(0x269)]())&&($('.txtActualStartDate')['attr'](_0x45703d(0x30a),![]),$(_0x45703d(0x245))[_0x45703d(0x2b2)](_0x45703d(0x30a),![])),(_0x4786d9[0x0][_0x45703d(0x203)]==_0x45703d(0x330)||_0x4786d9[0x0][_0x45703d(0x203)]==_0x45703d(0x2d4))&&(_0x4786d9[0x0][_0x45703d(0x1f4)]['EMail'][_0x45703d(0x269)]()==_spPageContextInfo[_0x45703d(0x289)]['toLowerCase']()||_0x4786d9[0x0][_0x45703d(0x277)][_0x45703d(0x253)]['toLowerCase']()==_spPageContextInfo['userEmail']['toLowerCase']())&&$('.txtActualStartDate')[_0x45703d(0x2b2)]('disabled',![]),_0x4786d9[0x0][_0x45703d(0x20b)]['Id']!=null&&_0x4786d9[0x0][_0x45703d(0x20b)]['Id']!=0x0&&$(_0x45703d(0x1fc))['val'](_0x4786d9[0x0]['ProgramID']['Id']);}},'error':function(_0x8687f8){var _0x4fd0c9=_0x2a3f8a;console['log']($(_0x4fd0c9(0x32a))[_0x4fd0c9(0x281)]());}});}$(function(){bindButtonClick();});var NewPMNameID='',StartDate='',EndDate='';function bindButtonClick(){var _0x3a7c07=a0_0x4fde84;$(_0x3a7c07(0x229))['on']('click',function(){var _0x1f4a62=_0x3a7c07,_0x5735c9=$(_0x1f4a62(0x2d9))[_0x1f4a62(0x281)](),_0x5ccb17=$(_0x1f4a62(0x275))[_0x1f4a62(0x281)](),_0x38d8c2=$(_0x1f4a62(0x2e3))[_0x1f4a62(0x24c)](_0x1f4a62(0x27f))[_0x1f4a62(0x281)](),_0x427fdf=$(_0x1f4a62(0x213))[_0x1f4a62(0x24c)](_0x1f4a62(0x258))[_0x1f4a62(0x281)](),_0x72d156=$(_0x1f4a62(0x31a))[_0x1f4a62(0x281)](),_0x259a36=new Date(_0x72d156);_0x72d156=_0x259a36['format'](_0x1f4a62(0x2d7));var _0x2fa696=$(_0x1f4a62(0x2c3))[_0x1f4a62(0x281)](),_0x259a36=new Date(_0x2fa696);_0x2fa696=_0x259a36['format']('dd/MM/yyyy'),EstimatedHours=$(_0x1f4a62(0x223))['val']();if(parseFloat(EstimatedHours)<0x0)return alert(_0x1f4a62(0x2df)),$(_0x1f4a62(0x223))['focus'](),![];var _0x17049e=getPeoplePickerEmails(_0x1f4a62(0x22f));for(var _0x78abbc=0x0;_0x78abbc<_0x17049e['length'];_0x78abbc++){if(CheckInternalUser(_0x17049e[_0x78abbc])==![])return alert(_0x1f4a62(0x33e)),![];}var _0x21ab4b=getPeopleUserInfoGroups('ProjectManagerEmployeePicker');if(_0x21ab4b[_0x1f4a62(0x23d)]==0x0)return alert(_0x1f4a62(0x339)),![];if(_0x21ab4b[_0x1f4a62(0x23d)]==0x1){var _0x5aee8f=IsMangerActive(_0x21ab4b);if(!_0x5aee8f)return alert(_0x1f4a62(0x252)),_0x5aee8f='',![];else var _0x5d811e=_0x21ab4b[0x0];}if(_0x21ab4b['length']>0x1)return alert('please\x20insert\x20only\x201\x20Manager'),![];NewPMNameID=_0x5d811e;var _0x43899b=$(_0x1f4a62(0x25a))[_0x1f4a62(0x281)](),_0x3a2947='';_0x72d156!=null&&_0x72d156!=''&&(_0x3a2947=GetDateStandardFormat(_0x72d156),StartDate=_0x3a2947);var _0xba44ad='';_0x2fa696!=null&&_0x2fa696!=''&&(_0xba44ad=GetDateStandardFormat(_0x2fa696),EndDate=_0xba44ad);if(_0x5735c9[_0x1f4a62(0x23a)]()==''||_0x72d156==''||_0x2fa696==''||$(_0x1f4a62(0x27f))['val']()=='0')alert(_0x1f4a62(0x2c1));else _0xba44ad>_0x3a2947?(waitingDialog[_0x1f4a62(0x2ad)](),updateListItem()):alert(_0x1f4a62(0x2ae));});}function CheckProjectCodeExistOrNot(_0x3f2f54,_0xd60832){var _0xa2f4a6=a0_0x4fde84,_0xf630a6=titanForWork[_0xa2f4a6(0x32e)](_0xa2f4a6(0x29e)),_0x5f1f85=_0xa2f4a6(0x2dd),_0x57854c={},_0x500ec6=![],_0xcf5186='';if(_0x3f2f54==_0xa2f4a6(0x240))_0xcf5186=_spPageContextInfo[_0xa2f4a6(0x20a)]+_0xa2f4a6(0x214)+_0xf630a6+'\x27\x20and\x20ProjectName\x20eq\x20\x27'+_0xd60832+_0xa2f4a6(0x298)+projectItemID+'\x27';else _0x3f2f54==_0xa2f4a6(0x2b1)&&(_0xcf5186=_spPageContextInfo[_0xa2f4a6(0x20a)]+_0xa2f4a6(0x31d)+_0xd60832+_0xa2f4a6(0x236)+_0xf630a6+'\x27');return $[_0xa2f4a6(0x323)]({'url':_0xcf5186,'type':_0x5f1f85,'data':_0x57854c,'async':![],'headers':{'Accept':_0xa2f4a6(0x1f7),'Content-Type':_0xa2f4a6(0x1f7),'X-RequestDigest':$(_0xa2f4a6(0x2f6))[_0xa2f4a6(0x281)](),'IF-MATCH':'*','X-HTTP-Method':null},'cache':![],'success':function(_0x3ca638){var _0x471501=_0xa2f4a6,_0x1082ce,_0x273c44=_0x3ca638['d']['results'],_0x11c957=_0x3ca638['d'][_0x471501(0x251)][_0x471501(0x23d)];_0x11c957>0x0&&(alert(_0x471501(0x24f)),$('#txtProjectName')[_0x471501(0x281)](''),$(_0x471501(0x2d9))[_0x471501(0x224)]());},'error':function(_0x378add){var _0x35a542=_0xa2f4a6;Helper[_0x35a542(0x2fb)]();}}),_0x500ec6;}function updateListItem(){var _0x4ab6df=a0_0x4fde84,_0x4f25d2=new Array();_0x4f25d2=getPeopleUserInfoGroups('StackeholderTeamEmployeePicker');var _0x43e2dd=new Array();_0x43e2dd=getPeopleUserInfoGroups(_0x4ab6df(0x2cd));var _0x40799b=titanForWork[_0x4ab6df(0x32e)](_0x4ab6df(0x30e)),_0x4ac64e=$(_0x4ab6df(0x275))[_0x4ab6df(0x281)](),_0x40de5b=$('#txtProjectName')['val'](),_0x394f62=$(_0x4ab6df(0x31a))['val'](),_0x414ae1=new Date(_0x394f62);_0x394f62=_0x414ae1[_0x4ab6df(0x31e)](_0x4ab6df(0x2d7));var _0x172386='';_0x394f62!=null&&_0x394f62!=''&&(_0x172386=GetDateStandardFormat(_0x394f62));var _0x1e8357=$(_0x4ab6df(0x2c3))[_0x4ab6df(0x281)](),_0x414ae1=new Date(_0x1e8357);_0x1e8357=_0x414ae1['format'](_0x4ab6df(0x2d7));var _0x199520='';_0x1e8357!=null&&_0x1e8357!=''&&(_0x199520=GetDateStandardFormat(_0x1e8357));var _0x448819=$('.txtActualStartDate')[_0x4ab6df(0x281)](),_0x3d6132='';if(_0x448819!=null&&_0x448819!=''){var _0x414ae1=new Date(_0x448819);_0x448819=_0x414ae1[_0x4ab6df(0x31e)](_0x4ab6df(0x2d7)),_0x3d6132=GetDateStandardFormat(_0x448819);}else _0x3d6132=null;txtProjectStatus=$(_0x4ab6df(0x1f5))[_0x4ab6df(0x281)]();if(txtProjectStatus=='Terminated'||txtProjectStatus==_0x4ab6df(0x330)){var _0x56bd62='',_0x15d92c=$(_0x4ab6df(0x265))[_0x4ab6df(0x281)]();if(_0x15d92c!=null&&_0x15d92c!=''){var _0x414ae1=new Date(_0x15d92c);_0x15d92c=_0x414ae1[_0x4ab6df(0x31e)](_0x4ab6df(0x2d7)),_0x56bd62=GetDateStandardFormat(_0x15d92c);}}else var _0x56bd62=null;txtDepartmentID=$(_0x4ab6df(0x2e3))[_0x4ab6df(0x24c)](_0x4ab6df(0x27f))[_0x4ab6df(0x281)](),DepartmentFullName=$(_0x4ab6df(0x2e3))[_0x4ab6df(0x24c)](_0x4ab6df(0x311))[_0x4ab6df(0x31b)](),txtofficeLocationID=$(_0x4ab6df(0x213))[_0x4ab6df(0x24c)]('#officeLocationDetails')[_0x4ab6df(0x281)](),OfficeFullName=$('#officeLocation')[_0x4ab6df(0x24c)](_0x4ab6df(0x22c))[_0x4ab6df(0x31b)]();var _0x541d38=getPeopleUserInfoGroups(_0x4ab6df(0x247));if(_0x541d38[_0x4ab6df(0x23d)]==0x0)return alert(_0x4ab6df(0x339)),![];_0x541d38['length']==0x1&&(txtManagerTeam=_0x541d38[0x0]);txtStackeholderTeam=$(_0x4ab6df(0x206))[_0x4ab6df(0x24c)]('#TaskTeamDetails')[_0x4ab6df(0x281)](),txtSponsorTeam=$(_0x4ab6df(0x2e2))[_0x4ab6df(0x24c)](_0x4ab6df(0x233))['val'](),txtDomain=$(_0x4ab6df(0x200))[_0x4ab6df(0x281)]();var _0x3ecc58=$(_0x4ab6df(0x245))[_0x4ab6df(0x281)](),_0x54fe32=$(_0x4ab6df(0x25a))[_0x4ab6df(0x281)](),_0x337734=getConsultantValue();if(txtProjectStatus==_0x4ab6df(0x2d4)||txtProjectStatus=='Completed'){if($[_0x4ab6df(0x23a)](_0x3d6132)==''||_0x3d6132==null)alert(_0x4ab6df(0x296)),waitingDialog['hide']();else{if($['trim'](_0x56bd62)==''||_0x56bd62==null)alert(_0x4ab6df(0x23e)),waitingDialog['hide']();else txtProjectStatus==_0x4ab6df(0x2d4)&&$[_0x4ab6df(0x23a)](_0x3d6132)!=''&&$[_0x4ab6df(0x23a)](_0x56bd62)!=''&&_0x56bd62<_0x3d6132?(alert(_0x4ab6df(0x346)),waitingDialog[_0x4ab6df(0x22b)]()):AddNewTak(_0x4ab6df(0x218),_0x40799b,_0x4ac64e,_0x40de5b,_0x172386,_0x199520,_0x3d6132,_0x56bd62,txtDepartmentID,DepartmentFullName,txtofficeLocationID,OfficeFullName,txtManagerTeam,txtStackeholderTeam,txtSponsorTeam,txtProjectStatus,_0x3ecc58,_0x54fe32,txtDomain,_0x337734,_0x4f25d2,_0x43e2dd);}}else AddNewTak(_0x4ab6df(0x218),_0x40799b,_0x4ac64e,_0x40de5b,_0x172386,_0x199520,_0x3d6132,_0x56bd62,txtDepartmentID,DepartmentFullName,txtofficeLocationID,OfficeFullName,txtManagerTeam,txtStackeholderTeam,txtSponsorTeam,txtProjectStatus,_0x3ecc58,_0x54fe32,txtDomain,_0x337734,_0x4f25d2,_0x43e2dd);AddProjectManagerAsADefaultMemeber(txtManagerTeam,_0x172386,_0x199520,_0x40de5b,_0x40799b);}function RelesedProjectManager(_0x3095ee){var _0x308917=a0_0x4fde84,_0xb7ed81,_0x5d4ead=new Date(),_0xe10f53=Logged_CompanyId;siteURL=_spPageContextInfo[_0x308917(0x20a)]+_0x308917(0x2b4)+_0x3095ee+_0x308917(0x24b),$[_0x308917(0x323)]({'url':siteURL,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0xc58ce4){var _0x525500=_0x308917,_0x424186=_0xc58ce4['d'][_0x525500(0x251)];if(_0x424186[_0x525500(0x23d)]>0x0){_0xb7ed81=_0x424186[0x0]['ID'];var _0x5ca064=_0x424186[0x0]['TeamMemberId'];$[_0x525500(0x323)]({'url':_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/GetByTitle(\x27ProjectTeamDetails\x27)/items(\x27'+_0xb7ed81+'\x27)','type':_0x525500(0x230),'async':![],'data':JSON[_0x525500(0x266)]({'__metadata':{'type':_0x525500(0x2b9)},'TeamPermission':![],'DocumentPermission':![],'TaskPermission':![],'Status':_0x525500(0x2ef),'ReleseDate':_0x5d4ead}),'headers':{'Accept':'application/json;odata=verbose','Content-Type':_0x525500(0x1f7),'X-RequestDigest':$(_0x525500(0x2f6))[_0x525500(0x281)](),'IF-MATCH':'*','X-HTTP-Method':_0x525500(0x344)},'success':function(_0x49c689){var _0x14d3bc=_0x525500;console[_0x14d3bc(0x27e)](_0x14d3bc(0x2c7)),(CreatedId==_spPageContextInfo[_0x14d3bc(0x325)]||_spPageContextInfo[_0x14d3bc(0x21b)]==!![])&&(NewPMNameID!=OldPMNameID&&_0x5ca064!=_spPageContextInfo[_0x14d3bc(0x325)]&&BreakInheritePermissionDMSLibrary(_0x5ca064,_0x14d3bc(0x209),_0x14d3bc(0x1f1)));},'error':function(_0x4f9cea){var _0x3fdbf0=_0x525500;console[_0x3fdbf0(0x27e)](_0x3fdbf0(0x324)),console['log'](_0x4f9cea);}});}},'error':function(_0x1efad5){var _0x4b7b0b=_0x308917;console[_0x4b7b0b(0x27e)]('GetProjectManager'),console[_0x4b7b0b(0x27e)](_0x1efad5);}});}function GetProjectManager(_0x3672a0){var _0x258205=a0_0x4fde84,_0x11fdb2,_0x4bce68=new Date(),_0x1399eb=Logged_CompanyId;siteURL=_spPageContextInfo['webAbsoluteUrl']+_0x258205(0x2b4)+_0x3672a0+'\x27\x20and\x20Role\x20eq\x20\x27Project\x20Manager\x27\x20and\x20Status\x20eq\x20\x27Active\x27&$OrderBy\x20ID\x20desc',$[_0x258205(0x323)]({'url':siteURL,'headers':{'Accept':_0x258205(0x1f7)},'async':![],'success':function(_0x4ae8dd){var _0xbb1368=_0x258205,_0x563a35=_0x4ae8dd['d'][_0xbb1368(0x251)];if(_0x563a35['length']>0x0){_0x11fdb2=_0x563a35[0x0]['ID'];var _0x20a43e=_0x563a35[0x0][_0xbb1368(0x1f3)];$['ajax']({'url':_spPageContextInfo[_0xbb1368(0x20a)]+_0xbb1368(0x335)+_0x11fdb2+'\x27)','type':_0xbb1368(0x230),'async':![],'data':JSON['stringify']({'__metadata':{'type':_0xbb1368(0x2b9)},'TeamPermission':![],'DocumentPermission':![],'TaskPermission':![],'Status':_0xbb1368(0x2ef),'ReleseDate':_0x4bce68}),'headers':{'Accept':'application/json;odata=verbose','Content-Type':'application/json;odata=verbose','X-RequestDigest':$(_0xbb1368(0x2f6))[_0xbb1368(0x281)](),'IF-MATCH':'*','X-HTTP-Method':_0xbb1368(0x344)},'success':function(_0x5354cb){var _0x3f127f=_0xbb1368;(CreatedId==_spPageContextInfo[_0x3f127f(0x325)]||_spPageContextInfo[_0x3f127f(0x21b)]==!![])&&(NewPMNameID!=OldPMNameID&&_0x20a43e!=_spPageContextInfo[_0x3f127f(0x325)]&&BreakInheritePermissionDMSLibrary(_0x20a43e,_0x3f127f(0x209),_0x3f127f(0x1f1)));console[_0x3f127f(0x27e)](_0x3f127f(0x2c7));var _0x13902f='ProjectTeamDetails',_0x3ba090=_0x3f127f(0x22e),_0x629485={'__metadata':{'type':_0x3f127f(0x2bb)+_0x13902f+_0x3f127f(0x30b)},'TeamMemberId':txtManagerTeam,'Role':_0x3ba090,'EngageDate':StartDate,'ExpectedReleseDate':EndDate,'TeamPermission':!![],'DocumentPermission':!![],'TaskPermission':!![],'CompanyId':Logged_CompanyId,'ProjectId':titanForWork['getQueryStringParameter'](_0x3f127f(0x30e))};UniversalinsertProject(_0x13902f,_0x629485),(CreatedId==_spPageContextInfo[_0x3f127f(0x325)]||_spPageContextInfo[_0x3f127f(0x21b)]==!![])&&(NewPMNameID!=OldPMNameID&&BreakInheritePermissionDMSLibrary(txtManagerTeam,_0x3f127f(0x250),_0x3f127f(0x232)));},'error':function(_0x3a3538){var _0x3a4188=_0xbb1368;console['log'](_0x3a4188(0x324)),console[_0x3a4188(0x27e)](_0x3a3538);}});}},'error':function(_0x2ed357){var _0x12686e=_0x258205;console[_0x12686e(0x27e)](_0x12686e(0x34a)),console[_0x12686e(0x27e)](_0x2ed357);}});}function GetProjectTeamMemberID(_0x4bda5d){var _0x391c28=a0_0x4fde84,_0x5323a1=_0x4bda5d,_0x494a00,_0x440f11=Logged_CompanyId,_0x28b5b7=$(_0x391c28(0x2d9))[_0x391c28(0x281)]();return siteURL=_spPageContextInfo[_0x391c28(0x20a)]+_0x391c28(0x264)+_0x4bda5d+_0x391c28(0x2a0),$[_0x391c28(0x323)]({'url':siteURL,'headers':{'Accept':_0x391c28(0x1f7)},'async':![],'success':function(_0x41ac44){var _0x1597fe=_0x391c28,_0x240e2b=_0x41ac44['d'][_0x1597fe(0x251)];if(_0x240e2b['length']>0x0){var _0x5d2db1=0x0;for(var _0x11ba5d=0x0;_0x11ba5d<_0x240e2b[_0x1597fe(0x23d)];_0x11ba5d++){var _0x46b560=_0x240e2b[_0x11ba5d][_0x1597fe(0x1f3)];if(NewPMNameID==_0x46b560[_0x1597fe(0x2e7)]()){_0x494a00=_0x240e2b[_0x11ba5d]['ID'],RelesedProjectManager(_0x5323a1);break;}else _0x5d2db1=_0x5d2db1+0x1;}_0x5d2db1==_0x240e2b['length']&&GetProjectManager(_0x5323a1);}else{var _0xeb9523=_0x1597fe(0x336),_0x56952f=_0x1597fe(0x22e),_0x3b6731={'__metadata':{'type':_0x1597fe(0x2bb)+_0xeb9523+_0x1597fe(0x30b)},'TeamMemberId':txtManagerTeam,'Role':_0x56952f,'EngageDate':StartDate,'ExpectedReleseDate':EndDate,'TeamPermission':!![],'DocumentPermission':!![],'TaskPermission':!![],'CompanyId':Logged_CompanyId,'ProjectId':titanForWork['getQueryStringParameter'](_0x1597fe(0x30e))};UniversalinsertProject(_0xeb9523,_0x3b6731);}},'error':function(_0x3a28a3){var _0x1ebcb4=_0x391c28;console[_0x1ebcb4(0x27e)](_0x3a28a3);}}),_0x494a00;}function AddProjectManagerAsADefaultMemeber(_0x23510d,_0x3e5d4a,_0x2ceb89,_0x19b454,_0x1adcfb){var _0x38e818=a0_0x4fde84,_0xfb9b1b=GetProjectTeamMemberID(_0x1adcfb);if(_0xfb9b1b!=undefined){var _0x1fe2c6=$[_0x38e818(0x2cf)](),_0x5830c2=_0x38e818(0x336),_0x562c64=CreateMetadataForAddingProjectManager(_0x5830c2,_0x23510d,_0x3e5d4a,_0x2ceb89,_0x19b454),_0x1ce79a=_spPageContextInfo['webAbsoluteUrl']+_0x38e818(0x29d)+_0x5830c2+'\x27)/items('+_0xfb9b1b+')',_0x299803={'Accept':'application/json;odata=verbose','Content-Type':'application/json;odata=verbose','X-RequestDigest':$(_0x38e818(0x2f6))[_0x38e818(0x281)](),'IF-MATCH':'*','X-HTTP-Method':_0x38e818(0x344)};return $[_0x38e818(0x323)]({'url':_0x1ce79a,'type':_0x38e818(0x230),'async':![],'headers':_0x299803,'data':JSON[_0x38e818(0x266)](_0x562c64),'success':function(_0x54a377){var _0x2acb09=_0x38e818;console[_0x2acb09(0x27e)](_0x2acb09(0x201)),(CreatedId==_spPageContextInfo[_0x2acb09(0x325)]||_spPageContextInfo[_0x2acb09(0x21b)]==!![])&&(NewPMNameID!=OldPMNameID&&BreakInheritePermissionDMSLibrary(_0x23510d,_0x2acb09(0x250),'Add'));},'error':function(_0x4d7e11){var _0x7eacaa=_0x38e818;console[_0x7eacaa(0x27e)](data),_0x1fe2c6['reject'](_0x4d7e11);}}),_0x1fe2c6['promise']();}}function CreateMetadataForAddingProjectManager(_0x32a89a,_0x973407,_0x3087ab,_0x514046,_0x444c53){var _0x21b4eb=a0_0x4fde84,_0x28b910=GetItemTypeForListName(_0x32a89a),_0x3ea7ad;return _0x3ea7ad={'__metadata':{'type':_0x28b910}},_0x3ea7ad[_0x21b4eb(0x1f3)]=_0x973407,_0x3ea7ad['Role']=_0x21b4eb(0x22e),_0x3ea7ad['EngageDate']=_0x3087ab,_0x3ea7ad[_0x21b4eb(0x203)]=_0x21b4eb(0x228),_0x3ea7ad[_0x21b4eb(0x342)]=_0x514046,_0x3ea7ad[_0x21b4eb(0x2ee)]=!![],_0x3ea7ad[_0x21b4eb(0x26e)]=!![],_0x3ea7ad[_0x21b4eb(0x34d)]=!![],_0x3ea7ad[_0x21b4eb(0x29e)]=Logged_CompanyId,_0x3ea7ad;}function LoadAllHolidays(){var _0x33354e=a0_0x4fde84,_0x40cbf4=0x0,_0x2f033f=$('.txtPlannedStartDate')[_0x33354e(0x281)](),_0x1cba85=new Date(_0x2f033f);_0x2f033f=_0x1cba85[_0x33354e(0x31e)]('dd/MM/yyyy');var _0x49f163=new Date(ConvertDateTimeFormat(_0x2f033f,'/')),_0x38cc33=_0x49f163[_0x33354e(0x300)]()+'-'+(_0x49f163[_0x33354e(0x274)]()+0x1)+'-'+_0x49f163['getDate'](),_0xfb45b6=$(_0x33354e(0x2c3))[_0x33354e(0x281)](),_0x1cba85=new Date(_0xfb45b6);_0xfb45b6=_0x1cba85[_0x33354e(0x31e)]('dd/MM/yyyy');var _0x58d9f3=new Date(ConvertDateTimeFormat(_0xfb45b6,'/')),_0x252590=_0x58d9f3['getFullYear']()+'-'+(_0x58d9f3[_0x33354e(0x274)]()+0x1)+'-'+_0x58d9f3['getDate'](),_0xd5b21=_spPageContextInfo[_0x33354e(0x20a)]+_0x33354e(0x2f3)+Logged_Location+_0x33354e(0x321)+Logged_CompanyId+_0x33354e(0x33d)+_0x38cc33+_0x33354e(0x34c)+_0x252590+'\x27';return $[_0x33354e(0x323)]({'url':_0xd5b21,'headers':{'Accept':_0x33354e(0x1f7)},'async':![],'success':function(_0x451508){var _0xa81a97=_0x33354e;_0x40cbf4=_0x451508['d'][_0xa81a97(0x251)][_0xa81a97(0x23d)];},'myError':function(_0x4fa050){console['log'](_0x4fa050);}}),_0x40cbf4;}function ConvertDateTimeFormat(_0xf32af4,_0x39d8b3){var _0x2223d5=a0_0x4fde84;return _0xf32af4[_0x2223d5(0x243)](_0x39d8b3)[0x1]+''+_0x39d8b3+''+_0xf32af4[_0x2223d5(0x243)](_0x39d8b3)[0x0]+''+_0x39d8b3+''+_0xf32af4[_0x2223d5(0x243)](_0x39d8b3)[0x2];}function AddNewTak(_0x34ab51,_0x5ac7bd,_0x4be0c7,_0x2540d4,_0x2287b6,_0x44bbc1,_0x5b6f7a,_0x2102b9,_0xcb3036,_0x50a88f,_0x7ae7cd,_0x1a79b3,_0x139b2a,_0x3434ca,_0x34ff52,_0x37b43a,_0xc0ef04,_0x12cdc8,_0x9e5cd4,_0x46f1cc,_0x1780c0,_0xffb4fd){var _0x57e171=a0_0x4fde84;try{$(_0x57e171(0x223))[_0x57e171(0x281)]()==''&&$(_0x57e171(0x223))[_0x57e171(0x281)]('0');var _0x183ba4,_0x466135=GetItemTypeForListName(_0x34ab51);_0x183ba4={'__metadata':{'type':_0x466135},'Title':_0x2540d4,'ProjectCode':_0x4be0c7,'ProjectName':_0x2540d4,'ProjectDescription':_0x12cdc8,'DepartmentId':_0xcb3036,'Department_IDId':_0xcb3036,'ActualStartDate':_0x5b6f7a,'ActualEndDate':_0x2102b9,'PlanedStartDate':_0x2287b6,'PlanedEndDate':_0x44bbc1,'TechnologyUsed':_0xc0ef04,'Status':_0x37b43a,'DepartmentName':_0x50a88f,'ConsultantName':_0x46f1cc,'ManagerNameId':_0x139b2a,'StackeholderId':null,'SponsorId':null,'OfficeLocation':_0x1a79b3,'Domain':_0x9e5cd4,'OfficeLocationID':_0x7ae7cd,'Office_Location_IdId':_0x7ae7cd,'MultipleStackeholderId':{'results':_0x1780c0},'MultipleSponsorId':{'results':_0xffb4fd},'ProjectInternalName':projectInternalName,'EstimatedWorkHours':$(_0x57e171(0x223))[_0x57e171(0x281)](),'ProgramIDId':$(_0x57e171(0x1fc))[_0x57e171(0x281)]()},(_0x5b6f7a==null||_0x5b6f7a=='')&&delete _0x183ba4[_0x57e171(0x331)],_0x37b43a!=_0x57e171(0x29b)&&_0x37b43a!=_0x57e171(0x295)&&((_0x2102b9==null||_0x2102b9=='')&&delete _0x183ba4[_0x57e171(0x238)]),(_0x44bbc1==null||_0x44bbc1=='')&&delete _0x183ba4[_0x57e171(0x2b7)],(_0x2287b6==null||_0x2287b6=='')&&delete _0x183ba4[_0x57e171(0x28d)],AddItemToList(_0x34ab51,_0x183ba4,_0x5ac7bd);}catch(_0x4712d5){console[_0x57e171(0x27e)](_0x4712d5[_0x57e171(0x287)]);}}function AddItemToList(_0x54558f,_0x30859b,_0x199ea9){var _0x4aee14=a0_0x4fde84,_0x45663c=$[_0x4aee14(0x2cf)]();return $[_0x4aee14(0x323)]({'url':_spPageContextInfo[_0x4aee14(0x20a)]+'/_api/web/lists/getbytitle(\x27'+_0x54558f+_0x4aee14(0x279)+_0x199ea9+'\x27)','type':_0x4aee14(0x230),'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x4aee14(0x2f6))['val'](),'content-Type':_0x4aee14(0x1f7),'X-Http-Method':_0x4aee14(0x28e),'If-Match':'*'},'data':JSON[_0x4aee14(0x266)](_0x30859b),'async':![],'success':function(_0xe6e488){var _0x355763=_0x4aee14;_0x45663c[_0x355763(0x215)](!![]);IsProjectAdmin==!![]&&UpdateProjectSiteTitle();alert(_0x355763(0x2db)),waitingDialog[_0x355763(0x22b)]();var _0x475837=Logged_CompanyId,_0x3194e6=_spPageContextInfo[_0x355763(0x28c)];if(window[_0x355763(0x345)]($[_0x355763(0x2a8)]('IsModal'))!='true'){var _0x116412='';_0x116412=_spPageContextInfo[_0x355763(0x20a)]+_0x355763(0x337)+Logged_CompanyId+_0x355763(0x254)+projectItemID+_0x355763(0x23c)+$[_0x355763(0x23a)]($(_0x355763(0x2d9))[_0x355763(0x281)]()),location[_0x355763(0x219)]=_0x116412;}else location[_0x355763(0x219)]=$[_0x355763(0x2a8)](_0x355763(0x2c6))+_0x355763(0x23c)+$('#txtProjectName')[_0x355763(0x281)]();},'error':function(_0x2358fc){var _0x365538=_0x4aee14;console[_0x365538(0x27e)](JSON[_0x365538(0x266)](_0x2358fc)),_0x45663c['reject'](_0x2358fc);}}),_0x45663c['promise']();}function GetItemTypeForListName(_0x154703){var _0x18aef5=a0_0x4fde84;return _0x18aef5(0x2bb)+_0x154703[_0x18aef5(0x278)](0x0)[_0x18aef5(0x2a9)]()+_0x154703[_0x18aef5(0x243)]('\x20')[_0x18aef5(0x23f)]('')[_0x18aef5(0x202)](0x1)+_0x18aef5(0x30b);}function UpdateProjectSiteTitle(){var _0x306fe8=a0_0x4fde84,_0x589717=$(_0x306fe8(0x2d9))['val'](),_0x33d29f=JSON[_0x306fe8(0x266)]({'__metadata':{'type':_0x306fe8(0x2aa)},'Description':_0x306fe8(0x2f4),'Title':_0x589717}),_0xa9083=titanForWork[_0x306fe8(0x32e)](_0x306fe8(0x301))+_0x306fe8(0x2a4)+projectInternalName+_0x306fe8(0x2b6);$['ajax']({'url':_0xa9083,'type':_0x306fe8(0x230),'async':![],'data':_0x33d29f,'headers':{'accept':'application/json;odata=verbose','content-type':_0x306fe8(0x1f7),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x306fe8(0x281)](),'X-HTTP-Method':_0x306fe8(0x344)},'success':function(_0x1305b4){var _0x5d394a=_0x306fe8;console[_0x5d394a(0x27e)]('site\x20updated');},'error':function(_0x51ff52){console['log']('Error\x20updating\x20site');}});}function GetDateStandardFormat(_0x274c44){var _0x55f9ef=a0_0x4fde84,_0x2ec9a8=ConvertDateFormatToddMMyyyy(_0x274c44),_0x33d8ed=new Date(_0x2ec9a8),_0x1bd5cc=0x3c*0x3c*0x18*0x3e8,_0x325385=new Date(_0x33d8ed[_0x55f9ef(0x33f)]()),_0x24bef3=_0x325385[_0x55f9ef(0x20d)]();return _0x24bef3;}function ConvertDateFormatToddMMyyyy(_0x39c740){var _0x2817ee=a0_0x4fde84,_0x35a285=stringToDate(_0x39c740,_0x2817ee(0x2d7),'/');return _0x35a285;}function stringToDate(_0x4c1e86,_0x3236bd,_0x3f35be){var _0x5bc1c4=a0_0x4fde84,_0x1e24f6=_0x3236bd['toLowerCase'](),_0x39ae1a=_0x1e24f6['split'](_0x3f35be),_0x518979=_0x4c1e86['split'](_0x3f35be),_0xc2c981=_0x39ae1a[_0x5bc1c4(0x2bd)]('mm'),_0x4dd14c=_0x39ae1a['indexOf']('dd'),_0x3c536d=_0x39ae1a[_0x5bc1c4(0x2bd)](_0x5bc1c4(0x2b0)),_0x4325c2=parseInt(_0x518979[_0xc2c981]);_0x4325c2-=0x1;var _0x12a4d7=new Date(_0x518979[_0x3c536d],_0x4325c2,_0x518979[_0x4dd14c]);return _0x12a4d7;}$(document)['ready'](function(){var _0x4f3d0d=a0_0x4fde84;$('#ProjectStatus')[_0x4f3d0d(0x226)](function(){var _0x17d1ad=_0x4f3d0d,_0x2ba83e=$(_0x17d1ad(0x1f5))[_0x17d1ad(0x281)]();if(_0x2ba83e==_0x17d1ad(0x29b)||_0x2ba83e==_0x17d1ad(0x295))$(_0x17d1ad(0x1f0))[_0x17d1ad(0x22b)](),$(_0x17d1ad(0x329))[_0x17d1ad(0x281)](''),$('.ActualEndDate')['hide']();else(_0x2ba83e==_0x17d1ad(0x330)||_0x2ba83e==_0x17d1ad(0x2d4))&&($(_0x17d1ad(0x1f0))[_0x17d1ad(0x2ad)](),$(_0x17d1ad(0x326))[_0x17d1ad(0x2ad)]());}),$(_0x4f3d0d(0x326))[_0x4f3d0d(0x22b)](),$(_0x4f3d0d(0x2a5))[_0x4f3d0d(0x2f8)](function(){var _0x3021a9=_0x4f3d0d;window['atob']($[_0x3021a9(0x2a8)](_0x3021a9(0x25b)))!=_0x3021a9(0x2d1)?location[_0x3021a9(0x219)]=document['referrer']:location['href']=$[_0x3021a9(0x2a8)]('sourceLocation')+_0x3021a9(0x288)+$('#txtProjectName')[_0x3021a9(0x281)]();}),$(_0x4f3d0d(0x31a))[_0x4f3d0d(0x2c2)](_0x4f3d0d(0x30a),!![]);});function GetProjectDetailsformail(){var _0x261c59=a0_0x4fde84,_0x4a628a=titanForWork[_0x261c59(0x32e)](_0x261c59(0x30e));projectManage=[],StakeHolders=[],ProjectSponsors=[],stackToUsers='',sponsorToUsers='',projectItemDetails=[];var _0x56eed8=_spPageContextInfo[_0x261c59(0x20a)]+'/_api/lists/getbytitle(\x27ProjectDetails\x27)/items?$select=*,ManagerName/Title,ManagerName/UserName,MultipleStackeholder/Title,MultipleStackeholder/UserName,MultipleSponsor/Title,MultipleSponsor/UserName,ClientID/Title&$Expand=ManagerName,ClientID,MultipleStackeholder,MultipleSponsor&$Filter=ID\x20eq\x20\x27'+_0x4a628a+'\x27';$[_0x261c59(0x323)]({'url':_0x56eed8,'method':'GET','headers':{'Accept':_0x261c59(0x270)},'async':![],'success':function(_0x5251d9){var _0x4145ce=_0x261c59,_0x5d8868=_0x5251d9,_0x63c1d8='';for(var _0x44b8e6=0x0;_0x44b8e6<_0x5d8868['d'][_0x4145ce(0x251)]['length'];_0x44b8e6++){_0x5d8868['d'][_0x4145ce(0x251)][_0x44b8e6][_0x4145ce(0x277)]!=null&&(projectManage[_0x4145ce(0x2e5)](_0x5d8868['d'][_0x4145ce(0x251)][_0x44b8e6][_0x4145ce(0x277)]['UserName']),projecttouser+=_0x5d8868['d']['results'][_0x44b8e6]['ManagerName']['Title']+',',projecttouser=projecttouser[_0x4145ce(0x34b)](/,(\s+)?$/,''));if(_0x5d8868['d'][_0x4145ce(0x251)][_0x44b8e6][_0x4145ce(0x33c)][_0x4145ce(0x251)]!=null){for(var _0x39eb36=0x0;_0x39eb36<_0x5d8868['d'][_0x4145ce(0x251)][_0x44b8e6][_0x4145ce(0x33c)][_0x4145ce(0x251)]['length'];_0x39eb36++){StakeHolders[_0x4145ce(0x2e5)](_0x5d8868['d']['results'][_0x44b8e6]['MultipleStackeholder'][_0x4145ce(0x251)][_0x39eb36]['UserName']),stackToUsers+=_0x5d8868['d']['results'][_0x44b8e6]['MultipleStackeholder'][_0x4145ce(0x251)][_0x39eb36][_0x4145ce(0x2b5)]+',';}stackToUsers=stackToUsers[_0x4145ce(0x34b)](/,(\s+)?$/,'');}if(_0x5d8868['d'][_0x4145ce(0x251)][_0x44b8e6][_0x4145ce(0x1fd)][_0x4145ce(0x251)]!=null){for(var _0x39eb36=0x0;_0x39eb36<_0x5d8868['d']['results'][_0x44b8e6][_0x4145ce(0x1fd)][_0x4145ce(0x251)]['length'];_0x39eb36++){ProjectSponsors[_0x4145ce(0x2e5)](_0x5d8868['d'][_0x4145ce(0x251)][_0x44b8e6][_0x4145ce(0x1fd)]['results'][_0x39eb36][_0x4145ce(0x253)]),sponsorToUsers+=_0x5d8868['d'][_0x4145ce(0x251)][_0x44b8e6][_0x4145ce(0x1fd)][_0x4145ce(0x251)][_0x39eb36]['Title']+',';}sponsorToUsers=sponsorToUsers[_0x4145ce(0x34b)](/,(\s+)?$/,'');}alluser=StakeHolders['concat'](ProjectSponsors,projectManage),projectItemDetails[_0x4145ce(0x2e5)](TaskMetadata(_0x5d8868['d']['results'][_0x44b8e6],projecttouser,stackToUsers,sponsorToUsers));}},'error':function(_0x3d7666){var _0x3e4c0b=_0x261c59;console['log'](JSON[_0x3e4c0b(0x266)](_0x3d7666));}});}function GetTaskEmailTemplate(_0x1cdbf2){var _0x3ce93=a0_0x4fde84,_0x19910d=_spPageContextInfo['siteAbsoluteUrl']+'/_api/web/Lists/GetByTitle(\x27EmailTemplate\x27)/Items?$select=ID,Body,Subject,EmailType,Title&$filter=Title\x20eq\x20\x27'+_0x1cdbf2+'\x27';$[_0x3ce93(0x323)]({'url':_0x19910d,'headers':{'accept':_0x3ce93(0x1f7),'content-type':_0x3ce93(0x1f7),'X-RequestDigest':$(_0x3ce93(0x2f6))[_0x3ce93(0x281)]()},'async':![],'success':function(_0x43996f){var _0x42c31f=_0x3ce93,_0x121405=_0x43996f['d']['results'];for(var _0x69044=0x0;_0x69044<_0x121405[_0x42c31f(0x23d)];_0x69044++){_0x121405[_0x69044][_0x42c31f(0x2ba)]!=null&&(emailBodyContent=_0x121405[_0x69044]['Body']),_0x121405[_0x69044][_0x42c31f(0x28b)]!=null&&(taskEmailSubject=_0x121405[_0x69044][_0x42c31f(0x28b)]);}},'error':function(_0x59e6d7){var _0x108320=_0x3ce93;console[_0x108320(0x27e)](_0x108320(0x205));}});}function SendTaskEmail(){var _0x3ed105=a0_0x4fde84,_0x3a0463=emailBodyContent,_0x327e3c=taskEmailSubject;projectItemDetails[_0x3ed105(0x26b)](function(_0x2315e4){var _0x537d0e=_0x3ed105;_0x3a0463=_0x3a0463[_0x537d0e(0x34b)](_0x537d0e(0x2c4),_0x2315e4[_0x537d0e(0x208)]),_0x3a0463=_0x3a0463[_0x537d0e(0x34b)](_0x537d0e(0x276),_0x2315e4['ProjectCode']),_0x3a0463=_0x3a0463['replace']('{{ProjectName}}',_0x2315e4[_0x537d0e(0x26a)]),_0x3a0463=_0x3a0463[_0x537d0e(0x34b)]('{{ProjectClientName}}',_0x2315e4[_0x537d0e(0x305)]),_0x3a0463=_0x3a0463[_0x537d0e(0x34b)](_0x537d0e(0x2b8),_0x2315e4[_0x537d0e(0x203)]),_0x3a0463=_0x3a0463[_0x537d0e(0x34b)](_0x537d0e(0x2dc),_0x2315e4['ClientName']),_0x2315e4[_0x537d0e(0x235)]==_0x537d0e(0x2ec)?_0x3a0463=_0x3a0463[_0x537d0e(0x34b)](_0x537d0e(0x262),''):_0x3a0463=_0x3a0463[_0x537d0e(0x34b)](_0x537d0e(0x262),_0x2315e4[_0x537d0e(0x235)]),_0x2315e4['OfficeLocation']=='-Select-'?_0x3a0463=_0x3a0463[_0x537d0e(0x34b)](_0x537d0e(0x2f7),''):_0x3a0463=_0x3a0463[_0x537d0e(0x34b)](_0x537d0e(0x2f7),_0x2315e4['OfficeLocation']),_0x3a0463=_0x3a0463[_0x537d0e(0x34b)](_0x537d0e(0x33a),_0x2315e4[_0x537d0e(0x28d)]),_0x3a0463=_0x3a0463[_0x537d0e(0x34b)](_0x537d0e(0x2c8),_0x2315e4['PlanedEndDate']),_0x3a0463=_0x3a0463[_0x537d0e(0x34b)]('{{Projectlink}}',_spPageContextInfo[_0x537d0e(0x20a)]+_0x537d0e(0x337)+companyID+_0x537d0e(0x254)+_0x2315e4['ID']+_0x537d0e(0x23c)+_0x2315e4[_0x537d0e(0x26a)]+'');});var _0x48c6c4=_spPageContextInfo[_0x3ed105(0x289)],_0x1eafc8;_0x1eafc8={'properties':{'__metadata':{'type':_0x3ed105(0x220)},'From':_0x48c6c4,'To':{'results':alluser},'Body':_0x3a0463,'Subject':_0x327e3c}};var _0x132824=_spPageContextInfo[_0x3ed105(0x28c)]+_0x3ed105(0x261);$[_0x3ed105(0x323)]({'contentType':'application/json','url':_0x132824,'type':_0x3ed105(0x230),'data':JSON[_0x3ed105(0x266)](_0x1eafc8),'async':![],'headers':{'Accept':'application/json;odata=verbose','content-type':'application/json;odata=verbose','X-RequestDigest':$(_0x3ed105(0x2f6))[_0x3ed105(0x281)]()},'success':function(_0x1d6312){var _0x41e539=_0x3ed105;console[_0x41e539(0x27e)](_0x41e539(0x26f));},'error':function(_0x3ecbef){var _0x28d215=_0x3ed105;waitingDialog[_0x28d215(0x22b)](),console[_0x28d215(0x27e)]('SendEmailSharedNotification\x20\x20'+JSON[_0x28d215(0x266)](_0x3ecbef));}});}function TaskMetadata(_0x36cb38,_0xfd37cf,_0x44efc3,_0x494270){var _0x573011=a0_0x4fde84,_0x1cc299={};return _0x1cc299[_0x573011(0x26a)]=_0x36cb38['ProjectName']==null?'':_0x36cb38[_0x573011(0x26a)],_0x1cc299['ClientName']=_0x36cb38[_0x573011(0x21d)][_0x573011(0x2b5)]==null?'':_0x36cb38['ClientID'][_0x573011(0x2b5)],_0x1cc299[_0x573011(0x235)]=_0x36cb38[_0x573011(0x235)]==null?'':_0x36cb38[_0x573011(0x235)],_0x1cc299['Status']=_0x36cb38['Status']==null?'':_0x36cb38['Status'],_0x1cc299[_0x573011(0x24a)]=_0x36cb38[_0x573011(0x24a)]==null?'':_0x36cb38[_0x573011(0x24a)],_0x1cc299['OfficeLocation']=_0x36cb38[_0x573011(0x2b3)]==null?'':_0x36cb38[_0x573011(0x2b3)],_0x1cc299['ID']=_0x36cb38[_0x573011(0x2b3)]==null?'':_0x36cb38['ID'],_0x1cc299[_0x573011(0x307)]=_0x36cb38[_0x573011(0x307)],_0x1cc299[_0x573011(0x208)]=_0xfd37cf,_0x1cc299[_0x573011(0x1fb)]=_0x44efc3,_0x1cc299[_0x573011(0x280)]=_0x494270,_0x1cc299[_0x573011(0x28d)]=_0x36cb38[_0x573011(0x28d)],_0x1cc299['PlanedStartDate']=new Date(_0x1cc299['PlanedStartDate']),_0x1cc299[_0x573011(0x28d)]=$[_0x573011(0x246)][_0x573011(0x290)](_0x573011(0x255),_0x1cc299[_0x573011(0x28d)]),_0x1cc299['PlanedEndDate']=_0x36cb38['PlanedEndDate'],_0x1cc299[_0x573011(0x2b7)]=new Date(_0x1cc299[_0x573011(0x2b7)]),_0x1cc299[_0x573011(0x2b7)]=$[_0x573011(0x246)][_0x573011(0x290)]('dd-M-yy',_0x1cc299[_0x573011(0x2b7)]),_0x1cc299;}var IsProjectAdmin=![],IsDeptmentAdmin=![];function getProjectRights(){var _0x5c1a3d=a0_0x4fde84;debugger;var _0x1d1a4e,_0x9a1e8=_0x5c1a3d(0x32f),_0x4d4b02=titanForWork[_0x5c1a3d(0x32e)](_0x5c1a3d(0x29e)),_0x293f31=Logged_DepartmentId,_0x186267=_spPageContextInfo[_0x5c1a3d(0x20a)]+_0x5c1a3d(0x29d)+_0x9a1e8+_0x5c1a3d(0x28a)+_0x4d4b02+_0x5c1a3d(0x271)+_spPageContextInfo[_0x5c1a3d(0x325)]+_0x5c1a3d(0x294);$[_0x5c1a3d(0x323)]({'url':_0x186267,'headers':{'Accept':_0x5c1a3d(0x1f7)},'async':!![],'success':function(_0x2a21bf){var _0x109df8=_0x5c1a3d,_0x5165c5=_0x2a21bf['d'][_0x109df8(0x251)];if(_0x5165c5[_0x109df8(0x23d)]>0x0)for(var _0xd3ed3a=0x0;_0xd3ed3a<_0x5165c5['length'];_0xd3ed3a++){var _0x2649eb=_0x5165c5[_0xd3ed3a][_0x109df8(0x29a)],_0x36a02a=_0x5165c5[_0xd3ed3a][_0x109df8(0x2ed)]['ID'];if(_0x2649eb==_0x109df8(0x293))IsProjectAdmin=!![];else _0x2649eb==_0x109df8(0x28f)&&_0x293f31==_0x36a02a&&(IsDeptmentAdmin=!![]);}else IsProjectAdmin=![],IsDeptmentAdmmin=![];},'error':function(_0x46a5a6){var _0x4b8826=_0x5c1a3d;console[_0x4b8826(0x27e)]($(_0x4b8826(0x32a))[_0x4b8826(0x281)]());}});}function UniversalinsertProject(_0x3164a1,_0x199488){var _0x6a942f=a0_0x4fde84;$[_0x6a942f(0x323)]({'url':_spPageContextInfo[_0x6a942f(0x20a)]+'/_api/web/lists/GetByTitle(\x27'+_0x3164a1+_0x6a942f(0x216),'type':'POST','contentType':'application/json;odata=verbose','data':JSON['stringify'](_0x199488),'async':![],'headers':{'Accept':'application/json;odata=verbose','X-RequestDigest':$(_0x6a942f(0x2f6))[_0x6a942f(0x281)]()},'success':function(_0x4002d6){var _0x5a69ec=_0x6a942f;console[_0x5a69ec(0x27e)](_0x5a69ec(0x30f));},'error':function(_0x9b2d57){var _0x348cd0=_0x6a942f;console['log'](_0x348cd0(0x1ef));}});}function IsMangerActive(_0x55a90f){var _0x53ca22=a0_0x4fde84,_0x5a9ca9=titanForWork[_0x53ca22(0x32e)](_0x53ca22(0x29e)),_0x38a583='';return RestQuery='?$select=*,LogonName/EMail,LogonName/Id,LogonName/FirstName,LogonName/LastName,LogonName/EMail&$expand=LogonName\x20&$filter=\x20Status\x20eq\x20\x27Active\x27\x20and\x20Company/ID\x20eq\x20'+_0x5a9ca9+_0x53ca22(0x25e)+_0x55a90f+'',$['when'](CommonFunction[_0x53ca22(0x31f)](_0x53ca22(0x334),RestQuery))[_0x53ca22(0x25f)](function(_0x3fdddb){var _0x4018d9=_0x53ca22;try{_0x3fdddb[_0x4018d9(0x251)][_0x4018d9(0x23d)]>0x0?_0x38a583=_0x3fdddb[_0x4018d9(0x251)][0x0]['ID']:_0x38a583=![];}catch(_0xae0162){alert(_0xae0162);}}),_0x38a583;}function AddUserToOwnerGroup(_0x13f22c){var _0x4dc575=a0_0x4fde84;debugger;var _0x39d935={'__metadata':{'type':_0x4dc575(0x340)},'LoginName':_0x13f22c},_0x389c9d=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/sitegroups/getbyname(\x27Owners\x27)/users';$[_0x4dc575(0x323)]({'url':_0x389c9d,'type':_0x4dc575(0x230),'async':![],'headers':{'accept':_0x4dc575(0x1f7),'X-RequestDigest':$(_0x4dc575(0x2f6))[_0x4dc575(0x281)](),'content-Type':_0x4dc575(0x1f7)},'data':JSON[_0x4dc575(0x266)](_0x39d935),'success':function(_0x5e1dd1){debugger;},'error':function(_0x3921bd){}});}function BreakInheritePermissionDMSLibrary(_0x5db51d,_0x3fddd2,_0x548ef1){var _0x1625ef=a0_0x4fde84,_0x18e3c2=titanForWork[_0x1625ef(0x32e)](_0x1625ef(0x301))+_0x1625ef(0x2a4)+projectInternalName,_0x4e33c1={'Accept':_0x1625ef(0x1f7),'content-Type':'application/json;odata=verbose','X-RequestDigest':jQuery(_0x1625ef(0x2f6))[_0x1625ef(0x281)]()},_0x194588=_0x18e3c2+'/_api/web/lists/getByTitle(\x27Documents\x27)/breakroleinheritance(copyRoleAssignments=false,\x20clearSubscopes=true)';$[_0x1625ef(0x323)]({'url':_0x194588,'type':_0x1625ef(0x230),'headers':_0x4e33c1,'async':![],'dataType':_0x1625ef(0x1f8),'success':function(_0x55d952){var _0x23de0a=_0x1625ef;console[_0x23de0a(0x27e)]('Permission\x20has\x20been\x20breaked\x20successfully!'),_0x548ef1==_0x23de0a(0x232)?$['when'](AssignPermissiononDMSLibary(_0x5db51d,_0x3fddd2))[_0x23de0a(0x25f)](function(_0x1489c2){var _0x8eec24=_0x23de0a;console[_0x8eec24(0x27e)](_0x8eec24(0x312));}):$['when'](DeleteUserPermissionOnDMSLibrary(_0x5db51d))[_0x23de0a(0x25f)](function(_0x1af494){var _0x562c8b=_0x23de0a;console[_0x562c8b(0x27e)](_0x562c8b(0x210));});},'error':function(_0x13fae3){var _0x33990b=_0x1625ef;console['log'](JSON[_0x33990b(0x266)](_0x13fae3));}});}function AssignPermissiononDMSLibary(_0x55e9cb,_0x2f018b){var _0x83877e=a0_0x4fde84,_0x167b5e=titanForWork['getQueryStringParameter'](_0x83877e(0x301))+'/DMS/'+projectInternalName,_0x624b40={'Accept':_0x83877e(0x1f7),'content-Type':_0x83877e(0x1f7),'X-RequestDigest':jQuery('#__REQUESTDIGEST')[_0x83877e(0x281)]()},_0x319780=_0x167b5e+_0x83877e(0x303)+_0x55e9cb+',roleDefId='+_0x2f018b+')';$[_0x83877e(0x323)]({'url':_0x319780,'type':_0x83877e(0x230),'headers':_0x624b40,'dataType':_0x83877e(0x1f8),'async':![],'success':function(_0x121163){var _0x507092=_0x83877e;console['log'](_0x507092(0x304));},'error':function(_0x98aaca){var _0x2fe2df=_0x83877e;console['log'](JSON[_0x2fe2df(0x266)](_0x98aaca));}});}function DeleteUserPermissionOnDMSLibrary(_0x420753){var _0xbaa0b3=a0_0x4fde84,_0xf196ad=titanForWork[_0xbaa0b3(0x32e)]('CompanySiteUrl')+_0xbaa0b3(0x2a4)+projectInternalName,_0x4be8e2={'X-RequestDigest':$(_0xbaa0b3(0x2f6))[_0xbaa0b3(0x281)](),'X-HTTP-Method':'DELETE'},_0x16d14f=_0xf196ad+_0xbaa0b3(0x2c0)+_0x420753+')';$['ajax']({'url':_0x16d14f,'type':_0xbaa0b3(0x230),'headers':_0x4be8e2,'async':![],'success':function(_0x326899){var _0x26fc5c=_0xbaa0b3;console[_0x26fc5c(0x27e)](_0x420753+_0x26fc5c(0x2d6));},'error':function(_0x289f68){var _0x2b819f=_0xbaa0b3;console[_0x2b819f(0x27e)](JSON['stringify'](_0x289f68));}});}function bindProjectType(){var _0x312e8e=a0_0x4fde84;$(_0x312e8e(0x245))[_0x312e8e(0x225)]();var _0x3902ab=_spPageContextInfo['webAbsoluteUrl']+_0x312e8e(0x239);$[_0x312e8e(0x323)]({'url':_0x3902ab,'headers':{'Accept':_0x312e8e(0x1f7)},'async':!![],'success':function(_0x3e3264){var _0x5c5c1e=_0x312e8e;$('<option\x20value=\x220\x22>-Select-</option>')[_0x5c5c1e(0x2fd)](_0x5c5c1e(0x245));for(var _0x237d0e=0x0;_0x237d0e<_0x3e3264['d'][_0x5c5c1e(0x251)]['length'];_0x237d0e++){$(_0x5c5c1e(0x245))[_0x5c5c1e(0x21a)](_0x5c5c1e(0x2be)+_0x3e3264['d'][_0x5c5c1e(0x251)][_0x237d0e][_0x5c5c1e(0x234)]+'\x22>'+_0x3e3264['d'][_0x5c5c1e(0x251)][_0x237d0e]['CatogeryName']+_0x5c5c1e(0x23b));}},'myError':function(_0x47ae44){}});}function getPeoplePickerEmails(_0x3e255d){var _0x3c5374=a0_0x4fde84,_0x158867=[],_0x374df0=$(_0x3c5374(0x27a)+_0x3e255d+'\x27]'),_0x1f2fc7=SPClientPeoplePicker[_0x3c5374(0x30d)][_0x374df0[0x1]['id']],_0xbfba83=_0x1f2fc7[_0x3c5374(0x2cc)]();if(_0xbfba83[_0x3c5374(0x23d)]>0x0){var _0x58cafb=new Array();for(var _0x413bb4=0x0;_0x413bb4<_0xbfba83[_0x3c5374(0x23d)];_0x413bb4++){var _0x221859=_0xbfba83[_0x413bb4][_0x3c5374(0x306)],_0x55196a=_0xbfba83[_0x413bb4][_0x3c5374(0x2e1)];if(_0x55196a==_0x3c5374(0x20e)){var _0x220211=_0xbfba83[_0x413bb4][_0x3c5374(0x306)][_0x3c5374(0x243)]('|')[0x2];_0x220211[_0x3c5374(0x22a)]('#')==!![]&&(_0x220211=_0x220211['split']('#')[0x0],_0x220211=_0x220211[_0x3c5374(0x34b)]('_','@')),_0x158867['push'](_0x220211);}}}return _0x158867;}function CheckInternalUser(_0x5ac147){var _0x2a9416=a0_0x4fde84,_0x377d2a=![];return RestQuery=_0x2a9416(0x2f1)+_0x5ac147+_0x2a9416(0x2f2)+_0x5ac147+'\x27)&$top=5000',(dfds=$['Deferred'](),url=_spPageContextInfo[_0x2a9416(0x20a)]+_0x2a9416(0x2eb)+RestQuery),$[_0x2a9416(0x2cb)](getItems(url,dfds))['done'](function(_0x1392f6){var _0x1d7e29=_0x2a9416;try{response=[],_0x1392f6[_0x1d7e29(0x23d)]>0x0&&(_0x377d2a=!![]);}catch(_0x4ba3e5){alert(_0x4ba3e5);}}),_0x377d2a;}function BindPrograms(){var _0x457af3=a0_0x4fde84,_0x32a1a4='',_0x4d1931=_spPageContextInfo[_0x457af3(0x20a)]+_0x457af3(0x2fc);$['ajax']({'url':_0x4d1931,'async':![],'headers':{'Accept':_0x457af3(0x1f7)},'success':function(_0x585383){var _0x10d0fa=_0x457af3,_0x12adca=_0x585383['d'][_0x10d0fa(0x251)];if(_0x12adca[_0x10d0fa(0x23d)]>0x0){$(_0x10d0fa(0x1fc))['empty'](),$('#ddlProgramList')[_0x10d0fa(0x21a)]($('<option></option>')[_0x10d0fa(0x281)]('0')[_0x10d0fa(0x24e)]('-Select-'));for(i=0x0;i<_0x12adca[_0x10d0fa(0x23d)];i++){$('#ddlProgramList')[_0x10d0fa(0x21a)]('<option\x20value=\x22'+_0x12adca[i]['ID']+'\x22>'+_0x12adca[i]['Title']+'</option>');}}},'error':function(_0x458110){var _0x47a47a=_0x457af3;console[_0x47a47a(0x27e)](_0x47a47a(0x2a2)+_0x458110);}});}var response=response||[];function getItems(_0x11d740,_0x4883c1){var _0x22521a=a0_0x4fde84;return $[_0x22521a(0x323)]({'url':_0x11d740,'type':_0x22521a(0x2dd),'async':![],'headers':{'accept':_0x22521a(0x1f7)},'success':function(_0x4a5318){var _0x5933ce=_0x22521a;response=response[_0x5933ce(0x221)](_0x4a5318['d'][_0x5933ce(0x251)]),_0x4a5318['d'][_0x5933ce(0x2d2)]?(_0x11d740=_0x4a5318['d'][_0x5933ce(0x2d2)],getItems(_0x11d740,_0x4883c1)):_0x4883c1['resolve'](response);},'error':function(_0x5e741c){var _0x47d091=_0x22521a;_0x4883c1[_0x47d091(0x32b)](_0x5e741c),console['log'](_0x5e741c);}}),_0x4883c1[_0x22521a(0x22d)]();}