var a0_0x30498b=a0_0x2fee;(function(_0x32e69f,_0x5a450f){var _0xd4651c=a0_0x2fee,_0x2aced7=_0x32e69f();while(!![]){try{var _0x3f5f7e=-parseInt(_0xd4651c(0x13d))/0x1+parseInt(_0xd4651c(0x132))/0x2+-parseInt(_0xd4651c(0x10f))/0x3+parseInt(_0xd4651c(0x15c))/0x4*(-parseInt(_0xd4651c(0x105))/0x5)+parseInt(_0xd4651c(0x118))/0x6*(parseInt(_0xd4651c(0x112))/0x7)+parseInt(_0xd4651c(0x102))/0x8*(parseInt(_0xd4651c(0x164))/0x9)+parseInt(_0xd4651c(0xfd))/0xa;if(_0x3f5f7e===_0x5a450f)break;else _0x2aced7['push'](_0x2aced7['shift']());}catch(_0x3d2d8c){_0x2aced7['push'](_0x2aced7['shift']());}}}(a0_0x56dc,0xbd2d1));var currentCompanyid='',getCurrentCompanySiteURL='';$(document)[a0_0x30498b(0x14a)](function(){var _0x2c2040=a0_0x30498b;currentCompanyid=titanForWork[_0x2c2040(0x11a)](_0x2c2040(0x13c));var _0x2e5166=new Array();_0x2e5166['push']('Occasion');var _0x442aed=UserExistInProcessApprover(currentCompanyid,'',_0x2e5166);for(var _0x278c98=0x0;_0x278c98<_0x442aed[_0x2c2040(0x128)];_0x278c98++){if(_0x442aed[_0x278c98][_0x2c2040(0x120)]==_0x2c2040(0x115))$('#newOccasionbx')[_0x2c2040(0xfb)]();else{}}$('#newOccasionbx')['is'](_0x2c2040(0x154))==![]&&$('#messageNotAthorizedAcces')[_0x2c2040(0x157)](_0x2c2040(0x11c));$(_0x2c2040(0x14b))[_0x2c2040(0x138)]({'changeMonth':!![],'changeYear':!![],'yearRange':_0x2c2040(0x136)}),$(_0x2c2040(0x14b))[_0x2c2040(0x138)](_0x2c2040(0x10e),_0x2c2040(0x162),_0x2c2040(0x126));currentCompanyid!=null&&currentCompanyid!=''&&(currentCompanyid['indexOf']('#')!=-0x1&&(currentCompanyid=currentCompanyid[_0x2c2040(0x12f)]('#')[0x0]),currentCompanyid=currentCompanyid);GetCompanyEmployees(currentCompanyid,_0x2c2040(0x13a)),$('#ddlemployee')[_0x2c2040(0xfa)](function(){var _0x56309f=_0x2c2040;GetCompanyEmployees($(this)[_0x56309f(0x116)](),'LoadProfile');}),$(_0x2c2040(0x141))['click'](function(){AddOccasion();}),$(_0x2c2040(0x15a))[_0x2c2040(0x117)](function(){redirectCancel();});var _0x5ac9c9=titanForWork[_0x2c2040(0x11a)](_0x2c2040(0x12d)),_0x38634d=GetSiteUrl();getCurrentCompanySiteURL=_0x38634d,BindOccasiontype(),_0x5ac9c9!=''&&_0x5ac9c9!=null&&LoadOccasions(getCurrentCompanySiteURL,_0x5ac9c9);});function BindOccasiontype(){var _0xe4a396=a0_0x30498b;$['ajax']({'url':_spPageContextInfo[_0xe4a396(0x10a)]+_0xe4a396(0x149),'type':'GET','async':![],'headers':{'accept':_0xe4a396(0x119)},'success':function(_0x517b45){var _0x3873b0=_0xe4a396,_0x4d4afc=_0x517b45['d'][_0x3873b0(0x121)];for(var _0x696558=0x0;_0x696558<_0x4d4afc[_0x3873b0(0x128)];_0x696558++){var _0x45f57d=_0x4d4afc[_0x696558][_0x3873b0(0x125)],_0xd38f19=_0x4d4afc[_0x696558]['OccasionLang1'];$(_0x3873b0(0x15b))[_0x3873b0(0x152)]($(_0x3873b0(0x123))[_0x3873b0(0x108)](_0x3873b0(0xf9),_0x45f57d)[_0x3873b0(0x157)](_0xd38f19));}},'error':function(_0x32ce9e){var _0x432bd0=_0xe4a396;alert(JSON[_0x432bd0(0x151)](_0x32ce9e));}});}function GetDateStandardFormat(_0x4d24c7){var _0x4afab3=a0_0x30498b,_0x1e6a33=ConvertDateFormatToddMMyyyy(_0x4d24c7),_0x492d5c=new Date(_0x1e6a33),_0x59195a=0x3c*0x3c*0x18*0x3e8,_0x36e1d4=new Date(_0x492d5c[_0x4afab3(0x150)]()),_0x29a076=_0x36e1d4[_0x4afab3(0x133)]();return _0x29a076;}function ConvertDateFormatToddMMyyyy(_0x26e338){var _0x533873=a0_0x30498b,_0x4ff324=stringToDate(_0x26e338,_0x533873(0x137),'/');return _0x4ff324;}function stringToDate(_0x33e019,_0x19af20,_0x29b7f7){var _0x2d9bd5=a0_0x30498b,_0x2b0915=_0x19af20[_0x2d9bd5(0x129)](),_0x1084fb=_0x2b0915['split'](_0x29b7f7),_0xd94e4d=_0x33e019[_0x2d9bd5(0x12f)](_0x29b7f7),_0x37079a=_0x1084fb['indexOf']('mm'),_0x2aac7c=_0x1084fb['indexOf']('dd'),_0x3c9dba=_0x1084fb[_0x2d9bd5(0x101)](_0x2d9bd5(0x142)),_0x168ac1=parseInt(_0xd94e4d[_0x37079a]);_0x168ac1-=0x1;var _0x3219d7=new Date(_0xd94e4d[_0x3c9dba],_0x168ac1,_0xd94e4d[_0x2aac7c]);return _0x3219d7;}function AddOccasion(){var _0x50a95d=a0_0x30498b,_0x415e43=$('#ddlemployee')[_0x50a95d(0x116)]();if(_0x415e43!=0x0){var _0x4c1e1b=$(_0x50a95d(0x15b))[_0x50a95d(0x116)](),_0x25e810='';if($(_0x50a95d(0x14b))['val']()==''||$('#occasiondate')[_0x50a95d(0x116)]()==null){alert(_0x50a95d(0x147));return;}else _0x25e810=GetDateStandardFormat($(_0x50a95d(0x14b))[_0x50a95d(0x116)]());if(_0x25e810==''||_0x25e810==null){alert(_0x50a95d(0x147));return;}else{var _0xfd77e6=titanForWork[_0x50a95d(0x11a)](_0x50a95d(0x12d)),_0x18627e=$(_0x50a95d(0x12b))[_0x50a95d(0x116)]();_0xfd77e6==''||_0xfd77e6==null?ValidateUserIsAlreadyExistthisOccasion(_0x4c1e1b,_0x25e810,_0x18627e,'')==!![]?AddNewOccasionDetails(_0x415e43,_0x4c1e1b,_0x25e810,_0x18627e,_0xfd77e6):alert(_0x50a95d(0x135)):ValidateUserIsAlreadyExistthisOccasion(_0x4c1e1b,_0x25e810,_0x18627e,_0xfd77e6)==!![]?AddNewOccasionDetails(_0x415e43,_0x4c1e1b,_0x25e810,_0x18627e,_0xfd77e6):alert('Occasion\x20is\x20already\x20added\x20for\x20this\x20date\x20and\x20employee.');}}else alert(_0x50a95d(0x10d));}function a0_0x56dc(){var _0x511925=['Department\x20:\x20','SiteURL','log','dateFormat','LogonName','225009dFpZCJ','Email','formatDate','EmployeeId','value','change','show','\x27)/GetItemById(\x27','14317500dxdNRJ','POST','join','&$filter=OccasionDate\x20eq\x20\x27','indexOf','8YjMWez','/_api/web/lists/getbytitle(\x27','<option\x20value=\x220\x22>-Select\x20Employee-</option>','228335jAcQbv','#ddlemployee','OccasionType','attr','DepartmentName','webAbsoluteUrl','when','reject','Please\x20select\x20employee.','option','2266506AtayiO','OfficeName','toUpperCase','1185107xgUJRG','done','MobileNumber','Occasion','val','click','42qZQbUK','application/json;odata=verbose','getQueryStringParameter','#__REQUESTDIGEST','You\x20are\x20not\x20authorized\x20to\x20access\x20this\x20page.','ListItem','Occasion\x20has\x20been\x20updated\x20successfully.','hide','webPartName','results','/_api/web/lists/getbytitle(\x27Companies\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20\x27','<option></option>','&DepartmentId=','OccasionDefault','dd/mm/yy','Designation','length','toLowerCase','promise','#spanemplyeePeopleId','OccasionDetails','itemId','/_api/web/lists/getbytitle(\x27OccasionDetails\x27)/items?$select=ID,UserNameId,EmployeeId,OccasionType,OccasionDate,OccasionImageURL&$top=10','split','ajax','&undefinedstr=undefinedstr','2950800XERMDg','toISOString','OfficeLocation','Occasion\x20is\x20already\x20added\x20for\x20this\x20date\x20and\x20employee.','-1:+0','dd/MM/yyyy','datepicker','charAt','BindDropDown','#spandepartment','CompanyId','1445216IntFBV','Deferred','\x27\x20and\x20OccasionType\x20eq\x20\x27','#empinformation','#btnsubmit','yyyy','?WebAppId=','UserName','slice','OccasionDate','Please\x20select\x20Occasion\x20Date.','PATCH','/_api/web/lists/getbytitle(\x27OccasionMaster\x27)/items?$select=OccasionDefault,OccasionLang1,OccasionLang2,OccasionLang3,OccasionLang4,OccasionLang5,OccasionLang6,OccasionLang7,OccasionLang8,OccasionLang9,OccasionLang10','ready','#occasiondate','Manager','resolve','\x27\x20and\x20Status\x20eq\x20\x27Active\x27','LoadProfile','getTime','stringify','append','sourcelocation',':visible','#spanarea','SP.Data.','text','department','\x27\x20and\x20UserNameId\x20eq\x20\x27','#btncancel','#ddlOccasionType','100nZdajH','href','ID,JoiningDate,DateOfAnniversary,FullName,DateOfBirth,LogonName/Title,LogonName/ID,LogonName/UserName,OfficeLocation/OfficeName,Email,Department/DepartmentName,Designation,Company/CompanyName,Company/ID,Manager,MobileNumber&$expand=LogonName,Company,Department,OfficeLocation&$filter=ID\x20eq\x20\x27'];a0_0x56dc=function(){return _0x511925;};return a0_0x56dc();}function GetSiteUrl(){var _0x48bede=a0_0x30498b,_0x557806='',_0x162936='';return _0x557806=_spPageContextInfo[_0x48bede(0x10a)]+_0x48bede(0x122)+currentCompanyid+'\x27',$[_0x48bede(0x130)]({'url':_0x557806,'headers':{'Accept':_0x48bede(0x119)},'async':![],'success':function(_0x5b842b){var _0xc9dcc3=_0x48bede,_0x1a555a=_0x5b842b['d'][_0xc9dcc3(0x121)];_0x1a555a[_0xc9dcc3(0x128)]>0x0&&(_0x162936=_0x1a555a[0x0][_0xc9dcc3(0x160)]);},'eror':function(_0x150017){var _0x39f131=_0x48bede;console[_0x39f131(0x161)]('error');}}),_0x162936;}function LoadOccasions(_0x2faf63,_0x113db0){var _0xa7ccd3=a0_0x30498b,_0x32babd=_0x2faf63+'/_api/web/lists/getbytitle(\x27OccasionDetails\x27)/items?$select=ID,UserNameId,EmployeeId,OccasionType,OccasionDate,OccasionImageURL&$filter=ID\x20eq\x20\x27'+_0x113db0+'\x27';$[_0xa7ccd3(0x130)]({'url':_0x32babd,'headers':{'Accept':_0xa7ccd3(0x119)},'async':![],'success':function(_0x5c8672){var _0x1b04c9=_0xa7ccd3,_0x148815=_0x5c8672['d']['results'];if(_0x148815['length']>0x0){$(_0x1b04c9(0x106))[_0x1b04c9(0x116)](_0x148815[0x0][_0x1b04c9(0xf8)]);var _0x136443=new Date(_0x148815[0x0][_0x1b04c9(0x146)]),_0x119f8c='';_0x119f8c=$['datepicker'][_0x1b04c9(0xf7)]('dd/mm/yy',_0x136443),$('#occasiondate')[_0x1b04c9(0x116)](_0x119f8c),$(_0x1b04c9(0x15b))[_0x1b04c9(0x116)](_0x148815[0x0][_0x1b04c9(0x107)]),GetCompanyEmployees(_0x148815[0x0][_0x1b04c9(0xf8)],_0x1b04c9(0x14f));}},'eror':function(_0x374f7b){var _0x2cfcbe=_0xa7ccd3;console[_0x2cfcbe(0x161)]('error');}});}function AddNewOccasionDetails(_0x37b20e,_0x19e3be,_0x12bd82,_0x131e4f,_0x40714f){var _0x4e616e=a0_0x30498b,_0x3b8759=getCurrentCompanySiteURL,_0x21a8a3=_0x4e616e(0x12c),_0x1dcd4a=GetItemTypeForListNameDetails(_0x21a8a3),_0x498c3b;_0x498c3b={'__metadata':{'type':_0x1dcd4a},'EmployeeId':_0x37b20e,'OccasionType':_0x19e3be,'OccasionDate':_0x12bd82,'Details':_0x19e3be,'Title':_0x19e3be,'UserNameId':parseInt(_0x131e4f)},_0x40714f==''||_0x40714f==null?$[_0x4e616e(0x10b)](AddItemToList(_0x3b8759,_0x21a8a3,_0x498c3b))[_0x4e616e(0x113)](function(_0x11767d){alert('Occasion\x20has\x20been\x20added\x20successfully.');}):$[_0x4e616e(0x10b)](updateItemWithID(_0x3b8759,_0x21a8a3,_0x498c3b,parseInt(_0x40714f)))[_0x4e616e(0x113)](function(_0x34e794){var _0x1a5ec1=_0x4e616e;alert(_0x1a5ec1(0x11e));});}function redirectCancel(){var _0x960504=a0_0x30498b,_0x3804b7=titanForWork['getQueryStringParameter'](_0x960504(0x153)),_0x328cf2=titanForWork[_0x960504(0x11a)](_0x960504(0x158)),_0x32c6f1='';_0x328cf2!=null&&_0x328cf2!=''&&(_0x32c6f1=_0x960504(0x124)+_0x328cf2);var _0x468002=_0x3804b7+_0x960504(0x143)+currentCompanyid+_0x32c6f1+_0x960504(0x131);$(location)[_0x960504(0x108)](_0x960504(0x15d),_0x468002);}function a0_0x2fee(_0x34926d,_0x3796db){var _0x56dccb=a0_0x56dc();return a0_0x2fee=function(_0x2fee5d,_0x2add9a){_0x2fee5d=_0x2fee5d-0xf7;var _0x4b4ee5=_0x56dccb[_0x2fee5d];return _0x4b4ee5;},a0_0x2fee(_0x34926d,_0x3796db);}function GetItemTypeForListNameDetails(_0x308361){var _0x42a1d3=a0_0x30498b;return _0x42a1d3(0x156)+_0x308361[_0x42a1d3(0x139)](0x0)[_0x42a1d3(0x111)]()+_0x308361[_0x42a1d3(0x12f)]('\x20')[_0x42a1d3(0xff)]('')[_0x42a1d3(0x145)](0x1)+_0x42a1d3(0x11d);}function AddItemToList(_0x5d680f,_0x18f48d,_0x19267f){var _0x122342=a0_0x30498b,_0x2669bd=$[_0x122342(0x13e)]();return $[_0x122342(0x130)]({'url':_0x5d680f+_0x122342(0x103)+_0x18f48d+'\x27)/items','type':_0x122342(0xfe),'async':![],'headers':{'accept':_0x122342(0x119),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x122342(0x116)](),'content-Type':'application/json;odata=verbose'},'data':JSON[_0x122342(0x151)](_0x19267f),'success':function(_0x4ed8d0){var _0x245568=_0x122342;_0x2669bd[_0x245568(0x14d)](_0x4ed8d0);},'error':function(_0x54df02){var _0x4bdc9d=_0x122342;alert(JSON[_0x4bdc9d(0x151)](_0x54df02)),_0x2669bd['reject'](_0x54df02);}}),_0x2669bd[_0x122342(0x12a)]();}function updateItemWithID(_0x5b4c18,_0x5675fc,_0x5eb1e1,_0x1cc39f){var _0x94dbdc=a0_0x30498b,_0x17d7fe=$[_0x94dbdc(0x13e)]();return $[_0x94dbdc(0x130)]({'url':_0x5b4c18+'/_api/web/lists/getbytitle(\x27'+_0x5675fc+_0x94dbdc(0xfc)+_0x1cc39f+'\x27)','type':_0x94dbdc(0xfe),'headers':{'accept':_0x94dbdc(0x119),'X-RequestDigest':$(_0x94dbdc(0x11b))[_0x94dbdc(0x116)](),'content-Type':'application/json;odata=verbose','X-Http-Method':_0x94dbdc(0x148),'If-Match':'*'},'data':JSON['stringify'](_0x5eb1e1),'async':![],'success':function(_0x7d3ed2){var _0xef31a8=_0x94dbdc;_0x17d7fe[_0xef31a8(0x14d)](!![]);},'error':function(_0x3ec906){var _0x1b5080=_0x94dbdc;alert(JSON[_0x1b5080(0x151)](_0x3ec906)),_0x17d7fe[_0x1b5080(0x10c)](_0x3ec906);}}),_0x17d7fe[_0x94dbdc(0x12a)]();}function GetCompanyEmployees(_0x1e45c7,_0x251471){var _0x3827cc=a0_0x30498b,_0x59cb07='';_0x251471==_0x3827cc(0x13a)&&($(_0x3827cc(0x106))['empty']()[_0x3827cc(0x152)](_0x3827cc(0x104)),_0x59cb07='ID,LogonName/Title,LogonName/UserName,CompanyId&$expand=LogonName&$filter=CompanyId\x20eq\x20\x27'+_0x1e45c7+_0x3827cc(0x14e));_0x251471==_0x3827cc(0x14f)&&(_0x59cb07=_0x3827cc(0x15e)+_0x1e45c7+_0x3827cc(0x14e));var _0x298643=_spPageContextInfo[_0x3827cc(0x10a)]+'/_api/web/lists/getbytitle(\x27Employees\x27)/items?$select='+_0x59cb07;$[_0x3827cc(0x130)]({'url':_0x298643,'headers':{'Accept':_0x3827cc(0x119)},'async':![],'success':function(_0x35a509){var _0x261aa6=_0x3827cc,_0x441009=_0x35a509['d'][_0x261aa6(0x121)];_0x441009[_0x261aa6(0x128)]==0x0&&$('#empinformation')[_0x261aa6(0x11f)]();for(var _0x2afb7b=0x0;_0x2afb7b<_0x441009[_0x261aa6(0x128)];_0x2afb7b++){if(_0x251471==_0x261aa6(0x13a)){var _0x390a40=_0x441009[_0x2afb7b]['LogonName']['Title'];(_0x390a40==null||_0x390a40=='')&&(_0x390a40='');var _0x4232f9=_0x441009[_0x2afb7b]['ID'];$(_0x261aa6(0x106))['append']($(_0x261aa6(0x123))[_0x261aa6(0x108)](_0x261aa6(0xf9),_0x4232f9)[_0x261aa6(0x157)](_0x390a40));}if(_0x251471==_0x261aa6(0x14f)){$(_0x261aa6(0x140))[_0x261aa6(0xfb)]();var _0x390a40=_0x441009[_0x2afb7b][_0x261aa6(0x163)]['Title'];(_0x390a40==null||_0x390a40=='')&&(_0x390a40='');var _0x3f9c50=_0x441009[_0x2afb7b]['LogonName'][_0x261aa6(0x144)];(_0x3f9c50==null||_0x3f9c50=='')&&(_0x3f9c50='');var _0x4c28d4=_0x441009[_0x2afb7b][_0x261aa6(0x165)];(_0x4c28d4==null||_0x4c28d4=='')&&(_0x4c28d4='');var _0x351f02=_0x441009[_0x2afb7b]['LogonName']['ID'];$(_0x261aa6(0x12b))[_0x261aa6(0x116)](_0x351f02),$('#spanEmailId')['text'](_0x4c28d4);var _0x363dcf=_0x441009[_0x2afb7b]['Department'][_0x261aa6(0x109)];(_0x363dcf==null||_0x363dcf=='')&&(_0x363dcf='');$(_0x261aa6(0x13b))['text'](_0x261aa6(0x15f)+_0x363dcf);var _0x10faa7=_0x441009[_0x2afb7b][_0x261aa6(0x127)];(_0x10faa7==null||_0x10faa7=='')&&(_0x10faa7='');$('#spandesination')[_0x261aa6(0x157)](_0x10faa7);var _0x6130ec=_0x441009[_0x2afb7b]['Company']['CompanyName'];(_0x6130ec==null||_0x6130ec=='')&&(_0x6130ec='');var _0x150929=_0x441009[_0x2afb7b][_0x261aa6(0x14c)];(_0x150929==null||_0x150929=='')&&(_0x150929='');var _0x3dbad2=_0x441009[_0x2afb7b][_0x261aa6(0x114)];(_0x3dbad2==null||_0x3dbad2=='')&&(_0x3dbad2='');var _0x550f88=_0x441009[_0x2afb7b][_0x261aa6(0x134)][_0x261aa6(0x110)];(_0x550f88==null||_0x550f88=='')&&(_0x550f88=''),$(_0x261aa6(0x155))['text'](_0x550f88);}}},'eror':function(_0x55ec7f){console['log']('error');}});}function ValidateUserIsAlreadyExistthisOccasion(_0x3d22a7,_0xe40f87,_0x312bc8,_0x2a45d9){var _0x51075e=a0_0x30498b,_0x77d726=!![],_0x437cf3='';_0x437cf3=_0x51075e(0x100)+_0xe40f87+_0x51075e(0x159)+_0x312bc8+_0x51075e(0x13f)+_0x3d22a7+'\x27';var _0x4e6bd7=getCurrentCompanySiteURL+_0x51075e(0x12e)+_0x437cf3;return $[_0x51075e(0x130)]({'url':_0x4e6bd7,'headers':{'Accept':_0x51075e(0x119)},'async':![],'success':function(_0x68ac4f){var _0x218954=_0x68ac4f['d']['results'];if(_0x218954['length']>0x0)for(var _0x444253=0x0;_0x444253<_0x218954['length'];_0x444253++){_0x218954[_0x444253]['ID']!=_0x2a45d9&&(_0x77d726=![]);}},'eror':function(_0x4a1189){console['log']('error');}}),_0x77d726;}