const a0_0x3bd4e9=a0_0x1a47;(function(_0x2bbe7f,_0x2fc7f1){const _0x5d0414=a0_0x1a47,_0x599098=_0x2bbe7f();while(!![]){try{const _0x447bbf=-parseInt(_0x5d0414(0x114))/0x1*(parseInt(_0x5d0414(0x103))/0x2)+-parseInt(_0x5d0414(0xf2))/0x3*(-parseInt(_0x5d0414(0xf8))/0x4)+-parseInt(_0x5d0414(0x109))/0x5+parseInt(_0x5d0414(0xe8))/0x6*(parseInt(_0x5d0414(0xed))/0x7)+parseInt(_0x5d0414(0x111))/0x8*(parseInt(_0x5d0414(0x101))/0x9)+-parseInt(_0x5d0414(0x10e))/0xa*(-parseInt(_0x5d0414(0x118))/0xb)+-parseInt(_0x5d0414(0xf9))/0xc;if(_0x447bbf===_0x2fc7f1)break;else _0x599098['push'](_0x599098['shift']());}catch(_0x510ea3){_0x599098['push'](_0x599098['shift']());}}}(a0_0x212a,0x1efa4));const siteUrl=_spPageContextInfo[a0_0x3bd4e9(0x119)],selectedFolders=[];function downloadSelectedFilesAsZip(){const _0x17b8cc=a0_0x3bd4e9;var _0x133cad=document[_0x17b8cc(0x10d)]('files'),_0x36e709=[];_0x133cad[_0x17b8cc(0x105)](function(_0x469d9d){const _0x4e976a=_0x17b8cc;_0x469d9d['checked']&&(_0x36e709['push'](_0x469d9d[_0x4e976a(0xfe)]),selectedFolders['push'](_0x469d9d[_0x4e976a(0xfe)]));}),downloadFolders();}function a0_0x1a47(_0x3c43fa,_0x1a6c04){const _0x212a1c=a0_0x212a();return a0_0x1a47=function(_0x1a4729,_0x5f4fda){_0x1a4729=_0x1a4729-0xe6;let _0x11d761=_0x212a1c[_0x1a4729];return _0x11d761;},a0_0x1a47(_0x3c43fa,_0x1a6c04);}async function getFolderContents(_0x42c02f,_0x581386,_0x1de617){const _0x3b9029=a0_0x3bd4e9;try{const _0x3e47e2=await fetch(_0x42c02f+_0x3b9029(0x112)+_0x1de617+_0x3b9029(0xee)),_0x5fa475=await _0x3e47e2[_0x3b9029(0xfc)](),_0x3fa632=_0x5fa475['Files'],_0x2ee499=_0x5fa475[_0x3b9029(0x11b)];for(const _0x4a554f of _0x3fa632){const _0x50d200=_0x42c02f+'/'+_0x4a554f[_0x3b9029(0xf3)],_0xd9148c=await fetch(_0x50d200),_0x5b8d75=await _0xd9148c[_0x3b9029(0xfb)](),_0x440d2f=_0x1de617+'/'+_0x4a554f[_0x3b9029(0xf0)];_0x581386[_0x3b9029(0xf1)](_0x440d2f,_0x5b8d75);}for(const _0x4f33f7 of _0x2ee499){const _0x5251c3=_0x4f33f7['Name'],_0x35d0bf=_0x35d0bf+'/'+_0x5251c3,_0x47fbc4=_0x42c02f+_0x3b9029(0x112)+_0x35d0bf+'\x27)';await getFolderContents(_0x42c02f,_0x581386,_0x35d0bf);}return _0x581386;}catch(_0x23c6bd){console['log'](_0x23c6bd);}}async function downloadFolders(){const _0x5ddfc9=a0_0x3bd4e9;try{const _0xe4f5f7=new JSZip(),_0x330bc2=siteUrl+_0x5ddfc9(0x116),_0x34962f=await fetch(_0x330bc2,{'method':'POST','headers':{'Accept':_0x5ddfc9(0xef),'Content-Type':_0x5ddfc9(0xef),'odata-version':'','X-RequestDigest':$('#__REQUESTDIGEST')['val']()}}),_0x1e66c7=await _0x34962f[_0x5ddfc9(0xfc)](),_0x282034=_0x1e66c7['d'][_0x5ddfc9(0x115)]['FormDigestValue'];for(const _0x4cf85d of selectedFolders){const _0x4cf16b=siteUrl,_0x2668f0=_0x4cf85d;await getFolderContents(_0x4cf16b,_0xe4f5f7,_0x2668f0);}const _0x5ad2c2=await _0xe4f5f7[_0x5ddfc9(0xe6)]({'type':_0x5ddfc9(0xfb)}),_0x3d4681=URL[_0x5ddfc9(0x106)](_0x5ad2c2),_0x5488bb=document[_0x5ddfc9(0xf4)]('a');_0x5488bb['href']=_0x3d4681,_0x5488bb[_0x5ddfc9(0xe7)]=_0x5ddfc9(0xeb),document[_0x5ddfc9(0xf5)][_0x5ddfc9(0x107)](_0x5488bb),_0x5488bb[_0x5ddfc9(0xf6)](),document[_0x5ddfc9(0xf5)][_0x5ddfc9(0x117)](_0x5488bb);}catch(_0x301ce7){console[_0x5ddfc9(0xfd)](_0x301ce7);}}const zip=new JSZip();async function addFolderToZip(_0x5845a7,_0x1ddcb6){const _0x230a66=a0_0x3bd4e9,_0x2ae367=await retrieveFolderInfo(_0x5845a7),_0xeae978=_0x2ae367['Name'],_0x33d959=_0x1ddcb6[_0x230a66(0x11a)](_0xeae978);for(const _0x2b4047 of _0x2ae367['Files']){const _0x1c37d4=_0x2b4047[_0x230a66(0xf0)],_0x2da884=await retrieveFileContents(_0x2b4047[_0x230a66(0xf3)]);_0x33d959[_0x230a66(0xf1)](_0x1c37d4,_0x2da884);}for(const _0x2c9a08 of _0x2ae367['Folders']){const _0xa781cc=_0x5845a7+'/'+_0x2c9a08[_0x230a66(0xf0)];await addFolderToZip(_0xa781cc,_0x33d959);}}async function downloadSelectedFolders(){const _0x46113a=a0_0x3bd4e9,_0x11dd4b=[],_0x3d9ad7=document[_0x46113a(0x10d)](_0x46113a(0x10b));for(const _0xfa7b5d of _0x3d9ad7){_0xfa7b5d['checked']&&_0x11dd4b['push'](_0xfa7b5d['value']);}for(const _0x3dfe71 of _0x11dd4b){await addFolderToZip(_0x3dfe71,zip);}const _0x448951=await zip[_0x46113a(0xe6)]({'type':_0x46113a(0xfb)}),_0x32df04=document[_0x46113a(0xf4)]('a');_0x32df04['href']=URL[_0x46113a(0x106)](_0x448951),_0x32df04['download']='folders.zip',document[_0x46113a(0xf5)][_0x46113a(0x107)](_0x32df04),_0x32df04[_0x46113a(0xf6)]();}function getFilesFromLibrary(_0x473ba5){const _0x430737=a0_0x3bd4e9;var _0x1ee752=_0x473ba5+_0x430737(0x110);$[_0x430737(0x100)]({'url':_0x1ee752,'type':_0x430737(0x104),'headers':{'Accept':_0x430737(0xef)},'success':function(_0x4bf6c4){const _0x36e946=_0x430737;var _0x89daf4=_0x4bf6c4['d'][_0x36e946(0x102)],_0x397205=[];_0x89daf4[_0x36e946(0x105)](function(_0x54c187){const _0x3d1cd6=_0x36e946;var _0x17c302=_0x54c187[_0x3d1cd6(0xec)]['substring'](_0x54c187[_0x3d1cd6(0xec)][_0x3d1cd6(0x113)]('/')+0x1),_0x4a67b6={'name':_0x17c302,'url':_0x54c187[_0x3d1cd6(0xec)],'checkbox':_0x3d1cd6(0x10a)+_0x54c187[_0x3d1cd6(0xec)]+'\x27>'};_0x397205[_0x3d1cd6(0x10f)](_0x4a67b6);});var _0x420b0d=_0x36e946(0xff);_0x420b0d+=_0x36e946(0x108),_0x397205[_0x36e946(0x105)](function(_0x117094){const _0x221323=_0x36e946;_0x420b0d+=_0x221323(0xfa)+_0x117094[_0x221323(0xf7)]+'</td><td>'+_0x117094[_0x221323(0xea)]+_0x221323(0xe9);}),_0x420b0d+='</table>',$(_0x36e946(0x10c))['html'](_0x420b0d);},'error':function(_0x5713ca){const _0x27a73e=_0x430737;console[_0x27a73e(0xfd)](_0x5713ca);}});}function a0_0x212a(){const _0x416356=['removeChild','3641oxvoep','webAbsoluteUrl','folder','Folders','generateAsync','download','3930QMHAtY','</td></tr>','name','folders.zip','FileRef','658LcOhdM','\x27)?$expand=Folders,Files','application/json;odata=verbose','Name','file','3yiTENT','ServerRelativeUrl','createElement','body','click','checkbox','143436OBHruu','379200lIZzlS','<tr><td>','blob','json','log','value','<table>','ajax','9mRfWDv','results','22100zAcRks','GET','forEach','createObjectURL','appendChild','<tr><th>Select</th><th>Name</th></tr>','1222425QFvxHM','<input\x20type=\x27checkbox\x27\x20name=\x27files\x27\x20value=\x27','files','#fileList','getElementsByName','6810YXKXor','push','/_api/web/lists/getByTitle(\x27DemoLibrary\x27)/items?$select=FileRef&$orderby=FileLeafRef&$filter=FSObjType\x20eq\x201','994632ozeGZo','/_api/web/GetFolderByServerRelativeUrl(\x27','lastIndexOf','4rJcAoi','GetContextWebInformation','/_api/contextinfo'];a0_0x212a=function(){return _0x416356;};return a0_0x212a();}getFilesFromLibrary(siteUrl);