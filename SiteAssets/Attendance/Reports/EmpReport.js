var a0_0x475c02=a0_0x470e;(function(_0x1da947,_0x33ffc0){var _0x576a76=a0_0x470e,_0x33d042=_0x1da947();while(!![]){try{var _0x44d97e=parseInt(_0x576a76(0x1ce))/0x1*(parseInt(_0x576a76(0x258))/0x2)+parseInt(_0x576a76(0x1e5))/0x3*(-parseInt(_0x576a76(0x212))/0x4)+-parseInt(_0x576a76(0x1f2))/0x5*(parseInt(_0x576a76(0x229))/0x6)+parseInt(_0x576a76(0x1b2))/0x7*(-parseInt(_0x576a76(0x1c6))/0x8)+-parseInt(_0x576a76(0x22a))/0x9+parseInt(_0x576a76(0x209))/0xa+-parseInt(_0x576a76(0x23c))/0xb*(parseInt(_0x576a76(0x279))/0xc);if(_0x44d97e===_0x33ffc0)break;else _0x33d042['push'](_0x33d042['shift']());}catch(_0x4efbe2){_0x33d042['push'](_0x33d042['shift']());}}}(a0_0x306f,0x26535));var Totaldays=0x0,CompanyID='',GstartDate='',GEmpID=0x0;$(document)[a0_0x475c02(0x1c9)](function(){var _0x4eaf84=a0_0x475c02;ValidateHrAdmin(),CompanyID=titanForWork[_0x4eaf84(0x248)]('CompanyId');var _0xb4647b=$[_0x4eaf84(0x218)]('EID'),_0x5e7ee3=$[_0x4eaf84(0x218)](_0x4eaf84(0x242)),_0x4d2fc1=$[_0x4eaf84(0x218)](_0x4eaf84(0x213));if(_0xb4647b!=null){GEmpID=_0xb4647b;var _0x58bd5e=_0x5e7ee3[_0x4eaf84(0x269)](0x0,0x4)+'-'+_0x5e7ee3[_0x4eaf84(0x269)](0x4,0x6)+'-'+_0x5e7ee3[_0x4eaf84(0x269)](0x6,0x8),_0xda4f00=_0x4d2fc1[_0x4eaf84(0x269)](0x0,0x4)+'-'+_0x4d2fc1['slice'](0x4,0x6)+'-'+_0x4d2fc1[_0x4eaf84(0x269)](0x6,0x8),_0x298403=new Date(_0xda4f00),_0x348498=_0x298403[_0x4eaf84(0x1ed)](),_0x1ccf61=_0x348498[_0x4eaf84(0x255)]('T');GstartDate=_0x58bd5e,$(_0x4eaf84(0x27b))[_0x4eaf84(0x27c)]({'dateFormat':_0x4eaf84(0x1c5)})['datepicker'](_0x4eaf84(0x21b),new Date(_0x58bd5e)),$('#EmpreportTo')[_0x4eaf84(0x27c)]({'dateFormat':_0x4eaf84(0x1c5)})[_0x4eaf84(0x27c)](_0x4eaf84(0x21b),new Date(_0xda4f00));var _0xa49714=$(_0x4eaf84(0x27b))[_0x4eaf84(0x27c)]('getDate'),_0x20a408=$(_0x4eaf84(0x1db))[_0x4eaf84(0x27c)](_0x4eaf84(0x25a));days=(_0x20a408-_0xa49714)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x4eaf84(0x24a)](days)+0x1,$(_0x4eaf84(0x1c4))[_0x4eaf84(0x257)](formatDateReportEmp($(_0x4eaf84(0x27b))[_0x4eaf84(0x224)]())),$(_0x4eaf84(0x1d1))[_0x4eaf84(0x257)](formatDateReportEmp($(_0x4eaf84(0x1db))[_0x4eaf84(0x224)]()));var _0x50068c=_spPageContextInfo[_0x4eaf84(0x1be)]+_0x4eaf84(0x21e)+_0xb4647b+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';EmployeeListDat(_0x50068c),LoadAllHolidays();var _0x25ab58=_spPageContextInfo[_0x4eaf84(0x1be)]+_0x4eaf84(0x1e2)+_0x58bd5e+'\x27\x20and\x20AttendanceDate\x20le\x20\x27'+_0x1ccf61[0x0]+'\x27\x20and\x20Employee\x20eq\x20\x27'+_0xb4647b+'\x27\x20';getFileData(_0x25ab58);var _0x50068c=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0xb4647b+_0x4eaf84(0x1d2)+CompanyID+'\x27';EmployeeListDat(_0x50068c),LoadAllHolidays(),initializePeoplePicker(_0x4eaf84(0x215));}});var EmployeeID='',ItemID='',SelectedDate='',TDID='';function attendanceEditModal(_0x4ad070,_0x4153e9,_0xec95a7){var _0x185a71=a0_0x475c02;EmployeeID=0x0,ItemID=0x0,SelectedDate='',TDID=_0xec95a7,EmployeeID=_0x4ad070,ItemID=_0x4153e9;var _0x1f96e2=_0xec95a7[_0x185a71(0x1da)](),_0x3c968a=_0x1f96e2[_0x185a71(0x269)](0x0,0x4)+'-'+_0x1f96e2[_0x185a71(0x269)](0x4,0x6)+'-'+_0x1f96e2['slice'](0x6,0x8),_0x89eb19=new Date(_0x3c968a);SelectedDate=_0x89eb19[_0x185a71(0x1ed)]()[_0x185a71(0x255)]('T')[0x0];var _0x1187ec=formatDateReportEmp(_0x89eb19);$(_0x185a71(0x264))['text'](_0x1187ec),GetHolidays(_0x3c968a);}function UpdateAttendance(){ItemID==0x0?(G_Validateholiday==!![]?confirm('This\x20is\x20a\x20Holiday,\x20are\x20you\x20sure\x20to\x20submit\x20your\x20attendance.')&&PushNewAttendance():PushNewAttendance(),Applyfilter(),LoadAllHolidays()):(G_Validateholiday==!![]?confirm('This\x20is\x20a\x20Holiday,\x20are\x20you\x20sure\x20to\x20submit\x20your\x20attendance.')&&ModifyAttendance():ModifyAttendance(),Applyfilter(),LoadAllHolidays());}function PushNewAttendance(){var _0x21dba2=a0_0x475c02;$(_0x21dba2(0x233))['val']()!='Holiday'||G_Validateholiday==!![]?$[_0x21dba2(0x26f)]({'url':_spPageContextInfo[_0x21dba2(0x1be)]+_0x21dba2(0x266),'type':'POST','async':![],'data':JSON[_0x21dba2(0x20c)]({'__metadata':{'type':_0x21dba2(0x26b)},'AttendanceDate':SelectedDate,'EmployeeId':EmployeeID,'AttendanceType':$(_0x21dba2(0x233))['val']()}),'headers':{'Accept':'application/json;odata=verbose','Content-Type':_0x21dba2(0x21f),'X-RequestDigest':$(_0x21dba2(0x26a))[_0x21dba2(0x224)](),'X-HTTP-Method':'POST'},'success':function(_0x3c0a79,_0x2df5e3,_0x100100){var _0x194940=_0x21dba2;$('#Att'+TDID)['text']($('#AttendanceDDL')['val']()),alert(_0x194940(0x236)),$(_0x194940(0x1a5))[_0x194940(0x259)](_0x194940(0x217)),GetAttendanceorLeaves();},'error':function(_0x5a61e3,_0x40c028,_0x2d0fab){var _0x81cc01=_0x21dba2;alert(_0x81cc01(0x249));}}):alert(_0x21dba2(0x232));}function ModifyAttendance(){var _0x2cd2ac=a0_0x475c02;$(_0x2cd2ac(0x233))['val']()!=_0x2cd2ac(0x20b)||G_Validateholiday==!![]?$[_0x2cd2ac(0x26f)]({'url':_spPageContextInfo[_0x2cd2ac(0x1be)]+_0x2cd2ac(0x1df)+ItemID+')','type':_0x2cd2ac(0x1e9),'async':![],'data':JSON['stringify']({'__metadata':{'type':_0x2cd2ac(0x26b)},'AttendanceType':$(_0x2cd2ac(0x233))[_0x2cd2ac(0x224)]()}),'headers':{'Accept':_0x2cd2ac(0x21f),'Content-Type':_0x2cd2ac(0x21f),'X-RequestDigest':$(_0x2cd2ac(0x26a))[_0x2cd2ac(0x224)](),'IF-MATCH':'*','X-HTTP-Method':_0x2cd2ac(0x21c)},'success':function(_0x27ff3b,_0x4d4292,_0x554e5a){var _0x142e22=_0x2cd2ac;$('#Att'+TDID)[_0x142e22(0x257)]($(_0x142e22(0x233))[_0x142e22(0x224)]()),$(_0x142e22(0x1e7)+TDID)[_0x142e22(0x257)](_0x142e22(0x237)),alert(_0x142e22(0x236)),$(_0x142e22(0x1a5))[_0x142e22(0x259)](_0x142e22(0x217)),GetAttendanceorLeaves();},'error':function(_0x11a169,_0x402592,_0x262256){var _0x220933=_0x2cd2ac;alert(_0x220933(0x249));}}):alert(_0x2cd2ac(0x232));}function initializePeoplePicker(_0x3ad0a9){var _0x2cc808=a0_0x475c02,_0x3b7879={};_0x3b7879[_0x2cc808(0x274)]=_0x2cc808(0x273),_0x3b7879['SearchPrincipalSource']=0xf,_0x3b7879[_0x2cc808(0x1bd)]=0xf,_0x3b7879['AllowMultipleValues']=![],_0x3b7879[_0x2cc808(0x25f)]=0x32,_0x3b7879[_0x2cc808(0x1fa)]=_0x2cc808(0x1a8),this[_0x2cc808(0x26c)](_0x3ad0a9,null,_0x3b7879);}function Applyfilter(){var _0xd057d6=a0_0x475c02,_0x53c86f=moment($(_0xd057d6(0x27b))[_0xd057d6(0x224)](),'LL')['format'](_0xd057d6(0x250)),_0x1cfc34=moment($(_0xd057d6(0x1db))['val'](),'LL')[_0xd057d6(0x243)]('DD\x20MMM\x20YYYY');if(Date['parse'](_0x53c86f)>Date[_0xd057d6(0x203)](_0x1cfc34))alert(_0xd057d6(0x1cc));else{$(_0xd057d6(0x1f9))[_0xd057d6(0x259)]('hide');var _0x521fa6=$[_0xd057d6(0x218)](_0xd057d6(0x26e)),_0x394676=$('#EmpreportFrom')[_0xd057d6(0x27c)](_0xd057d6(0x25a)),_0x106e33=$(_0xd057d6(0x1db))[_0xd057d6(0x27c)]('getDate');days=(_0x106e33-_0x394676)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0xd057d6(0x24a)](days)+0x1,$('#StartDate')[_0xd057d6(0x257)](formatDateReportEmp($('#EmpreportFrom')['val']())),$(_0xd057d6(0x1d1))[_0xd057d6(0x257)](formatDateReportEmp($(_0xd057d6(0x1db))[_0xd057d6(0x224)]()));var _0x53c86f=moment($(_0xd057d6(0x27b))[_0xd057d6(0x224)](),'LL')[_0xd057d6(0x243)](_0xd057d6(0x1bb)),_0x1cfc34=moment($(_0xd057d6(0x1db))[_0xd057d6(0x224)](),'LL')[_0xd057d6(0x243)](_0xd057d6(0x1bb)),_0x341ef3=new Date(_0x1cfc34),_0x15b1de=_0x341ef3[_0xd057d6(0x1ed)](),_0x44b23d=_0x15b1de[_0xd057d6(0x255)]('T');GstartDate=_0x53c86f;var _0x3301ff=ensureUser($(_0xd057d6(0x20e))[_0xd057d6(0x25b)]()[_0xd057d6(0x25b)]()[_0xd057d6(0x1c2)]('id'));if(_0x3301ff==0x0){_0x521fa6=_0x521fa6,GEmpID=_0x521fa6;var _0x4c7187=_spPageContextInfo[_0xd057d6(0x1be)]+_0xd057d6(0x1e2)+_0x53c86f+_0xd057d6(0x22b)+_0x44b23d[0x0]+_0xd057d6(0x1af)+_0x521fa6+'\x27\x20';getFileData(_0x4c7187);var _0xc5b005=_spPageContextInfo[_0xd057d6(0x1be)]+_0xd057d6(0x21e)+_0x521fa6+_0xd057d6(0x1d2)+CompanyID+'\x27';EmployeeListDat(_0xc5b005);}else{if(ISHRADMIN==!![]){_0x521fa6=_0x3301ff,GEmpID=_0x3301ff;var _0x4c7187=_spPageContextInfo[_0xd057d6(0x1be)]+_0xd057d6(0x1e2)+_0x53c86f+_0xd057d6(0x22b)+_0x44b23d[0x0]+'\x27\x20and\x20Employee\x20eq\x20\x27'+_0x521fa6+'\x27\x20';getFileData(_0x4c7187);var _0xc5b005=_spPageContextInfo[_0xd057d6(0x1be)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x521fa6+_0xd057d6(0x1d2)+CompanyID+'\x27';EmployeeListDat(_0xc5b005);}else alert(_0xd057d6(0x214));}LoadAllHolidays();}}var DataIdList=[],EmpAttendanceData=[],TotalLeavesorAbsent=[];function getFileData(_0x1b2e2c){var _0x3bb6ad=a0_0x475c02;jQuery[_0x3bb6ad(0x26f)]({'url':_0x1b2e2c,'headers':{'Accept':_0x3bb6ad(0x21f)},'async':![],'success':function(_0x11f646){var _0x3051c5=_0x3bb6ad;EmpAttendanceData=[];var _0x35325b=_0x11f646['d'][_0x3051c5(0x20d)];DataIdList=[];var _0x339f68=[];TotalLeavesorAbsent=[];for(var _0x272156=0x0;_0x272156<_0x35325b[_0x3051c5(0x1bc)];_0x272156++){if(_0x35325b[_0x272156][_0x3051c5(0x227)]!=_0x3051c5(0x267)&&_0x35325b[_0x272156]['AttendanceType']!='Holiday')_0x339f68[_0x3051c5(0x1de)](_0x35325b[_0x272156][_0x3051c5(0x227)]);else{if(_0x35325b[_0x272156]['AttendanceType']==_0x3051c5(0x267))TotalLeavesorAbsent['push'](_0x35325b[_0x272156][_0x3051c5(0x227)]);else _0x35325b[_0x272156][_0x3051c5(0x227)]==_0x3051c5(0x20b)&&TotalLeavesorAbsent['push'](_0x35325b[_0x272156][_0x3051c5(0x227)]);}var _0x39495c=_0x35325b[_0x272156]['ID'],_0x26960c=_0x35325b[_0x272156]['Employee'][_0x3051c5(0x1b1)],_0x4b207c=_0x35325b[_0x272156][_0x3051c5(0x1ca)]['ID'],_0x370def=formatDateReportEmp(_0x35325b[_0x272156][_0x3051c5(0x219)]),_0x55e09f=_0x35325b[_0x272156][_0x3051c5(0x227)],_0x4ebfb1=_0x35325b[_0x272156]['WorkHours'],_0x3362e0=_0x35325b[_0x272156][_0x3051c5(0x22f)];EmpAttendanceData[_0x3051c5(0x1de)]({'UserId':_0x4b207c,'EmpName':_0x26960c,'AttendanceDate':_0x370def,'AttendanceType':_0x55e09f,'AttendanceItemId':_0x39495c,'EmpWorkHours':_0x4ebfb1,'HrAction':_0x3362e0});}var _0x4630b4='';$(_0x3051c5(0x27a))[_0x3051c5(0x270)]();var _0x42068a=0x0,_0xa62eed=0x0;for(var _0x45e123=0x0;_0x45e123<Totaldays;_0x45e123++){var _0x5c6dd3=new Date(GstartDate);_0x5c6dd3[_0x3051c5(0x21b)](_0x5c6dd3['getDate']()+_0x45e123);var _0x18fa5e=moment(_0x5c6dd3,_0x3051c5(0x1f8))[_0x3051c5(0x243)](_0x3051c5(0x1bb)),_0x18fa5e=_0x18fa5e[_0x3051c5(0x255)]('-')[_0x3051c5(0x1f7)]('');DataIdList[_0x3051c5(0x1de)](_0x18fa5e);var _0x51db18=formatDateReportEmp(_0x5c6dd3),_0x53b0c0=EmpAttendanceData[_0x3051c5(0x231)](function(_0x4366b3){var _0x20c04e=_0x3051c5;return _0x4366b3[_0x20c04e(0x219)];})[_0x3051c5(0x1f0)](_0x51db18);if(_0x53b0c0!=-0x1){var _0x17fc69=EmpAttendanceData[_0x53b0c0][_0x3051c5(0x227)],_0x1ba045=EmpAttendanceData[_0x53b0c0][_0x3051c5(0x1e3)],_0x3362e0=EmpAttendanceData[_0x53b0c0]['HrAction'],_0x4dfac6=EmpAttendanceData[_0x53b0c0][_0x3051c5(0x1b8)],_0x408b90=EmpAttendanceData[_0x53b0c0][_0x3051c5(0x1ad)],_0x5a88f5=EmpAttendanceData[_0x53b0c0][_0x3051c5(0x219)],_0x1f3ec1=_0x3051c5(0x1fe),_0x3fe6a3='block';_0x3362e0==!![]&&(_0x1f3ec1=_0x3051c5(0x1c3),_0x3fe6a3=_0x3051c5(0x1fe));if(_0x17fc69!='On-Leave'&&_0x17fc69!=_0x3051c5(0x20b)){if(_0x1ba045==null)var _0x34032a=_0x3051c5(0x278)+_spPageContextInfo[_0x3051c5(0x1be)]+_0x3051c5(0x23f)+_0x18fa5e+'&Mode='+window[_0x3051c5(0x1ac)](_0x3051c5(0x1fd))+'&sourcelocation=../Pages/Myworkplace.aspx\x27\x20><span\x20id=\x27Timeview'+_0x18fa5e+_0x3051c5(0x1f6);else var _0x34032a=_0x3051c5(0x26d)+_spPageContextInfo['webAbsoluteUrl']+'/Pages/TimeSheetEntry.aspx?WebAppId=2&Recall='+_0x18fa5e+_0x3051c5(0x1f3)+window['btoa'](_0x3051c5(0x1fd))+'&sourcelocation=../Pages/Myworkplace.aspx\x27>'+ConvertHHMM(_0x1ba045)+_0x3051c5(0x23d);}else var _0x34032a='';var _0x5b2644=![],_0x217427=Date[_0x3051c5(0x203)](_0x5a88f5['split'](',')[0x0]),_0x39a4da=new Date(),_0x41fe9f=Date[_0x3051c5(0x203)](moment(_0x39a4da)['format'](_0x3051c5(0x250)));_0x217427>_0x41fe9f&&(_0x5b2644=!![]),_0xa62eed=_0xa62eed+0x1,_0x5b2644!=!![]?(_0x4630b4+='<tr\x20class=\x27text-center\x27\x20>',_0x4630b4+=_0x3051c5(0x201)+_0x18fa5e+_0x3051c5(0x1cf)+formatDateReportEmp(_0x5c6dd3)+_0x3051c5(0x238)+_0x18fa5e+_0x3051c5(0x1d3),_0x4630b4+=_0x3051c5(0x220)+_0x18fa5e+'>'+_0x17fc69+_0x3051c5(0x22c),_0x4630b4+=_0x3051c5(0x228)+_0x18fa5e+'>'+_0x34032a+'</div></td>',_0x4630b4+=_0x3051c5(0x21d)+_0x1f3ec1+'\x20\x27><label><i\x20class=\x27fa\x20fa-check\x27\x20aria-hidden=\x27true\x27\x20style=\x27color:\x20red;\x27></i></label></div></td>',_0x4630b4+='<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27\x20style=\x27display:\x20'+_0x3fe6a3+_0x3051c5(0x1c7)+GEmpID+','+_0x408b90+','+_0x18fa5e+')\x27><i\x20class=\x27fa\x20fa-pencil\x27></i></a></div></td>',_0x4630b4+=_0x3051c5(0x1b0)):(_0x4630b4+='<tr\x20class=\x27text-center\x27\x20>',_0x4630b4+=_0x3051c5(0x201)+_0x18fa5e+'><span>'+formatDateReportEmp(_0x5c6dd3)+_0x3051c5(0x238)+_0x18fa5e+'\x27\x20class=\x27employee-report-holiday\x27></span></div></td>',_0x4630b4+=_0x3051c5(0x220)+_0x18fa5e+'>'+_0x17fc69+_0x3051c5(0x221)+_0x408b90+','+_0x18fa5e+_0x3051c5(0x1f4),_0x4630b4+=_0x3051c5(0x228)+_0x18fa5e+'>'+_0x34032a+_0x3051c5(0x22c),_0x4630b4+=_0x3051c5(0x21d)+_0x1f3ec1+_0x3051c5(0x1bf),_0x4630b4+=_0x3051c5(0x261)+_0x3fe6a3+_0x3051c5(0x260),_0x4630b4+=_0x3051c5(0x1b0));}else{var _0x288973=formatDateReportEmp(_0x5c6dd3),_0x5b2644=![],_0x217427=Date[_0x3051c5(0x203)](_0x288973[_0x3051c5(0x255)](',')[0x0]),_0x39a4da=new Date(),_0x41fe9f=Date[_0x3051c5(0x203)](moment(_0x39a4da)[_0x3051c5(0x243)](_0x3051c5(0x250)));_0x217427>_0x41fe9f&&(_0x5b2644=!![]);_0x42068a=_0x42068a+0x1;if(_0x5b2644!=!![]){var _0x1df76c=_0x3051c5(0x278)+_spPageContextInfo[_0x3051c5(0x1be)]+_0x3051c5(0x23f)+_0x18fa5e+_0x3051c5(0x1f3)+window[_0x3051c5(0x1ac)]('View')+_0x3051c5(0x244)+_0x18fa5e+_0x3051c5(0x1f6);_0x4630b4+=_0x3051c5(0x239),_0x4630b4+=_0x3051c5(0x201)+_0x18fa5e+_0x3051c5(0x1cf)+formatDateReportEmp(_0x5c6dd3)+'</span><span\x20id=\x27H'+_0x18fa5e+_0x3051c5(0x1d3),_0x4630b4+=_0x3051c5(0x220)+_0x18fa5e+_0x3051c5(0x1c0),_0x4630b4+=_0x3051c5(0x228)+_0x18fa5e+'></div></td>',_0x4630b4+='<td><div\x20class=\x27checkbox\x20m-0\x27></div></td>',_0x4630b4+=_0x3051c5(0x25d)+GEmpID+_0x3051c5(0x226)+_0x18fa5e+_0x3051c5(0x1b9),_0x4630b4+=_0x3051c5(0x1b0);}else{var _0x1df76c=_0x3051c5(0x278)+_spPageContextInfo[_0x3051c5(0x1be)]+_0x3051c5(0x23f)+_0x18fa5e+_0x3051c5(0x1f3)+window['btoa']('View')+_0x3051c5(0x244)+_0x18fa5e+_0x3051c5(0x1f6);_0x4630b4+=_0x3051c5(0x239),_0x4630b4+=_0x3051c5(0x201)+_0x18fa5e+'><span>'+formatDateReportEmp(_0x5c6dd3)+_0x3051c5(0x238)+_0x18fa5e+_0x3051c5(0x1d3),_0x4630b4+=_0x3051c5(0x220)+_0x18fa5e+_0x3051c5(0x1c0),_0x4630b4+=_0x3051c5(0x228)+_0x18fa5e+_0x3051c5(0x1c0),_0x4630b4+=_0x3051c5(0x277),_0x4630b4+=_0x3051c5(0x1fb),_0x4630b4+='</tr>';}}}var _0x24a14f=$['grep'](_0x35325b,function(_0x422807){var _0x965957=_0x3051c5;return _0x422807[_0x965957(0x227)]!=_0x965957(0x267)&&_0x422807['AttendanceType']!=_0x965957(0x20b);}),_0x559073=parseInt(TotalLeavesorAbsent[_0x3051c5(0x1bc)])+parseInt(_0x42068a)-parseInt($(_0x3051c5(0x1b7))[_0x3051c5(0x257)]());_0x559073<0x0&&(_0x559073=0x0);$(_0x3051c5(0x1e4))[_0x3051c5(0x217)](),$(_0x3051c5(0x23e))[_0x3051c5(0x257)](Totaldays);var _0x1651f1=parseInt(_0xa62eed)-parseInt(TotalLeavesorAbsent[_0x3051c5(0x1bc)]);$(_0x3051c5(0x268))['text'](_0x24a14f[_0x3051c5(0x1bc)]),$('#EmpReportTable')['append'](_0x4630b4),EmpTableConfiguration();},'error':function(_0xc32d3b,_0x27e41c){var _0x4afaa8=_0x3bb6ad;console[_0x4afaa8(0x1e8)](JSON[_0x4afaa8(0x20c)](_0xc32d3b));}});}function WithdrawLeave(_0x35245b,_0x50bc58){var _0x1377a8=a0_0x475c02;confirm(_0x1377a8(0x1fc))&&$[_0x1377a8(0x26f)]({'url':_spPageContextInfo[_0x1377a8(0x1be)]+_0x1377a8(0x1df)+_0x35245b+')','type':_0x1377a8(0x1e9),'headers':{'X-RequestDigest':$('#__REQUESTDIGEST')[_0x1377a8(0x224)](),'IF-MATCH':'*','X-HTTP-Method':_0x1377a8(0x1c1)},'success':function(_0x62a5b1,_0x2f8bf9,_0x1a6ae0){var _0x169610=_0x1377a8;$('#Att'+_0x50bc58)[_0x169610(0x24f)]('display','none'),alert(_0x169610(0x1b4));},'error':function(_0x310fd1,_0x435b4c,_0x3c631a){var _0x4f1886=_0x1377a8;$(_0x4f1886(0x1d4))[_0x4f1886(0x270)]()[_0x4f1886(0x257)](data[_0x4f1886(0x262)][_0x4f1886(0x1f5)]);}});}function ConvertDateTimeFormat(_0x455d71,_0xbcb970){var _0xb8198d=a0_0x475c02;return _0x455d71[_0xb8198d(0x255)](_0xbcb970)[0x1]+''+_0xbcb970+''+_0x455d71[_0xb8198d(0x255)](_0xbcb970)[0x0]+''+_0xbcb970+''+_0x455d71[_0xb8198d(0x255)](_0xbcb970)[0x2];}var GEmployeeID=0x0,LocID=0x0;function EmployeeListDat(_0x340599){var _0x3106f0=a0_0x475c02;GEmployeeID=0x0,$[_0x3106f0(0x26f)]({'url':_0x340599,'headers':{'Accept':_0x3106f0(0x21f)},'async':![],'success':function(_0x1439a4){var _0x5ed8e0=_0x3106f0,_0x50167d=_0x1439a4['d'][_0x5ed8e0(0x20d)];_0x50167d[_0x5ed8e0(0x1bc)]>0x0?($('#EmpName')[_0x5ed8e0(0x257)](_0x50167d[0x0]['LogonName']['Title']),GEmployeeID=_0x50167d[0x0][_0x5ed8e0(0x246)]['ID'],$(_0x5ed8e0(0x204))['text'](_0x50167d[0x0][_0x5ed8e0(0x246)]['Title']),$(_0x5ed8e0(0x271))[_0x5ed8e0(0x257)](_0x50167d[0x0][_0x5ed8e0(0x276)]['OfficeName']),$('#officeLocTH')[_0x5ed8e0(0x257)](_0x50167d[0x0][_0x5ed8e0(0x276)][_0x5ed8e0(0x234)]),LocID=_0x50167d[0x0][_0x5ed8e0(0x276)]['ID']):($(_0x5ed8e0(0x23a))[_0x5ed8e0(0x257)](''),$(_0x5ed8e0(0x271))[_0x5ed8e0(0x257)](''),LocID=0x0);},'error':function(_0x910eda){var _0x2c4169=_0x3106f0;console[_0x2c4169(0x1e8)](_0x910eda);}});}function EmpTableConfiguration(){var _0xc913eb=a0_0x475c02;sorter=new TINY[(_0xc913eb(0x241))][(_0xc913eb(0x216))](_0xc913eb(0x216),'EmpReportTableData',{'ascclass':_0xc913eb(0x263),'descclass':'desc','evenclass':_0xc913eb(0x200),'oddclass':'oddrow','evenselclass':_0xc913eb(0x21a),'oddselclass':_0xc913eb(0x20a),'paginate':!![],'size':0xa,'colddid':_0xc913eb(0x1eb),'currentid':_0xc913eb(0x230),'totalid':_0xc913eb(0x235),'startingrecid':'Empstartrecord','endingrecid':'Empendrecord','totalrecid':_0xc913eb(0x208),'hoverid':'selectedrow','pageddid':'Emppagedropdown','navid':'tablenav','sortdir':0x1,'init':!![]});}$[a0_0x475c02(0x218)]=function(_0x4686f5){var _0xb98b92=a0_0x475c02,_0x456566=new RegExp(_0xb98b92(0x1d8)+_0x4686f5+_0xb98b92(0x23b))[_0xb98b92(0x207)](window[_0xb98b92(0x245)][_0xb98b92(0x1ee)]);if(_0x456566==null)return null;return decodeURI(_0x456566[0x1])||0x0;};function formatDateReportEmp(_0x4f7c7a){var _0x451aa0=a0_0x475c02,_0xa0563c=[_0x451aa0(0x1e0),'Monday',_0x451aa0(0x1ae),_0x451aa0(0x1ec),_0x451aa0(0x1dd),_0x451aa0(0x225),_0x451aa0(0x1d5)],_0x3c48ea=new Date(_0x4f7c7a);if(isNaN(_0x3c48ea['getTime']()))return _0x4f7c7a;else{var _0x19589a=new Array();return _0x19589a[0x0]=_0x451aa0(0x211),_0x19589a[0x1]=_0x451aa0(0x24d),_0x19589a[0x2]=_0x451aa0(0x25c),_0x19589a[0x3]=_0x451aa0(0x22d),_0x19589a[0x4]=_0x451aa0(0x272),_0x19589a[0x5]='Jun',_0x19589a[0x6]=_0x451aa0(0x25e),_0x19589a[0x7]='Aug',_0x19589a[0x8]=_0x451aa0(0x1a7),_0x19589a[0x9]=_0x451aa0(0x1b3),_0x19589a[0xa]='Nov',_0x19589a[0xb]=_0x451aa0(0x24e),day=_0x3c48ea['getDate'](),day<0xa&&(day='0'+day),day+'\x20'+_0x19589a[_0x3c48ea[_0x451aa0(0x1cb)]()]+'\x20'+_0x3c48ea[_0x451aa0(0x1aa)]()+',\x20'+_0xa0563c[_0x3c48ea[_0x451aa0(0x24c)]()];}}function a0_0x306f(){var _0x585bd5=['length','ResolvePrincipalSource','webAbsoluteUrl','\x20\x27><label><i\x20class=\x27fa\x20fa-check\x27\x20aria-hidden=\x27true\x27\x20style=\x27color:\x20red;\x27></i></label></div></td>','></div></td>','DELETE','attr','block','#StartDate','MM\x20dd,\x20yy','185656cdgnwO','\x20\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal(','\x27\x20and\x20(WebPartName\x20eq\x20\x27HR\x20Admin\x27)','ready','Employee','getMonth','Invalid\x20date\x20range.\x0aFrom\x20Date\x20should\x20not\x20be\x20bigger\x20than\x20To\x20Date','On-LeaveWithdraw','15547wqtpjv','><span>','GetAllUserInfo','#EndDate','\x27\x20and\x20Company/ID\x20\x20eq\x20\x27','\x27\x20class=\x27employee-report-holiday\x27></span></div></td>','#ResultDiv','Saturday','SPClientPeoplePickerDict','#EmpRow','[?&]','Withdraw','toString','#EmpreportTo','data:application/vnd.ms-excel;base64,','Thursday','push','/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items(','Sunday','\x27)/items?$select=*,Department/DepartmentName,Department/ID&$expand=Department&$filter=CompanyId\x20eq\x20\x27','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27','EmpWorkHours','.NoRecordFound','6wKwKhc','getElementById','#Timeview','log','POST','innerHTML','columns','Wednesday','toISOString','href','#HolidayMessage','indexOf','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?$filter=OfficeLocationID\x20eq\x20(\x27','550czOWZG','&Mode=',')\x27>Withdraw</a></div></td>','error','\x27>Fill</span></a>','join','DD/MM/YYYY','#attendance-report-filter','Width','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27></div></td>','Are\x20you\x20sure\x20to\x20withdraw\x20the\x20Leave?','View','none','SPClientPeoplePicker','evenrow','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=','red','parse','#EmpTitle','Key','ProcessApprovers','exec','Emptotalrecords','2405420fiiCpM','oddselected','Holiday','stringify','results','#EmployeeName','\x20,\x20','#HolidaysTH','Jan','409748TqRjOc','end','Unauthorized\x20access!','EmployeeName','sorter','hide','urlParam','AttendanceDate','evenselected','setDate','MERGE','<td><div\x20class=\x27checkbox\x20m-0\x27\x20style=\x27display:\x20','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27','application/json;odata=verbose','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Att','<a\x20href=\x27#\x27\x20class=\x27Withdraw-Leave-link\x27\x20onclick=\x27WithdrawLeave(','#HolidayMessagediv','\x27\x20and\x20ContributorsId\x20eq\x20\x27','val','Friday',',0,','AttendanceType','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time','972KFvgqE','127359UviwRY','\x27\x20and\x20AttendanceDate\x20le\x20\x27','</div></td>','Apr','WorkHours','HrAction','Empcurrentpage','map','Plese\x20select\x20proper\x20attandence.','#AttendanceDDL','OfficeName','Emptotalpages','Data\x20has\x20been\x20saved.','00:00','</span><span\x20id=\x27H','<tr\x20class=\x27text-center\x27\x20>','#EmpName','=([^&#]*)','286814qdzXyW','</a>','#EmpTotalItemscount','/Pages/TimeSheetEntry.aspx?WebAppId=2&Recall=','display','table','start','format','&sourcelocation=../Pages/Myworkplace.aspx\x27\x20><span\x20id=\x27Timeview','location','LogonName','color','getQueryStringParameter','Error!\x20Something\x20went\x20wrong.','round','<html\x20xmlns:o=\x22urn:schemas-microsoft-com:office:office\x22\x20xmlns:x=\x22urn:schemas-microsoft-com:office:excel\x22\x20xmlns=\x22http://www.w3.org/TR/REC-html40\x22><head><!--[if\x20gte\x20mso\x209]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>','getDay','Feb','Dec','css','DD\x20MMM\x20YYYY','Hdate','#FdateTH','userId','\x27&$top=200&$orderby=Holiday_start\x20asc','split','\x27\x20and\x20Holiday_start\x20ge\x20\x27','text','38XMcfJi','modal','getDate','children','Mar','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal(','Jul','MaximumEntitySuggestions','\x20\x27></div></td>','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27\x20style=\x27display:\x20','responseJSON','asc','#SelDate','grep','/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items','On-Leave','#Total-Attendance','slice','#__REQUESTDIGEST','SP.Data.EmpAttendanceListItem','SPClientPeoplePicker_InitStandaloneControlWrapper','<a\x20href=\x27','EID','ajax','empty','#OfficeLoc','May','User,DL,SecGroup,SPGroup','PrincipalAccountType','/_api/web/ensureuser','OfficeLocation','<td><div\x20class=\x27checkbox\x20m-0\x27></div></td>','<a\x20class=\x27LinkBtn\x27\x20href=\x27','12gTLTeg','#EmpReportTable','#EmpreportFrom','datepicker','Holiday_start','#attendance-reportEdit','/_api/web/lists/getbytitle(\x27','Sept','280px','#Total-Leave-Absent','getFullYear','\x27\x20and\x20CompanyID\x20eq\x20\x27','btoa','AttendanceItemId','Tuesday','\x27\x20and\x20Employee\x20eq\x20\x27','</tr>','Title','35aWpltz','Oct','Leave\x20withdrawal\x20Successfully\x20Completed.','replace','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?select=*,ID,Title&$filter=OfficeLocationID\x20eq\x20\x27','#HoliaysTotal','UserId',')\x27><i\x20class=\x27fa\x20fa-pencil\x27></i></a></div></td>','An\x20error\x20occurred.\x20Please\x20try\x20again.','YYYY-MM-DD'];a0_0x306f=function(){return _0x585bd5;};return a0_0x306f();}function ConvertHHMM(_0x171d0f){if(_0x171d0f!=null){var _0x4ed9e0=Math['floor'](_0x171d0f/0x3c),_0x5107d5=_0x171d0f%0x3c;_0x4ed9e0<0xa&&(_0x4ed9e0='0'+_0x4ed9e0);_0x5107d5<0xa&&(_0x5107d5='0'+_0x5107d5);var _0xc53e08=_0x4ed9e0+':'+_0x5107d5;}else var _0xc53e08='';return _0xc53e08;}var AttandenceOnHolidays=0x0,HolidaysListDTL=[];function a0_0x470e(_0x25f74,_0x1bcef8){var _0x306f41=a0_0x306f();return a0_0x470e=function(_0x470e4d,_0x2756cb){_0x470e4d=_0x470e4d-0x1a4;var _0x2f9b05=_0x306f41[_0x470e4d];return _0x2f9b05;},a0_0x470e(_0x25f74,_0x1bcef8);}function LoadAllHolidays(){var _0x48e456=a0_0x475c02;TotalOfficeDays=0x0,HolidaysListDTL=[];var _0x40fb45=new Date($('#EmpreportFrom')[_0x48e456(0x224)]()),_0x28edda=_0x40fb45['getFullYear']()+'-'+(_0x40fb45[_0x48e456(0x1cb)]()+0x1)+'-'+_0x40fb45[_0x48e456(0x25a)](),_0x32e583=new Date($(_0x48e456(0x1db))[_0x48e456(0x224)]()),_0x20d1cc=_0x32e583['getFullYear']()+'-'+(_0x32e583['getMonth']()+0x1)+'-'+_0x32e583[_0x48e456(0x25a)](),_0x4d1bc8=_spPageContextInfo[_0x48e456(0x1be)]+_0x48e456(0x1b6)+LocID+'\x27\x20and\x20CompanyID\x20eq\x20\x27'+CompanyID+_0x48e456(0x256)+_0x28edda+'\x27\x20and\x20Holiday_start\x20le\x20\x27'+_0x20d1cc+'\x27';$[_0x48e456(0x26f)]({'url':_0x4d1bc8,'headers':{'Accept':_0x48e456(0x21f)},'async':![],'success':function(_0x52957e){var _0x375fb0=_0x48e456,_0x4680cc=_0x52957e['d']['results']['length'],_0x5f2f36=0x0;for(var _0x51d99a=0x0;_0x51d99a<_0x4680cc;_0x51d99a++){var _0x4cf105=new Date(_0x52957e['d'][_0x375fb0(0x20d)][_0x51d99a][_0x375fb0(0x1a4)]),_0x51bb37=moment(_0x4cf105,_0x375fb0(0x1f8))[_0x375fb0(0x243)](_0x375fb0(0x1bb)),_0x51bb37=_0x51bb37[_0x375fb0(0x255)]('-')[_0x375fb0(0x1f7)](''),_0x11911e=_0x52957e['d']['results'][_0x51d99a][_0x375fb0(0x1b1)];HolidaysListDTL['push']({'Hdate':_0x51bb37,'Title':_0x11911e}),$('#'+_0x51bb37)[_0x375fb0(0x24f)](_0x375fb0(0x247),_0x375fb0(0x202)),$('#H'+_0x51bb37)[_0x375fb0(0x257)](_0x375fb0(0x20f)+_0x11911e),$('#Att'+_0x51bb37)[_0x375fb0(0x257)]()!=''&&(_0x5f2f36=_0x5f2f36+0x1);}AttandenceOnHolidays=0x0;for(var _0x11dc72=0x0;_0x11dc72<HolidaysListDTL[_0x375fb0(0x1bc)];_0x11dc72++){var _0x28ef0a=$('#Att'+HolidaysListDTL[_0x11dc72][_0x375fb0(0x251)])[_0x375fb0(0x257)]();_0x28ef0a!=''&&_0x28ef0a!='On-Leave'&&_0x28ef0a!=_0x375fb0(0x20b)&&(AttandenceOnHolidays=AttandenceOnHolidays+0x1);}var _0x4c18da=0x0,_0x30b4b3=0x0,_0x206ce2=0x0;for(var _0x25be08=0x0;_0x25be08<DataIdList['length'];_0x25be08++){var _0x12033d=$('#Att'+DataIdList[_0x25be08])[_0x375fb0(0x257)]();_0x12033d==_0x375fb0(0x1cd)&&(_0x12033d=_0x12033d[_0x375fb0(0x255)](_0x375fb0(0x1d9))[0x0]),(_0x12033d==''||_0x12033d=='On-Leave')&&(_0x30b4b3=_0x30b4b3+0x1),_0x12033d==_0x375fb0(0x267)&&(_0x206ce2=_0x206ce2+0x1),_0x12033d==_0x375fb0(0x20b)&&(_0x4c18da=_0x4c18da+0x1);}var _0x149109=_0x30b4b3+AttandenceOnHolidays-(_0x4680cc-_0x4c18da);_0x149109<0x0&&(_0x149109=0x0),_0x149109!='0'?$(_0x375fb0(0x1a9))[_0x375fb0(0x257)](_0x149109):_0x206ce2>0x0&&$(_0x375fb0(0x1a9))[_0x375fb0(0x257)](_0x206ce2),$(_0x375fb0(0x1b7))[_0x375fb0(0x257)](_0x4680cc),$('#Workingdays')[_0x375fb0(0x257)](parseInt(Totaldays)-parseInt(_0x4680cc)),$(_0x375fb0(0x252))[_0x375fb0(0x257)](formatDateReportEmp(ConvertDateTimeFormat($(_0x375fb0(0x27b))[_0x375fb0(0x224)](),'/'))),$('#EdateTH')[_0x375fb0(0x257)](formatDateReportEmp(ConvertDateTimeFormat($('#EmpreportTo')[_0x375fb0(0x224)](),'/'))),$('#TotalWorkdayTH')[_0x375fb0(0x257)](parseInt(Totaldays)-parseInt(_0x4680cc)),$(_0x375fb0(0x210))[_0x375fb0(0x257)](_0x4680cc);},'myError':function(_0x29cc3f){}});}function ensureUser(_0x286fef){var _0x720ad3=a0_0x475c02,_0x26a4e0=0x0,_0x109b0b=_0x286fef,_0x928f7e=this[_0x720ad3(0x1ff)][_0x720ad3(0x1d6)][_0x109b0b],_0x321834=_0x928f7e[_0x720ad3(0x1d0)](),_0x12fc4d=_0x321834[0x0];if(_0x12fc4d){var _0x2320f8={'logonName':_0x12fc4d[_0x720ad3(0x205)]};$[_0x720ad3(0x26f)]({'url':_spPageContextInfo[_0x720ad3(0x1be)]+_0x720ad3(0x275),'type':_0x720ad3(0x1e9),'async':![],'contentType':_0x720ad3(0x21f),'data':JSON['stringify'](_0x2320f8),'headers':{'X-RequestDigest':$(_0x720ad3(0x26a))[_0x720ad3(0x224)](),'accept':'application/json;odata=verbose'},'success':function(_0x5524cc,_0x2b6302,_0x174eb3){_0x26a4e0=_0x5524cc['d']['Id'];},'error':function(_0x147442,_0x2e0f45,_0x129af7){}});}else _0x26a4e0=0x0;return _0x26a4e0;}var tableToExcel=(function(){var _0x5bc896=a0_0x475c02,_0x5226d9=_0x5bc896(0x1dc),_0xdba409=_0x5bc896(0x24b),_0x4b93a9=function(_0xfed87b){var _0x2584d5=_0x5bc896;return window[_0x2584d5(0x1ac)](unescape(encodeURIComponent(_0xfed87b)));},_0x1c27c0=function(_0x531eda,_0x1eab58){var _0x40e9d7=_0x5bc896;return _0x531eda[_0x40e9d7(0x1b5)](/{(\w+)}/g,function(_0x43af18,_0x24ff83){return _0x1eab58[_0x24ff83];});};return function(_0x17ad0a,_0x1c5f54){var _0x31bad7=_0x5bc896;if(!_0x17ad0a['nodeType'])_0x17ad0a=document[_0x31bad7(0x1e6)](_0x17ad0a);var _0x23e0b3={'worksheet':_0x1c5f54||'Worksheet','table':_0x17ad0a[_0x31bad7(0x1ea)]};window[_0x31bad7(0x245)][_0x31bad7(0x1ee)]=_0x5226d9+_0x4b93a9(_0x1c27c0(_0xdba409,_0x23e0b3));};}()),ISHRADMIN=![];function ValidateHrAdmin(){var _0x5ee96a=a0_0x475c02,_0x2cbc99=_0x5ee96a(0x206),_0xd60b25=_spPageContextInfo['webAbsoluteUrl']+_0x5ee96a(0x1a6)+_0x2cbc99+_0x5ee96a(0x1e1)+titanForWork[_0x5ee96a(0x248)]('CompanyId')+_0x5ee96a(0x223)+_spPageContextInfo[_0x5ee96a(0x253)]+_0x5ee96a(0x1c8);$[_0x5ee96a(0x26f)]({'url':_0xd60b25,'async':![],'type':'get','headers':{'Accept':_0x5ee96a(0x21f)},'success':function(_0x2e3eb0){var _0x47cae7=_0x5ee96a,_0x10896a=_0x2e3eb0['d'][_0x47cae7(0x20d)];_0x10896a['length']>0x0?($('#EmpRow')[_0x47cae7(0x24f)](_0x47cae7(0x240),_0x47cae7(0x1c3)),ISHRADMIN=!![]):(ISHRADMIN=![],$(_0x47cae7(0x1d7))[_0x47cae7(0x217)]());},'error':function(_0xd72f69){var _0x1ab711=_0x5ee96a;console[_0x1ab711(0x1e8)](_0xd72f69[_0x1ab711(0x262)]['error']);}});}function GetAttendanceorLeaves(){var _0x418ab8=a0_0x475c02,_0x43b548=$['urlParam'](_0x418ab8(0x26e)),_0x2d474b=$(_0x418ab8(0x27b))[_0x418ab8(0x27c)](_0x418ab8(0x25a)),_0x5a1a9d=$('#EmpreportTo')[_0x418ab8(0x27c)](_0x418ab8(0x25a));days=(_0x5a1a9d-_0x2d474b)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x418ab8(0x24a)](days)+0x1,$('#StartDate')['text'](formatDateReportEmp($(_0x418ab8(0x27b))['val']())),$(_0x418ab8(0x1d1))[_0x418ab8(0x257)](formatDateReportEmp($(_0x418ab8(0x1db))['val']()));var _0x3619ad=moment($('#EmpreportFrom')[_0x418ab8(0x224)](),'LL')['format'](_0x418ab8(0x1bb)),_0x184cc4=moment($(_0x418ab8(0x1db))[_0x418ab8(0x224)](),'LL')['format'](_0x418ab8(0x1bb)),_0x2538b7=new Date(_0x184cc4),_0x3f7c88=_0x2538b7[_0x418ab8(0x1ed)](),_0x2ee256=_0x3f7c88[_0x418ab8(0x255)]('T');GstartDate=_0x3619ad;var _0xa4b500=ensureUser($(_0x418ab8(0x20e))[_0x418ab8(0x25b)]()[_0x418ab8(0x25b)]()[_0x418ab8(0x1c2)]('id'));if(_0xa4b500==0x0){var _0x2afaec=_spPageContextInfo[_0x418ab8(0x1be)]+_0x418ab8(0x21e)+_0x43b548+_0x418ab8(0x1d2)+CompanyID+'\x27';EmployeeListDat(_0x2afaec),LoadAllHolidays(),_0x43b548=_0x43b548,GEmpID=_0x43b548;var _0x3e71aa=_spPageContextInfo[_0x418ab8(0x1be)]+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27'+_0x3619ad+'\x27\x20and\x20AttendanceDate\x20le\x20\x27'+_0x2ee256+_0x418ab8(0x1af)+_0x43b548+'\x27\x20';UpdateHeaderfields(_0x3e71aa);}else{if(ISHRADMIN==!![]){_0x43b548=_0xa4b500,GEmpID=_0xa4b500;var _0x2afaec=_spPageContextInfo['webAbsoluteUrl']+_0x418ab8(0x21e)+_0x43b548+_0x418ab8(0x1d2)+CompanyID+'\x27';EmployeeListDat(_0x2afaec),LoadAllHolidays();var _0x3e71aa=_spPageContextInfo['webAbsoluteUrl']+_0x418ab8(0x1e2)+_0x3619ad+_0x418ab8(0x22b)+_0x2ee256+_0x418ab8(0x1af)+_0x43b548+'\x27\x20';UpdateHeaderfields(_0x3e71aa);var _0x2afaec=_spPageContextInfo[_0x418ab8(0x1be)]+_0x418ab8(0x21e)+_0x43b548+_0x418ab8(0x1d2)+CompanyID+'\x27';}else alert(_0x418ab8(0x214));}LoadAllHolidays();}function GetFilterData(_0x26369d){var _0x3e86a3=a0_0x475c02;jQuery['ajax']({'url':_0x26369d,'headers':{'Accept':_0x3e86a3(0x21f)},'async':![],'success':function(_0x35d6d0){var _0x9be3d7=_0x3e86a3,_0xce8d19=_0x35d6d0['d'][_0x9be3d7(0x20d)],_0x420d8a=[];TotalLeavesorAbsent=[];for(var _0x296166=0x0;_0x296166<_0xce8d19[_0x9be3d7(0x1bc)];_0x296166++){if(_0xce8d19[_0x296166][_0x9be3d7(0x227)]!='On-Leave'&&_0xce8d19[_0x296166]['AttendanceType']!='Holiday')_0x420d8a[_0x9be3d7(0x1de)](_0xce8d19[_0x296166][_0x9be3d7(0x227)]);else _0xce8d19[_0x296166][_0x9be3d7(0x227)]==_0x9be3d7(0x267)&&TotalLeavesorAbsent[_0x9be3d7(0x1de)](_0xce8d19[_0x296166]['AttendanceType']);}var _0x7d94f7=$[_0x9be3d7(0x265)](_0xce8d19,function(_0x284909){var _0x4a5008=_0x9be3d7;return _0x284909[_0x4a5008(0x227)]!=_0x4a5008(0x267)&&_0x284909[_0x4a5008(0x227)]!='Holiday';});$('#Total-Attendance')['text'](_0x7d94f7[_0x9be3d7(0x1bc)]);},'error':function(_0x10e082,_0x4d0b08){var _0x4b2b0f=_0x3e86a3;console[_0x4b2b0f(0x1e8)](JSON[_0x4b2b0f(0x20c)](_0x10e082));}});}var G_Validateholiday=![];function GetHolidays(_0x79ce7f){var _0x31f0e5=a0_0x475c02,_0xf8ea00=_spPageContextInfo[_0x31f0e5(0x1be)]+_0x31f0e5(0x1f1)+LocID+'\x27)and\x20Holiday_start\x20eq\x20\x27'+_0x79ce7f+_0x31f0e5(0x1ab)+titanForWork['getQueryStringParameter']('CompanyId')+_0x31f0e5(0x254);$['ajax']({'url':_0xf8ea00,'headers':{'Accept':_0x31f0e5(0x21f)},'async':![],'success':function(_0x20ab0c){var _0x182617=_0x31f0e5,_0x1b8ef5=_0x20ab0c['d'][_0x182617(0x20d)];_0x1b8ef5[_0x182617(0x1bc)]>0x0?($(_0x182617(0x222))['text'](_0x1b8ef5[0x0][_0x182617(0x1b1)]),$(_0x182617(0x1ef))[_0x182617(0x24f)](_0x182617(0x240),_0x182617(0x1c3)),G_Validateholiday=!![]):($(_0x182617(0x222))[_0x182617(0x257)](''),$(_0x182617(0x1ef))['css'](_0x182617(0x240),'none'),G_Validateholiday=![]);},'error':function(_0x2866d4){var _0x38ba05=_0x31f0e5;alert(_0x38ba05(0x1ba));}});}var EmpAttendanceData=[],TotalLeavesorAbsent=[];function UpdateHeaderfields(_0x1d0886){var _0x8a33d0=a0_0x475c02;jQuery['ajax']({'url':_0x1d0886,'headers':{'Accept':_0x8a33d0(0x21f)},'async':!![],'success':function(_0x52e632){var _0x4ae464=_0x8a33d0;EmpAttendanceData=[];var _0x298edd=_0x52e632['d'][_0x4ae464(0x20d)],_0x3aeeb1=[];TotalLeavesorAbsent=[];for(var _0x25df00=0x0;_0x25df00<_0x298edd['length'];_0x25df00++){if(_0x298edd[_0x25df00][_0x4ae464(0x227)]!=_0x4ae464(0x267)&&_0x298edd[_0x25df00]['AttendanceType']!=_0x4ae464(0x20b))_0x3aeeb1[_0x4ae464(0x1de)](_0x298edd[_0x25df00][_0x4ae464(0x227)]);else{if(_0x298edd[_0x25df00]['AttendanceType']==_0x4ae464(0x267))TotalLeavesorAbsent[_0x4ae464(0x1de)](_0x298edd[_0x25df00]['AttendanceType']);else _0x298edd[_0x25df00][_0x4ae464(0x227)]=='Holiday'&&TotalLeavesorAbsent['push'](_0x298edd[_0x25df00]['AttendanceType']);}var _0x12dc65=_0x298edd[_0x25df00]['ID'],_0x3d22fc=_0x298edd[_0x25df00][_0x4ae464(0x1ca)][_0x4ae464(0x1b1)],_0x807ce5=_0x298edd[_0x25df00][_0x4ae464(0x1ca)]['ID'],_0x1057ac=formatDateReportEmp(_0x298edd[_0x25df00][_0x4ae464(0x219)]),_0x16b4db=_0x298edd[_0x25df00][_0x4ae464(0x227)],_0x544ef7=_0x298edd[_0x25df00][_0x4ae464(0x22e)],_0x171069=_0x298edd[_0x25df00]['HrAction'];EmpAttendanceData[_0x4ae464(0x1de)]({'UserId':_0x807ce5,'EmpName':_0x3d22fc,'AttendanceDate':_0x1057ac,'AttendanceType':_0x16b4db,'AttendanceItemId':_0x12dc65,'EmpWorkHours':_0x544ef7,'HrAction':_0x171069});}var _0x508178='',_0x2c224f=0x0,_0x3218b8=0x0;for(var _0x1bb89b=0x0;_0x1bb89b<Totaldays;_0x1bb89b++){var _0x334803=new Date(GstartDate);_0x334803[_0x4ae464(0x21b)](_0x334803[_0x4ae464(0x25a)]()+_0x1bb89b);var _0xe3f7d7=moment(_0x334803,_0x4ae464(0x1f8))[_0x4ae464(0x243)]('YYYY-MM-DD'),_0xe3f7d7=_0xe3f7d7[_0x4ae464(0x255)]('-')[_0x4ae464(0x1f7)](''),_0x1b4382=formatDateReportEmp(_0x334803),_0x4fbc4e=EmpAttendanceData['map'](function(_0x4911a0){return _0x4911a0['AttendanceDate'];})[_0x4ae464(0x1f0)](_0x1b4382);if(_0x4fbc4e!=-0x1){var _0x3fd29a=EmpAttendanceData[_0x4fbc4e][_0x4ae464(0x227)],_0x9c60a4=EmpAttendanceData[_0x4fbc4e]['EmpWorkHours'],_0x171069=EmpAttendanceData[_0x4fbc4e][_0x4ae464(0x22f)],_0x2d3f8c=EmpAttendanceData[_0x4fbc4e]['UserId'],_0x3e541b=EmpAttendanceData[_0x4fbc4e][_0x4ae464(0x1ad)];_0x3218b8=_0x3218b8+0x1;}else _0x2c224f=_0x2c224f+0x1;}var _0x57eff1=parseInt(TotalLeavesorAbsent['length'])+parseInt(_0x2c224f)-parseInt($(_0x4ae464(0x1b7))[_0x4ae464(0x257)]());_0x57eff1<0x0&&(_0x57eff1=0x0);$(_0x4ae464(0x23e))[_0x4ae464(0x257)](Totaldays);var _0x355e5f=parseInt(_0x3218b8)-parseInt(TotalLeavesorAbsent[_0x4ae464(0x1bc)]),_0x126e16=$['grep'](_0x298edd,function(_0x5b76a7){var _0xe4dbcc=_0x4ae464;return _0x5b76a7[_0xe4dbcc(0x227)]!=_0xe4dbcc(0x267)&&_0x5b76a7['AttendanceType']!=_0xe4dbcc(0x20b);});$('#Total-Attendance')['text'](_0x126e16[_0x4ae464(0x1bc)]);},'error':function(_0x4fbb1d,_0x4e785a){var _0x71e14b=_0x8a33d0;console[_0x71e14b(0x1e8)](JSON['stringify'](_0x4fbb1d));}});}