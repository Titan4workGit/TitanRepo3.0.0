var a0_0x42c96c=a0_0x3c08;(function(_0x3e592e,_0xb57848){var _0x5b0e8f=a0_0x3c08,_0x265322=_0x3e592e();while(!![]){try{var _0x5d71c4=parseInt(_0x5b0e8f(0x21f))/0x1+-parseInt(_0x5b0e8f(0x182))/0x2*(-parseInt(_0x5b0e8f(0x1e0))/0x3)+-parseInt(_0x5b0e8f(0x235))/0x4*(parseInt(_0x5b0e8f(0x249))/0x5)+-parseInt(_0x5b0e8f(0x1fe))/0x6+-parseInt(_0x5b0e8f(0x22d))/0x7*(-parseInt(_0x5b0e8f(0x21b))/0x8)+-parseInt(_0x5b0e8f(0x1c4))/0x9+parseInt(_0x5b0e8f(0x21c))/0xa;if(_0x5d71c4===_0xb57848)break;else _0x265322['push'](_0x265322['shift']());}catch(_0x1fce8b){_0x265322['push'](_0x265322['shift']());}}}(a0_0x4bc3,0x35050));var GCompanyId='',GOfficeDays='';$(document)[a0_0x42c96c(0x1b1)](function(){var _0x4a964b=a0_0x42c96c;userActivityNotificationEntry(_spPageContextInfo[_0x4a964b(0x1ac)],window[_0x4a964b(0x220)]),authentication(),GCompanyId=titanForWork['getQueryStringParameter'](_0x4a964b(0x211)),$(_0x4a964b(0x216))[_0x4a964b(0x213)]({'dateFormat':_0x4a964b(0x188),'maxDate':new Date()})[_0x4a964b(0x213)](_0x4a964b(0x203),new Date()),$(_0x4a964b(0x22a))[_0x4a964b(0x213)]({'dateFormat':_0x4a964b(0x188)})['datepicker'](_0x4a964b(0x203),_0x4a964b(0x1e4)),$(_0x4a964b(0x20c))['text'](formatDateReport(ConvertDateTimeFormat($('#attendance-reportFrom')[_0x4a964b(0x1a6)](),'/'))),$(_0x4a964b(0x1f7))[_0x4a964b(0x1a8)](formatDateReport(ConvertDateTimeFormat($(_0x4a964b(0x216))['val'](),'/')));var _0x397007=$(_0x4a964b(0x22a))[_0x4a964b(0x213)](_0x4a964b(0x1d4)),_0x5eaa58=$('#attendance-reportTo')[_0x4a964b(0x213)](_0x4a964b(0x1d4));days=(_0x5eaa58-_0x397007)/(0x3e8*0x3c*0x3c*0x18);var _0x28852f=Math[_0x4a964b(0x1e7)](days);GOfficeDays=Math[_0x4a964b(0x1e7)](days),LoadAllOfficeLocation(),LoadAllDepartment(),LoadAllHolidays(),$('#SelectedLocation')[_0x4a964b(0x1a8)]($(_0x4a964b(0x18c))['text']()),initializePeoplePicker(_0x4a964b(0x1db)),initializePeoplePicker(_0x4a964b(0x1ef)),$(_0x4a964b(0x23b))['modal'](_0x4a964b(0x207));});function a0_0x4bc3(){var _0x3450e8=['values','GetAllUserInfo','ready','format','Jan','#attendencedateValue','&WebAppId=','\x27\x20and\x20AttendanceDate\x20le\x20\x27','May','2nd\x20Half','fadeOut','AttendancDays','__next','OfficeName','it\x20exceeds\x20the\x20list\x20view\x20threshold','concat','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>0</div></td>','getFullYear','<html\x20xmlns:o=\x22urn:schemas-microsoft-com:office:office\x22\x20xmlns:x=\x22urn:schemas-microsoft-com:office:excel\x22\x20xmlns=\x22http://www.w3.org/TR/REC-html40\x22><head><!--[if\x20gte\x20mso\x209]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>','<tr\x20class=\x27text-center\x27>','application/json;odata=verbose','1734408NiqTmY','YYYY-MM-DD','MM/DD/YYYY','tablenav','Rependrecord','data:application/vnd.ms-excel;base64,','<div\x20class=\x27upload-chip\x27>','btoa','log','close','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,ManagerLoginName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,ManagerLoginName,OfficeLocation,Company,Department&$filter=Status\x20eq\x20\x27Active\x27\x20and\x20Company/ID\x20\x20eq\x20\x27','LogonName','#chips','Dec','Apr','indexOf','getDate','evenrow','WorkHours','getTime','push','oddselected','Width','Manager','blue','&end=','attr','filter','286809sxekuF','map','Mar','/_api/web/lists/getbytitle(\x27Departments\x27)/items?select=ID,Title&$filter=CompanyID\x20eq\x20\x27','-7d','Feb','DD/MM/YYYY','round','&start=','AttendanceDate','percentage','done','#TotalItemscount','getQueryStringParameter','split','Employee','sorter','\x27\x20and\x20Holiday_start\x20le\x20\x27','table','SPClientPeoplePicker_InitStandaloneControlWrapper','evenselected','hide','EmpWorkHours','#ToDate','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>00:00</div></td>','red','NotActionDays','User,DL,SecGroup,SPGroup','DepartmentName','floor','1124226ZiDEFx','Error\x20in\x20getFileData.','ModalDialog','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?select=*,ID,Title&$filter=OfficeLocationID\x20eq\x20\x27','empty','setDate','POST','promise','Full\x20Day','show','columns','#FdateTH','/_api/web/lists/GetByTitle(\x27OfficeLocation\x27)/items?$select=ID,OfficeName,CompanyID/ID&$expand=CompanyID&$top=5000&$filter=CompanyID/ID\x20eq\x20\x27','#ReportTable','#FromDate','#ReportTableData>tbody\x20>tr','#HolidaysTH','PrincipalAccountType','</option>','CompanyId','00:00\x20(H:M)','datepicker','when','Key','#attendance-reportTo','\x27\x20and\x20Holiday_start\x20ge\x20\x27','#OfficeLoc','href','Holiday','4064aXXCkJ','2915180vmnTlB','Department','<br\x20/>Please\x20wait!!','113741KCASZK','location','grep','asc','value','#Manager','MaximumEntitySuggestions','responseJSON','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27','#DepartmentDDL','Nov','#attendance-reportFrom','and\x20OfficeLocation\x20eq\x20\x27','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27','4270hUAJoR','#DepartmentDDL\x20option:selected','#monthhyear','#overlaysearch','SPClientPeoplePickerDict','280px','GET','selectedrow','853964dTeRax','#__REQUESTDIGEST','Worksheet','#officeLocTH','children','message','#attendance-report-filter','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>','</div>','<option\x20value=\x22All\x22>All</option>','error','/Pages/Myworkplace.aspx?WebAppId=232SHDFGHJF22B2526DFG','stringify','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>','All','1st\x20Half','appendTo','Reptotalrecords','Oct','Loading...','5kxOFyT','#totalemp','AttendanceItemId','\x27\x20and\x20CompanyID\x20eq\x20\x27','&sourcelocation=../Pages/Report.aspx#','join','/_api/web/ensureuser','formatDate','nodeType','AllowMultipleValues','2aytkcA','Sept','SPClientPeoplePicker','ajax','UserId','</div></td>','dd/mm/yy','getMonth','M\x20\x20yy','ResolvePrincipalSource','#OfficeLoc\x20option:selected','#TotalOfficeDays','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000','#TotalHolidays','length','On\x20Leave','AuthorId','/_api/web/lists/getbytitle(\x27EnvironmentalSettings\x27)/items?$select=Title,Active,ListOfUsers/Title&$filter=Title\x20eq\x20\x27Attendance\x20Entry\x27\x20&$expand=ListOfUsers/Id','replace','oddrow','<option\x20value=\x22','#Employee','Jun','AttendanceType','\x27\x20class=\x27custom-edit-btn\x27><i\x20class=\x27fa\x20fa-chevron-right\x27></i></a></div></td>','append','HrAction','Repcurrentpage','pagedropdown','results','Deferred','.NoRecordFound','webAbsoluteUrl','Title','D,\x20dd','innerHTML','val','#daydate','text','Reptotalpages','userDisplayName','Jul','userId','ReportTableData','ManagerLoginName'];a0_0x4bc3=function(){return _0x3450e8;};return a0_0x4bc3();}function initializePeoplePicker(_0x30c140){var _0x9d6cad=a0_0x42c96c,_0x8dc81c={};_0x8dc81c[_0x9d6cad(0x20f)]=_0x9d6cad(0x1fb),_0x8dc81c['SearchPrincipalSource']=0xf,_0x8dc81c[_0x9d6cad(0x18b)]=0xf,_0x8dc81c[_0x9d6cad(0x181)]=![],_0x8dc81c[_0x9d6cad(0x225)]=0x32,_0x8dc81c[_0x9d6cad(0x1da)]=_0x9d6cad(0x232),this[_0x9d6cad(0x1f3)](_0x30c140,null,_0x8dc81c);}function ensureUser(_0x9755ac){var _0x44b8ff=a0_0x42c96c,_0x1dd2ce=0x0,_0x2ed8a1=_0x9755ac,_0x1bf63d=this['SPClientPeoplePicker'][_0x44b8ff(0x231)][_0x2ed8a1],_0x404afd=_0x1bf63d[_0x44b8ff(0x1b0)](),_0x236e74=_0x404afd[0x0];if(_0x236e74){var _0x66aa2a={'logonName':_0x236e74[_0x44b8ff(0x215)]};$['ajax']({'url':_spPageContextInfo[_0x44b8ff(0x1a2)]+_0x44b8ff(0x17e),'type':_0x44b8ff(0x204),'async':![],'contentType':_0x44b8ff(0x1c3),'data':JSON[_0x44b8ff(0x241)](_0x66aa2a),'headers':{'X-RequestDigest':$(_0x44b8ff(0x236))[_0x44b8ff(0x1a6)](),'accept':'application/json;odata=verbose'},'success':function(_0x5d799d,_0x26bcd4,_0x18d258){_0x1dd2ce=_0x5d799d['d']['Id'];},'error':function(_0x1b6918,_0x2b5b85,_0x4d48a6){}});}else _0x1dd2ce=0x0;return _0x1dd2ce;}function GetUserTitle(_0x356ed0){var _0x4d88e8=a0_0x42c96c,_0x42fef9=0x0,_0x5c93d7=_0x356ed0,_0x62a0b=this[_0x4d88e8(0x184)][_0x4d88e8(0x231)][_0x5c93d7],_0x473323=_0x62a0b[_0x4d88e8(0x1b0)](),_0x312dbe=_0x473323[0x0];if(_0x312dbe){var _0x3cc137={'logonName':_0x312dbe['Key']};$[_0x4d88e8(0x185)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x4d88e8(0x17e),'type':_0x4d88e8(0x204),'async':![],'contentType':'application/json;odata=verbose','data':JSON[_0x4d88e8(0x241)](_0x3cc137),'headers':{'X-RequestDigest':$(_0x4d88e8(0x236))[_0x4d88e8(0x1a6)](),'accept':'application/json;odata=verbose'},'success':function(_0x39f98c,_0xb9a3b9,_0x3d48f4){_0x42fef9=_0x39f98c['d']['Title'];},'error':function(_0x3fcead,_0x2f75c1,_0x3591bb){}});}else _0x42fef9=0x0;return _0x42fef9;}function ConvertDateTimeFormat(_0x1fac9e,_0xd01b61){var _0x2d0289=a0_0x42c96c;return _0x1fac9e[_0x2d0289(0x1ee)](_0xd01b61)[0x1]+''+_0xd01b61+''+_0x1fac9e['split'](_0xd01b61)[0x0]+''+_0xd01b61+''+_0x1fac9e['split'](_0xd01b61)[0x2];}function formatDateReport(_0x599f91){var _0x2ec30c=a0_0x42c96c,_0x1bed78=new Date(_0x599f91);if(isNaN(_0x1bed78[_0x2ec30c(0x1d7)]()))return _0x599f91;else{var _0x66042f=new Array();return _0x66042f[0x0]=_0x2ec30c(0x1b3),_0x66042f[0x1]=_0x2ec30c(0x1e5),_0x66042f[0x2]=_0x2ec30c(0x1e2),_0x66042f[0x3]=_0x2ec30c(0x1d2),_0x66042f[0x4]=_0x2ec30c(0x1b7),_0x66042f[0x5]=_0x2ec30c(0x198),_0x66042f[0x6]=_0x2ec30c(0x1ab),_0x66042f[0x7]='Aug',_0x66042f[0x8]=_0x2ec30c(0x183),_0x66042f[0x9]=_0x2ec30c(0x247),_0x66042f[0xa]=_0x2ec30c(0x229),_0x66042f[0xb]=_0x2ec30c(0x1d1),day=_0x1bed78[_0x2ec30c(0x1d4)](),day<0xa&&(day='0'+day),day+'\x20'+_0x66042f[_0x1bed78['getMonth']()]+'\x20'+_0x1bed78[_0x2ec30c(0x1c0)]();}}function LoadAllOfficeLocation(){var _0x1027c5=a0_0x42c96c;$('#OfficeLoc')[_0x1027c5(0x202)]();var _0x5c62ac=_spPageContextInfo[_0x1027c5(0x1a2)]+_0x1027c5(0x20a)+GCompanyId+'\x27&$orderby=OfficeName\x20asc';$['ajax']({'url':_0x5c62ac,'headers':{'Accept':_0x1027c5(0x1c3)},'async':![],'success':function(_0x40671f){var _0x252853=_0x1027c5;for(var _0x31b7e4=0x0;_0x31b7e4<_0x40671f['d'][_0x252853(0x19f)][_0x252853(0x190)];_0x31b7e4++){$(_0x252853(0x218))['append'](_0x252853(0x196)+_0x40671f['d'][_0x252853(0x19f)][_0x31b7e4]['ID']+'\x22>'+_0x40671f['d'][_0x252853(0x19f)][_0x31b7e4][_0x252853(0x1bc)]+_0x252853(0x210));}},'myError':function(_0x60d9ad){}});}function LoadAllDepartment(){var _0x365cac=a0_0x42c96c;$('#DepartmentDDL')[_0x365cac(0x202)]();var _0x29996a=_spPageContextInfo['webAbsoluteUrl']+_0x365cac(0x1e3)+GCompanyId+'\x27&$orderby=Title\x20asc&$top=5000';$[_0x365cac(0x185)]({'url':_0x29996a,'headers':{'Accept':_0x365cac(0x1c3)},'async':!![],'success':function(_0xf5c849){var _0x50c0e4=_0x365cac;$(_0x50c0e4(0x23e))[_0x50c0e4(0x245)](_0x50c0e4(0x228));for(var _0x59b5aa=0x0;_0x59b5aa<_0xf5c849['d'][_0x50c0e4(0x19f)][_0x50c0e4(0x190)];_0x59b5aa++){$(_0x50c0e4(0x228))[_0x50c0e4(0x19b)](_0x50c0e4(0x196)+_0xf5c849['d'][_0x50c0e4(0x19f)][_0x59b5aa]['ID']+'\x22>'+_0xf5c849['d'][_0x50c0e4(0x19f)][_0x59b5aa][_0x50c0e4(0x1a3)]+_0x50c0e4(0x210));}},'myError':function(_0x596c90){}});}var TotalOfficeDays=0x0,GtotalHolidays=0x0;function LoadAllHolidays(){var _0x12d367=a0_0x42c96c,_0x330062=$(_0x12d367(0x218))['val']();TotalOfficeDays=0x0,GtotalHolidays=0x0;var _0x529724=new Date(ConvertDateTimeFormat($(_0x12d367(0x22a))[_0x12d367(0x1a6)](),'/')),_0x1d58a9=_0x529724[_0x12d367(0x1c0)]()+'-'+(_0x529724[_0x12d367(0x189)]()+0x1)+'-'+_0x529724[_0x12d367(0x1d4)](),_0x1a9dfc=new Date(ConvertDateTimeFormat($(_0x12d367(0x216))['val'](),'/')),_0x41671e=_0x1a9dfc[_0x12d367(0x1c0)]()+'-'+(_0x1a9dfc[_0x12d367(0x189)]()+0x1)+'-'+_0x1a9dfc[_0x12d367(0x1d4)](),_0x32d94a=_spPageContextInfo[_0x12d367(0x1a2)]+_0x12d367(0x201)+_0x330062+_0x12d367(0x17b)+GCompanyId+_0x12d367(0x217)+_0x1d58a9+_0x12d367(0x1f1)+_0x41671e+'\x27';$[_0x12d367(0x185)]({'url':_0x32d94a,'headers':{'Accept':_0x12d367(0x1c3)},'async':![],'success':function(_0x30ea21){var _0x3d92ee=_0x12d367,_0x5305e6=_0x30ea21['d'][_0x3d92ee(0x19f)][_0x3d92ee(0x190)];GtotalHolidays=_0x5305e6,$(_0x3d92ee(0x18f))['text'](_0x5305e6),$(_0x3d92ee(0x18d))[_0x3d92ee(0x1a8)](parseInt(GOfficeDays)-parseInt(_0x5305e6)),TotalOfficeDays=parseInt(GOfficeDays)-parseInt(_0x5305e6);},'myError':function(_0x333d9d){}});}function Applyfilter(){var _0x33278b=a0_0x42c96c;$(_0x33278b(0x20c))[_0x33278b(0x1a8)](formatDateReport(ConvertDateTimeFormat($('#attendance-reportFrom')[_0x33278b(0x1a6)](),'/'))),$('#ToDate')[_0x33278b(0x1a8)](formatDateReport(ConvertDateTimeFormat($(_0x33278b(0x216))[_0x33278b(0x1a6)](),'/'))),$('#SelectedLocation')['text']($('#OfficeLoc\x20option:selected')[_0x33278b(0x1a8)]()),$(_0x33278b(0x209))[_0x33278b(0x1a8)](formatDateReport(ConvertDateTimeFormat($(_0x33278b(0x22a))[_0x33278b(0x1a6)](),'/'))),$('#EdateTH')[_0x33278b(0x1a8)](formatDateReport(ConvertDateTimeFormat($(_0x33278b(0x216))['val'](),'/'))),$(_0x33278b(0x238))['text']($(_0x33278b(0x18c))[_0x33278b(0x1a8)]()),$('#TotalWorkdayTH')[_0x33278b(0x1a8)](TotalOfficeDays),$(_0x33278b(0x20e))['text'](GtotalHolidays);var _0x31be4f=$(_0x33278b(0x22a))[_0x33278b(0x213)](_0x33278b(0x1d4)),_0xddb0c5=$(_0x33278b(0x216))[_0x33278b(0x213)](_0x33278b(0x1d4));days=(_0xddb0c5-_0x31be4f)/(0x3e8*0x3c*0x3c*0x18),GOfficeDays=Math[_0x33278b(0x1e7)](days)+0x1,LoadAllHolidays(),$(_0x33278b(0x1b4))[_0x33278b(0x1a6)]('');var _0x59baf9=$(_0x33278b(0x22a))[_0x33278b(0x1a6)](),_0xca72db=moment($('#attendance-reportFrom')[_0x33278b(0x1a6)](),'DD/MM/YYYY')[_0x33278b(0x1b2)](_0x33278b(0x1c5)),_0x2fb07c=moment($(_0x33278b(0x216))[_0x33278b(0x1a6)](),_0x33278b(0x1e6))['format'](_0x33278b(0x1c5));$(_0x33278b(0x1a7))[_0x33278b(0x1a8)]($[_0x33278b(0x213)][_0x33278b(0x17f)](_0x33278b(0x1a4),new Date(_0xca72db))),$(_0x33278b(0x22f))[_0x33278b(0x1a8)]($[_0x33278b(0x213)]['formatDate'](_0x33278b(0x18a),new Date(_0xca72db)));var _0xd9fdf0='',_0x52b70e='';$(_0x33278b(0x218))[_0x33278b(0x1a6)]()!=_0x33278b(0x243)&&(_0xd9fdf0+=_0x33278b(0x22b)+$(_0x33278b(0x218))[_0x33278b(0x1a6)]()+'\x27\x20',_0x52b70e+=_0x33278b(0x1ca)+$('#OfficeLoc\x20option:selected')[_0x33278b(0x1a8)]()+_0x33278b(0x23d));$('#DepartmentDDL')[_0x33278b(0x1a6)]()!=_0x33278b(0x243)&&(_0xd9fdf0+='and\x20Department\x20eq\x20\x27'+$('#DepartmentDDL')[_0x33278b(0x1a6)]()+'\x27\x20',_0x52b70e+=_0x33278b(0x1ca)+$(_0x33278b(0x22e))[_0x33278b(0x1a8)]()+_0x33278b(0x23d));var _0x41f600=ensureUser($('#Manager')['children']()[_0x33278b(0x239)]()[_0x33278b(0x1de)]('id')),_0x1b363b=ensureUser($(_0x33278b(0x197))[_0x33278b(0x239)]()['children']()[_0x33278b(0x1de)]('id'));_0x41f600!=0x0&&(_0xd9fdf0+='and\x20ManagerLoginName\x20eq\x20\x27'+_0x41f600+'\x27\x20',_0x52b70e+=_0x33278b(0x1ca)+GetUserTitle($(_0x33278b(0x224))[_0x33278b(0x239)]()[_0x33278b(0x239)]()[_0x33278b(0x1de)]('id'))+'</div>'),_0x1b363b!=0x0&&(_0xd9fdf0+='and\x20LogonName/ID\x20eq\x20\x27'+_0x1b363b+'\x27\x20',_0x52b70e+=_0x33278b(0x1ca)+GetUserTitle($(_0x33278b(0x197))[_0x33278b(0x239)]()[_0x33278b(0x239)]()[_0x33278b(0x1de)]('id'))+'</div>'),$('#chips')[_0x33278b(0x202)](),$(_0x33278b(0x1d0))[_0x33278b(0x19b)](_0x52b70e),$(_0x33278b(0x230))['fadeIn'](),setTimeout(function(){var _0x148864=_0x33278b,_0x2d2ddd=_spPageContextInfo[_0x148864(0x1a2)]+_0x148864(0x22c)+_0xca72db+'\x27\x20and\x20AttendanceDate\x20le\x20\x27'+_0x2fb07c+'\x27\x20';$[_0x148864(0x214)](getFileData(_0x2d2ddd))[_0x148864(0x1eb)](function(_0x3c64f7){var _0x44aa64=_0x148864,_0x2a7c74=_spPageContextInfo['webAbsoluteUrl']+_0x44aa64(0x1ce)+GCompanyId+'\x27'+_0xd9fdf0;EmployeeListDat(_0x2a7c74),$(_0x44aa64(0x230))[_0x44aa64(0x1b9)]();});},0x5dc);}var TempStore=[],unique='';function getFileData(_0x461ef8){jQuery['ajax']({'url':_0x461ef8,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x389222){var _0x2eaf5a=a0_0x3c08;EmpAttendanceData=[];var _0x851dc4=_0x389222['d'][_0x2eaf5a(0x19f)];if(_0x851dc4[_0x2eaf5a(0x190)]>0x0){TempStore=[];for(var _0xe0bf1e=0x0;_0xe0bf1e<_0x851dc4[_0x2eaf5a(0x190)];_0xe0bf1e++){TempStore[_0x2eaf5a(0x1d8)](_0x851dc4[_0xe0bf1e][_0x2eaf5a(0x1ef)]['ID']);}unique=TempStore[_0x2eaf5a(0x1df)](function(_0x31f832,_0x32edfc,_0x596e7e){return _0x32edfc==_0x596e7e['indexOf'](_0x31f832);});if(unique[_0x2eaf5a(0x190)]>0x0){EmpAttendanceData=[];for(var _0x1f2817=0x0;_0x1f2817<unique[_0x2eaf5a(0x190)];_0x1f2817++){var _0x7453a7=0x0,_0x12f099=[],_0x598151=[],_0x3b6992=moment($(_0x2eaf5a(0x22a))['val'](),_0x2eaf5a(0x1e6))[_0x2eaf5a(0x1b2)](_0x2eaf5a(0x1c5)),_0x42559c=moment($('#attendance-reportTo')[_0x2eaf5a(0x1a6)](),'DD/MM/YYYY')[_0x2eaf5a(0x1b2)](_0x2eaf5a(0x1c5)),_0x3ee0c2=unique[_0x1f2817],_0x3af1a1=_spPageContextInfo[_0x2eaf5a(0x1a2)]+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27'+_0x3b6992+_0x2eaf5a(0x1b6)+_0x42559c+'\x27\x20and\x20Employee\x20eq\x20\x27'+_0x3ee0c2+'\x27\x20';jQuery[_0x2eaf5a(0x185)]({'url':_0x3af1a1,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x109103){var _0x4b62fa=_0x2eaf5a,_0x39c0bd=_0x109103['d'][_0x4b62fa(0x19f)];if(_0x39c0bd[_0x4b62fa(0x190)]>0x0){for(var _0x4b75d5=0x0;_0x4b75d5<_0x39c0bd[_0x4b62fa(0x190)];_0x4b75d5++){var _0x38f649=_0x39c0bd[_0x4b75d5]['ID'],_0x84f83c=_0x39c0bd[_0x4b75d5][_0x4b62fa(0x1ef)][_0x4b62fa(0x1a3)],_0xc095a8=_0x39c0bd[_0x4b75d5][_0x4b62fa(0x1ef)]['ID'],_0x320feb=_0x39c0bd[_0x4b75d5][_0x4b62fa(0x1e9)],_0x2ba0a9=_0x39c0bd[_0x4b75d5][_0x4b62fa(0x199)];if(_0x2ba0a9==_0x4b62fa(0x206)||_0x2ba0a9==_0x4b62fa(0x244)||_0x2ba0a9==_0x4b62fa(0x1b8))_0x12f099[_0x4b62fa(0x1d8)](_0x2ba0a9);else _0x2ba0a9==_0x4b62fa(0x191)&&_0x598151[_0x4b62fa(0x1d8)](_0x2ba0a9);_0x39c0bd[_0x4b75d5][_0x4b62fa(0x1d6)]!=null&&(_0x7453a7=parseInt(_0x7453a7)+parseInt(_0x39c0bd[_0x4b75d5]['WorkHours']));var _0x181644=_0x39c0bd[_0x4b75d5]['HrAction'],_0x17ce35=parseInt(_0x12f099[_0x4b62fa(0x190)])+parseInt(_0x598151['length']),_0x4a4bbc=parseInt(TotalOfficeDays)-parseInt(_0x17ce35);_0x4a4bbc<0x0&&(_0x4a4bbc=0x0);}var _0x3ceb37=Math['round'](parseInt(_0x17ce35)/parseInt(TotalOfficeDays)*0x64)+'%';TotalOfficeDays=='0'&&(_0x3ceb37='-'),EmpAttendanceData[_0x4b62fa(0x1d8)]({'UserId':_0xc095a8,'EmpName':_0x84f83c,'AttendanceDate':_0x320feb,'AttendanceType':_0x2ba0a9,'AttendanceItemId':_0x38f649,'EmpWorkHours':_0x7453a7,'HrAction':_0x181644,'AttendancDays':_0x12f099['length'],'LeavesDay':_0x598151[_0x4b62fa(0x190)],'NotActionDays':_0x4a4bbc,'percentage':_0x3ceb37});}},'error':function(_0x25e4ec,_0x5807a7){console['log'](JSON['stringify'](_0x25e4ec));}});}}}},'error':function(_0x4730ec,_0x39ded9,_0x451902){var _0x4edbc5=a0_0x3c08;console[_0x4edbc5(0x1cc)](_0x4edbc5(0x1ff)),console[_0x4edbc5(0x1cc)](_0x4730ec[_0x4edbc5(0x226)][_0x4edbc5(0x23f)][_0x4edbc5(0x23a)][_0x4edbc5(0x223)]);var _0xd670f6=_0x4730ec[_0x4edbc5(0x226)][_0x4edbc5(0x23f)][_0x4edbc5(0x23a)]['value'],_0xcc4de0=_0xd670f6['includes'](_0x4edbc5(0x1bd));_0xcc4de0==!![]&&(AttendanceReportUsageData=[],AttendanceReportUsageUrl=_spPageContextInfo[_0x4edbc5(0x1a2)]+_0x4edbc5(0x18e),ReadEmpReportUsageData());}});}var AttendanceReportUsageData=AttendanceReportUsageData||[],AttendanceReportUsageUrl='';function ReadEmpReportUsageData(){var _0x268d4c=a0_0x42c96c;return dfds=$[_0x268d4c(0x1a0)](),$[_0x268d4c(0x185)]({'url':AttendanceReportUsageUrl,'headers':{'Accept':_0x268d4c(0x1c3)},'async':![],'success':function(_0xe11a01){var _0x4ebea3=_0x268d4c;FilterState=0x0,AttendanceReportUsageData=AttendanceReportUsageData[_0x4ebea3(0x1be)](_0xe11a01['d']['results']);if(_0xe11a01['d'][_0x4ebea3(0x1bb)])AttendanceReportUsageUrl=_0xe11a01['d'][_0x4ebea3(0x1bb)],ReadEmpReportUsageData();else{if(AttendanceReportUsageData['length']>0x0){var _0x58d339=moment(ConvertDateTimeFormat($(_0x4ebea3(0x22a))[_0x4ebea3(0x1a6)](),'/'))[_0x4ebea3(0x1b2)](_0x4ebea3(0x1c6)),_0x32c543=moment(ConvertDateTimeFormat($('#attendance-reportTo')['val'](),'/'))[_0x4ebea3(0x1b2)](_0x4ebea3(0x1c6)),_0x57f577=AttendanceReportUsageData[_0x4ebea3(0x1df)](function(_0x363bc1){var _0x3926be=_0x4ebea3;return Created=moment(_0x363bc1['AttendanceDate'])['format'](_0x3926be(0x1c6)),(_0x58d339==''?Created!='':Created>=_0x58d339)&&(_0x32c543==''?Created!='':Created<=_0x32c543);});AttendanceReportUsageData=_0x57f577;var _0x1276e3=[...new Map(AttendanceReportUsageData[_0x4ebea3(0x1e1)](_0x1a7879=>[_0x1a7879[_0x4ebea3(0x192)],_0x1a7879]))[_0x4ebea3(0x1af)]()];TempStore=[];for(var _0x1ac7fc=0x0;_0x1ac7fc<AttendanceReportUsageData[_0x4ebea3(0x190)];_0x1ac7fc++){TempStore[_0x4ebea3(0x1d8)](AttendanceReportUsageData[_0x1ac7fc]['Employee']['ID']);}unique=TempStore[_0x4ebea3(0x1df)](function(_0x5a4947,_0x419491,_0x476dee){var _0x2b5fde=_0x4ebea3;return _0x419491==_0x476dee[_0x2b5fde(0x1d3)](_0x5a4947);});if(unique[_0x4ebea3(0x190)]>0x0){EmpAttendanceData=[];for(var _0xfa60da=0x0;_0xfa60da<unique['length'];_0xfa60da++){var _0x442a4e=0x0,_0x41c37b=[],_0xac83c0=[],_0x21822c=moment($(_0x4ebea3(0x22a))['val'](),_0x4ebea3(0x1e6))[_0x4ebea3(0x1b2)](_0x4ebea3(0x1c5)),_0x160be0=moment($(_0x4ebea3(0x216))[_0x4ebea3(0x1a6)](),_0x4ebea3(0x1e6))[_0x4ebea3(0x1b2)](_0x4ebea3(0x1c5)),_0x5862f3=unique[_0xfa60da],_0x20962c=$[_0x4ebea3(0x221)](AttendanceReportUsageData,function(_0x4ec44d){var _0xdb7580=_0x4ebea3;return _0x4ec44d[_0xdb7580(0x1ef)]['ID']==_0x5862f3;}),_0xbee516=_0x20962c;if(_0xbee516[_0x4ebea3(0x190)]>0x0){for(var _0x3fac81=0x0;_0x3fac81<_0xbee516[_0x4ebea3(0x190)];_0x3fac81++){var _0x1e1320=_0xbee516[_0x3fac81]['ID'],_0x477520=_0xbee516[_0x3fac81][_0x4ebea3(0x1ef)]['Title'],_0x128df6=_0xbee516[_0x3fac81][_0x4ebea3(0x1ef)]['ID'],_0x5311c1=_0xbee516[_0x3fac81][_0x4ebea3(0x1e9)],_0x488ea5=_0xbee516[_0x3fac81][_0x4ebea3(0x199)];if(_0x488ea5==_0x4ebea3(0x206)||_0x488ea5==_0x4ebea3(0x244)||_0x488ea5=='2nd\x20Half')_0x41c37b[_0x4ebea3(0x1d8)](_0x488ea5);else _0x488ea5==_0x4ebea3(0x191)&&_0xac83c0['push'](_0x488ea5);_0xbee516[_0x3fac81][_0x4ebea3(0x1d6)]!=null&&(_0x442a4e=parseInt(_0x442a4e)+parseInt(_0xbee516[_0x3fac81][_0x4ebea3(0x1d6)]));var _0x4963ca=_0xbee516[_0x3fac81]['HrAction'],_0x4b56b0=parseInt(_0x41c37b[_0x4ebea3(0x190)])+parseInt(_0xac83c0[_0x4ebea3(0x190)]),_0x482826=parseInt(TotalOfficeDays)-parseInt(_0x4b56b0);_0x482826<0x0&&(_0x482826=0x0);}var _0xb3a8ba=Math[_0x4ebea3(0x1e7)](parseInt(_0x4b56b0)/parseInt(TotalOfficeDays)*0x64)+'%';TotalOfficeDays=='0'&&(_0xb3a8ba='-'),EmpAttendanceData[_0x4ebea3(0x1d8)]({'UserId':_0x128df6,'EmpName':_0x477520,'AttendanceDate':_0x5311c1,'AttendanceType':_0x488ea5,'AttendanceItemId':_0x1e1320,'EmpWorkHours':_0x442a4e,'HrAction':_0x4963ca,'AttendancDays':_0x41c37b[_0x4ebea3(0x190)],'LeavesDay':_0xac83c0['length'],'NotActionDays':_0x482826,'percentage':_0xb3a8ba});}}}}}},'error':function(_0x4e9bf1,_0x23f3d5,_0x1814a7){}}),dfds[_0x268d4c(0x205)]();}function OpenMyCustomLoader(){var _0x1ce993=a0_0x42c96c,_0x20ceeb=_0x1ce993(0x248),_0x4d54f7=_0x1ce993(0x21e),_0x32c3d4=0xc8,_0x22d876=0x190;currentDlg=SP['UI'][_0x1ce993(0x200)]['showWaitScreenWithNoClose'](_0x20ceeb,_0x4d54f7,_0x32c3d4,_0x22d876);}function CloseMyCustomLoader(){var _0x2f9697=a0_0x42c96c;currentDlg[_0x2f9697(0x1cd)]();}function EmployeeListDat(_0x369e03){var _0xccfdf5=a0_0x42c96c;$[_0xccfdf5(0x185)]({'url':_0x369e03,'headers':{'Accept':_0xccfdf5(0x1c3)},'async':![],'success':function(_0x496b21){var _0x417441=_0xccfdf5,_0x3d50e4=_0x496b21['d']['results'];$('#ReportTable')[_0x417441(0x202)]();var _0x31180b='';if(_0x3d50e4[_0x417441(0x190)]>0x0){var _0x806daa=0x0,_0x58e19c=0x0,_0x57d956=0x0;for(var _0x1574a6=0x0;_0x1574a6<_0x3d50e4[_0x417441(0x190)];_0x1574a6++){var _0x53eaf2=_0x3d50e4[_0x1574a6]['ID'],_0x19f0c6=_0x3d50e4[_0x1574a6][_0x417441(0x1cf)]['ID'],_0xb8bbe7=_0x3d50e4[_0x1574a6]['LogonName']['Title'],_0x5c1fc1=_0x3d50e4[_0x1574a6]['Designation'],_0x91e452=_0x3d50e4[_0x1574a6][_0x417441(0x21d)][_0x417441(0x1fc)],_0x23ada6=_0x3d50e4[_0x1574a6][_0x417441(0x1ae)][_0x417441(0x1a3)];_0x23ada6==undefined&&(_0x23ada6='');var _0xe24791=_0x417441(0x212),_0x9ce698='',_0x558a01='black';_0x5c1fc1==null&&(_0x5c1fc1='');var _0x51f5ec=_0x3d50e4[_0x1574a6]['OfficeLocation'][_0x417441(0x1bc)];_0x51f5ec==null&&(_0x51f5ec='');EmployeeId=_0x3d50e4[_0x1574a6][_0x417441(0x1cf)]['ID'];var _0x35638c=moment($(_0x417441(0x22a))[_0x417441(0x1a6)](),'DD/MM/YYYY')[_0x417441(0x1b2)](_0x417441(0x1c5)),_0x109736=moment($('#attendance-reportTo')[_0x417441(0x1a6)](),'DD/MM/YYYY')[_0x417441(0x1b2)](_0x417441(0x1c5)),_0x35638c=_0x35638c[_0x417441(0x1ee)]('-')[_0x417441(0x17d)](''),_0x109736=_0x109736['split']('-')[_0x417441(0x17d)](''),_0xeb2f3d=_spPageContextInfo['webServerRelativeUrl']+'/Pages/EmployeeReport.aspx?EID='+_0x19f0c6+_0x417441(0x1e8)+_0x35638c+_0x417441(0x1dd)+_0x109736+_0x417441(0x1b5)+titanForWork[_0x417441(0x1ed)](_0x417441(0x211))+_0x417441(0x17c),_0x42af7e=EmpAttendanceData[_0x417441(0x1e1)](function(_0xa4931){var _0x3340b7=_0x417441;return _0xa4931[_0x3340b7(0x186)];})[_0x417441(0x1d3)](EmployeeId);if(_0x42af7e!=-0x1){var _0x75acda=EmpAttendanceData[_0x42af7e]['UserId'],_0x5ddbdc=EmpAttendanceData[_0x42af7e]['AttendanceType'],_0x4b2362=EmpAttendanceData[_0x42af7e][_0x417441(0x24b)];_0xe24791=EmpAttendanceData[_0x42af7e][_0x417441(0x1f6)];var _0x3d7fdd=EmpAttendanceData[_0x42af7e][_0x417441(0x1f6)];_0x9ce698=EmpAttendanceData[_0x42af7e][_0x417441(0x24b)];var _0x3b5953=EmpAttendanceData[_0x42af7e][_0x417441(0x1ba)],_0x12fc9a=EmpAttendanceData[_0x42af7e]['LeavesDay'],_0x1c0374=EmpAttendanceData[_0x42af7e][_0x417441(0x1fa)],_0x27f1a2=EmpAttendanceData[_0x42af7e][_0x417441(0x1ea)],_0x30d027='';EmpAttendanceData[_0x42af7e][_0x417441(0x19c)]==!![]?_0x30d027='checked':_0x30d027='',_0xe24791==null&&(_0xe24791=_0x417441(0x212)),_0x5ddbdc==_0x417441(0x191)&&(_0x558a01=_0x417441(0x1f9),_0x57d956++),_0x5ddbdc==_0x417441(0x21a)&&(_0x558a01=_0x417441(0x1dc)),_0x31180b+='<tr\x20class=\x27text-center\x27>',_0x31180b+=_0x417441(0x23c)+_0xb8bbe7+_0x417441(0x187),_0x31180b+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x5c1fc1+_0x417441(0x187),_0x31180b+=_0x417441(0x242)+_0x91e452+_0x417441(0x187),_0x31180b+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x23ada6+_0x417441(0x187),_0x31180b+=_0x417441(0x242)+_0x3b5953+_0x417441(0x187),_0x31180b+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x1c0374+_0x417441(0x187),_0x31180b+=_0x417441(0x242)+_0x12fc9a+_0x417441(0x187),_0x31180b+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+ConvertHHMM(_0xe24791)+_0x417441(0x187),_0x31180b+=_0x417441(0x242)+_0x27f1a2+'</div></td>',_0x31180b+=_0x417441(0x227)+_0xeb2f3d+_0x417441(0x19a),_0x31180b+='</tr>';}else _0x31180b+=_0x417441(0x1c2),_0x31180b+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0xb8bbe7+_0x417441(0x187),_0x31180b+=_0x417441(0x23c)+_0x5c1fc1+_0x417441(0x187),_0x31180b+=_0x417441(0x242)+_0x91e452+_0x417441(0x187),_0x31180b+=_0x417441(0x23c)+_0x23ada6+'</div></td>',_0x31180b+=_0x417441(0x1bf),_0x31180b+=_0x417441(0x242)+TotalOfficeDays+'</div></td>',_0x31180b+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>0</div></td>',_0x31180b+=_0x417441(0x1f8),_0x31180b+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>-</div></td>',_0x31180b+=_0x417441(0x227)+_0xeb2f3d+_0x417441(0x19a),_0x31180b+='</tr>';}}else{}_0x3d50e4[_0x417441(0x190)]==0x0?$(_0x417441(0x1a1))['show']():$('.NoRecordFound')[_0x417441(0x1f5)]();$(_0x417441(0x20b))['append'](_0x31180b);var _0x4fb148=$(_0x417441(0x20d))[_0x417441(0x190)];$(_0x417441(0x1ec))[_0x417441(0x1a8)](_0x4fb148),$(_0x417441(0x24a))[_0x417441(0x1a8)](_0x4fb148),_0x4fb148>0x0&&ReportTableConfiguration();},'error':function(_0x1c7e56){var _0x2200a6=_0xccfdf5;console[_0x2200a6(0x1cc)](_0x1c7e56);}});}function a0_0x3c08(_0x53ad84,_0x2c180d){var _0x4bc3e1=a0_0x4bc3();return a0_0x3c08=function(_0x3c08e1,_0x13f6e3){_0x3c08e1=_0x3c08e1-0x17b;var _0x2d76f9=_0x4bc3e1[_0x3c08e1];return _0x2d76f9;},a0_0x3c08(_0x53ad84,_0x2c180d);}function ReportTableConfiguration(){var _0x3a1081=a0_0x42c96c;sorter=new TINY[(_0x3a1081(0x1f2))][(_0x3a1081(0x1f0))](_0x3a1081(0x1f0),_0x3a1081(0x1ad),{'ascclass':_0x3a1081(0x222),'descclass':'desc','evenclass':_0x3a1081(0x1d5),'oddclass':_0x3a1081(0x195),'evenselclass':_0x3a1081(0x1f4),'oddselclass':_0x3a1081(0x1d9),'paginate':!![],'size':0xa,'colddid':_0x3a1081(0x208),'currentid':_0x3a1081(0x19d),'totalid':_0x3a1081(0x1a9),'startingrecid':'Repstartrecord','endingrecid':_0x3a1081(0x1c8),'totalrecid':_0x3a1081(0x246),'hoverid':_0x3a1081(0x234),'pageddid':_0x3a1081(0x19e),'navid':_0x3a1081(0x1c7),'sortdir':0x1,'init':!![]});}function ConvertHHMM(_0x425dd4){var _0x2f60dc=a0_0x42c96c,_0x2c4570=Math[_0x2f60dc(0x1fd)](_0x425dd4/0x3c),_0x14227a=_0x425dd4%0x3c;_0x2c4570<0xa&&(_0x2c4570='0'+_0x2c4570);_0x14227a<0xa&&(_0x14227a='0'+_0x14227a);var _0x5c4d32=_0x2c4570+':'+_0x14227a;return _0x5c4d32;}function CloseModel(){var _0x115f58=a0_0x42c96c;initializePeoplePicker(_0x115f58(0x1db)),initializePeoplePicker('Employee');}var tableToExcel=(function(){var _0x3ef865=a0_0x42c96c,_0x5a62de=_0x3ef865(0x1c9),_0x172ac4=_0x3ef865(0x1c1),_0x36eddc=function(_0x4ba902){var _0x1c3ac8=_0x3ef865;return window[_0x1c3ac8(0x1cb)](unescape(encodeURIComponent(_0x4ba902)));},_0x1de3dd=function(_0x46f5ac,_0x3cb2be){var _0x1f718c=_0x3ef865;return _0x46f5ac[_0x1f718c(0x194)](/{(\w+)}/g,function(_0x59b875,_0x49f72d){return _0x3cb2be[_0x49f72d];});};return function(_0x5b2ea9,_0x1c3c66){var _0x58570a=_0x3ef865;if(!_0x5b2ea9[_0x58570a(0x180)])_0x5b2ea9=document['getElementById'](_0x5b2ea9);var _0x4e54c1={'worksheet':_0x1c3c66||_0x58570a(0x237),'table':_0x5b2ea9[_0x58570a(0x1a5)]};window[_0x58570a(0x220)][_0x58570a(0x219)]=_0x5a62de+_0x36eddc(_0x1de3dd(_0x172ac4,_0x4e54c1));};}()),authentication=function(){var _0x8a2ed9=a0_0x42c96c,_0x44d20f=_spPageContextInfo[_0x8a2ed9(0x1aa)],_0x3110fa=_spPageContextInfo[_0x8a2ed9(0x1a2)]+_0x8a2ed9(0x193);$['ajax']({'url':_0x3110fa,'async':![],'type':_0x8a2ed9(0x233),'headers':{'accept':'application/json;\x20odata=verbose'},'success':function(_0x22cd0b){var _0x4b1322=_0x8a2ed9;debugger;var _0x13fadf=_0x22cd0b['d']['results'];if(_0x13fadf['length']>0x0)for(var _0x2a0b5a=0x0;_0x2a0b5a<_0x13fadf['length'];_0x2a0b5a++){if(_0x13fadf[_0x2a0b5a]['Title']=='Attendance\x20Entry'){if(_0x13fadf[_0x2a0b5a]['Active']==![])return alert('This\x20feature\x20has\x20been\x20deactivated\x20!'),window[_0x4b1322(0x220)]=_spPageContextInfo[_0x4b1322(0x1a2)]+_0x4b1322(0x240),![];}}},'error':function(_0x1ae94f){var _0x3fc472=_0x8a2ed9;alert(JSON[_0x3fc472(0x241)](_0x1ae94f));}});};