var a0_0x12a6b4=a0_0x3b66;(function(_0x1a4526,_0x244b7d){var _0xd11b9f=a0_0x3b66,_0x41a49b=_0x1a4526();while(!![]){try{var _0x234eb6=-parseInt(_0xd11b9f(0x148))/0x1*(parseInt(_0xd11b9f(0xef))/0x2)+parseInt(_0xd11b9f(0x1fe))/0x3*(-parseInt(_0xd11b9f(0x156))/0x4)+-parseInt(_0xd11b9f(0x199))/0x5*(-parseInt(_0xd11b9f(0x106))/0x6)+-parseInt(_0xd11b9f(0xf0))/0x7+parseInt(_0xd11b9f(0x10a))/0x8*(-parseInt(_0xd11b9f(0x1c9))/0x9)+-parseInt(_0xd11b9f(0x149))/0xa*(-parseInt(_0xd11b9f(0x159))/0xb)+parseInt(_0xd11b9f(0x1a5))/0xc;if(_0x234eb6===_0x244b7d)break;else _0x41a49b['push'](_0x41a49b['shift']());}catch(_0x43c7b5){_0x41a49b['push'](_0x41a49b['shift']());}}}(a0_0x184d,0xce818));var token,ClientId='',ClentSecret='',ClientUrl='',DeferredObj=$[a0_0x12a6b4(0x118)](),color_red='',Error=0x0,Ready=0x0,Exits=0x0,lblUpdate=0x0,ErrorUser='',alluserdata,contributersGroupId='',counusers=0x0,excelRows,AllCompanies,AllDepartments,AllOfficeLocation,tabledata,pageIndex,UserEmailId,warningmessage='',userfullname='',AvilableLicenses,ReadySelected=[],MiisingSelected=[],AddedEmployeeList=[],IsMiisingSelect,isReadeySelect,peoplePickerDiv='',IsaddedNewEmployee=![],EmployeeId='',EmployeeDepartment='',EmployeeOfficeLocation='',checkedAudience='',IsNotification=![];$(document)[a0_0x12a6b4(0x19e)](function(){var _0x2c1f01=a0_0x12a6b4;GraphAccessTokenTogetUserDetails(),GetCompanies(),GetOfficeLocation(),GetDepartments(),LoadShowUser([]),GetAllUserId(),GetEmployees(),AvilableLicenses==NaN&&GetEmployees(),$(_0x2c1f01(0x13b))[_0x2c1f01(0x119)](AvilableLicenses);});function initializePeoplePicker(_0x187a88){var _0x36c0b2=a0_0x12a6b4,_0x2834f9={};_0x2834f9[_0x36c0b2(0x1ca)]=_0x36c0b2(0x1da),_0x2834f9[_0x36c0b2(0x147)]=0xf,_0x2834f9['ResolvePrincipalSource']=0xf,_0x2834f9[_0x36c0b2(0x133)]=![],_0x2834f9[_0x36c0b2(0x15d)]=0x32,_0x2834f9[_0x36c0b2(0x216)]=_0x36c0b2(0x1fc),this[_0x36c0b2(0xe9)](_0x187a88,null,_0x2834f9),$('.sp-peoplepicker-editorInput')[_0x36c0b2(0xe7)](0xfa);}function GetSelectItem(){var _0x1cecfd=a0_0x12a6b4;IsaddedNewEmployee=![];if(contributersGroupId!==''){var _0x524409=tabledata[_0x1cecfd(0xeb)]();counusers=0x0;for(var _0x4e9138=0x0;_0x4e9138<_0x524409[_0x1cecfd(0x1db)];_0x4e9138++){var _0x2ba8cf=alluserdata[_0x1cecfd(0x1fd)](function(_0x3d7300){var _0x4e170e=_0x1cecfd;return _0x3d7300[_0x4e170e(0x120)]==_0x524409[_0x4e9138][_0x4e170e(0x183)][_0x4e170e(0x153)][_0x4e170e(0x120)];});AvilableLicenses>0x0?_0x2ba8cf[0x0][_0x1cecfd(0x205)]==_0x1cecfd(0x10c)?(AddNewEmployeeAllocated(_0x2ba8cf,'Employees'),IsaddedNewEmployee=!![]):_0x2ba8cf[0x0][_0x1cecfd(0x205)]==_0x1cecfd(0x196)&&UpdateExistingEmployeeAllocated(_0x2ba8cf,_0x1cecfd(0x16b)):($('#added')[_0x1cecfd(0x119)](counusers),alert(_0x1cecfd(0x121)),_0x4e9138=_0x524409[_0x1cecfd(0x1db)]);}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$(_0x1cecfd(0x1be))[_0x1cecfd(0x119)](counusers),showmessage(),tabledata['setData'](excelRows),tabledata[_0x1cecfd(0x18b)](pageIndex),IsaddedNewEmployee&&($(_0x1cecfd(0x21a))[_0x1cecfd(0xfa)]({'backdrop':_0x1cecfd(0x18e),'keyboard':![]},_0x1cecfd(0x161)),AddedEmployeeList[_0x1cecfd(0x1db)]>0x0?$(_0x1cecfd(0x1a7))[_0x1cecfd(0x161)]():$('#divAudience')[_0x1cecfd(0x15f)]());}else GetGroupIDByGroupName(),GetSelectItem();}var Temparray=[];$(a0_0x12a6b4(0x1c8))[a0_0x12a6b4(0x20a)](function(){var _0x554393=a0_0x12a6b4;debugger;Temparray=alluserdata;let _0x4407f4=[...new Set(Temparray[_0x554393(0x151)](_0x5820e8=>_0x5820e8['Company\x20*']))];var _0x5dac6c=document['getElementById'](_0x554393(0x220));_0x5dac6c[_0x554393(0x19b)]='',opt[_0x554393(0x187)]='0',opt['text']=_0x554393(0x11b),_0x5dac6c[_0x554393(0x1d3)](opt);for(var _0x53ad4e=0x0;_0x53ad4e<_0x4407f4['length'];_0x53ad4e++){opt=document['createElement'](_0x554393(0xf9)),opt[_0x554393(0x187)]=_0x4407f4[_0x53ad4e],opt[_0x554393(0x119)]=_0x4407f4[_0x53ad4e],_0x5dac6c[_0x554393(0x1d3)](opt);}Temparray=alluserdata;var _0x4ec2dd=[...new Set(Temparray[_0x554393(0x151)](_0x5a2a9f=>_0x5a2a9f['Location\x20*']))],_0x5dac6c=document[_0x554393(0x1d1)]('ddlfilterOfficeLocation'),_0x1b8acc='<option\x20value=\x220\x22><strong>All</strong></option>';for(var _0x53ad4e=0x0;_0x53ad4e<_0x4ec2dd['length'];_0x53ad4e++){_0x1b8acc+='<option\x20value=\x22'+_0x4ec2dd[_0x53ad4e]+'\x22>'+_0x4ec2dd[_0x53ad4e]+_0x554393(0xf8);}$(_0x554393(0x130))[_0x554393(0x18a)](_0x1b8acc),Temparray=alluserdata;let _0x316f88=[...new Set(Temparray[_0x554393(0x151)](_0x39b57a=>_0x39b57a['Department\x20*']))];var _0x5dac6c=document[_0x554393(0x1d1)]('ddlfilterDepartments');_0x5dac6c['innerHTML']='',opt[_0x554393(0x187)]='0',opt[_0x554393(0x119)]=_0x554393(0x176),_0x5dac6c[_0x554393(0x1d3)](opt);for(var _0x53ad4e=0x0;_0x53ad4e<_0x316f88['length'];_0x53ad4e++){opt=document['createElement'](_0x554393(0xf9)),opt[_0x554393(0x187)]=_0x316f88[_0x53ad4e],opt['text']=_0x316f88[_0x53ad4e],_0x5dac6c['appendChild'](opt);}}),$(a0_0x12a6b4(0x123))[a0_0x12a6b4(0x20a)](function(){var _0x597ea5=a0_0x12a6b4;let _0xc6699d;var _0x4663bd='',_0x43b2d4=!![];$('#ddlfilterAllCompanies')[_0x597ea5(0x1a6)]()!='0'&&(_0x43b2d4=![]);if($(_0x597ea5(0x17f))[_0x597ea5(0x1a6)]()!='0')_0x43b2d4=![];else return alert(_0x597ea5(0x11f)),![];if($(_0x597ea5(0x130))[_0x597ea5(0x1a6)]()!='0')_0x43b2d4=![];else return alert(_0x597ea5(0x141)),![];_0xc6699d=alluserdata[_0x597ea5(0x1fd)](function(_0x1d1eb1){var _0x45a717=_0x597ea5;return _0x1d1eb1[_0x45a717(0x1ef)]==$(_0x45a717(0x19a),$('#ddlfilterOfficeLocation'))[_0x45a717(0x1a6)]()&&_0x1d1eb1[_0x45a717(0x21e)]==$(_0x45a717(0x19a),$(_0x45a717(0x17f)))['val']()&&_0x1d1eb1[_0x45a717(0x17e)]==$(_0x45a717(0x19a),$(_0x45a717(0x12c)))[_0x45a717(0x1a6)]();});var _0x232c38=alluserdata[_0x597ea5(0xf2)](_0x47078e=>_0x47078e[_0x597ea5(0x1ef)]===$('option:selected',$('#ddlfilterOfficeLocation'))[_0x597ea5(0x1a6)]()&&_0x47078e[_0x597ea5(0x21e)]==$(_0x597ea5(0x19a),$(_0x597ea5(0x17f)))['val']()&&_0x47078e['Company\x20*']==$(_0x597ea5(0x19a),$(_0x597ea5(0x12c)))['val']());_0x43b2d4?LoadShowUser(alluserdata):LoadShowUser(_0xc6699d);}),$(a0_0x12a6b4(0x18c))['keyup'](function(_0x5c82b3){var _0x39cedc=a0_0x12a6b4;LoadShowUser(search($(_0x39cedc(0x18c))[_0x39cedc(0x1a6)]()));});function search(_0x15c8e8){var _0x2cd81b=a0_0x12a6b4;return alluserdata[_0x2cd81b(0x1fd)](function(_0x5e3951){var _0x3a2e75=_0x2cd81b;return _0x5e3951[_0x3a2e75(0x209)][_0x3a2e75(0x1ff)]()['indexOf'](_0x15c8e8['toLowerCase']())>-0x1||_0x5e3951[_0x3a2e75(0x120)][_0x3a2e75(0x1ff)]()['indexOf'](_0x15c8e8['toLowerCase']())>-0x1;});}$(a0_0x12a6b4(0x142))[a0_0x12a6b4(0x114)](function(){var _0x211170=a0_0x12a6b4;checkedAudience=this[_0x211170(0x187)];}),$(a0_0x12a6b4(0x186))['on'](a0_0x12a6b4(0x20a),function(){var _0x1a8451=a0_0x12a6b4;$[_0x1a8451(0x1c6)]({'cache':![],'beforeSend':function(){var _0xae390f=_0x1a8451;$('#overlaysearch')[_0xae390f(0xea)]();},'success':function(_0x4b56c5){var _0x831f08=_0x1a8451;AddedEmployeeList=[],SubmitReady(),$(_0x831f08(0x137))['fadeOut']();}});}),$(a0_0x12a6b4(0xfb))['on'](a0_0x12a6b4(0x20a),function(){var _0x21f779=a0_0x12a6b4;$[_0x21f779(0x1c6)]({'cache':![],'beforeSend':function(){var _0xcda2de=_0x21f779;$('#overlaysearch')[_0xcda2de(0xea)]();},'success':function(_0x4ab653){var _0x3526f5=_0x21f779;if(AddedEmployeeList[_0x3526f5(0x1db)]>0x0&&checkedAudience!=_0x3526f5(0x1f9))for(var _0x44f2cd=0x0;_0x44f2cd<AddedEmployeeList[_0x3526f5(0x1db)];_0x44f2cd++){var _0x321355=new Date(AddedEmployeeList[_0x44f2cd][_0x3526f5(0xfd)][_0x3526f5(0x154)]),_0xb7655e=new Date();_0xb7655e['setMonth'](_0x321355[_0x3526f5(0x150)]()+0x3),_0x321355=$[_0x3526f5(0x160)][_0x3526f5(0x136)](_0x3526f5(0x11d),_0x321355),_0xb7655e=$[_0x3526f5(0x160)][_0x3526f5(0x136)](_0x3526f5(0x11d),_0xb7655e);var _0x835460=new Date(AddedEmployeeList[_0x44f2cd]['Metadata']['JoiningDate']);_0x835460=$[_0x3526f5(0x160)][_0x3526f5(0x136)](_0x3526f5(0x18f),_0x835460);var _0x424276=[],_0x1b0583=[],_0x408033=[];_0x408033[_0x3526f5(0x179)](Logged_CompanyId);var _0x3adb0a;_0x3adb0a={'__metadata':{'type':_0x3526f5(0x14a)}},(_0x3adb0a[_0x3526f5(0x210)]=_0x3526f5(0x110),_0x3adb0a[_0x3526f5(0x1df)]=AddedEmployeeList[_0x44f2cd][_0x3526f5(0x193)]['toString'](),_0x3adb0a[_0x3526f5(0x1b7)]=_0x3526f5(0x12e),_0x3adb0a[_0x3526f5(0x16a)]=AddedEmployeeList[_0x44f2cd][_0x3526f5(0xfd)][_0x3526f5(0x116)],_0x3adb0a[_0x3526f5(0x1f2)]=AddedEmployeeList[_0x44f2cd][_0x3526f5(0xfd)][_0x3526f5(0x1f2)],_0x3adb0a['Department']=AddedEmployeeList[_0x44f2cd][_0x3526f5(0x101)],_0x3adb0a[_0x3526f5(0x117)]=AddedEmployeeList[_0x44f2cd][_0x3526f5(0x1e8)],_0x3adb0a[_0x3526f5(0x15b)]=_0x3526f5(0x1e1),_0x3adb0a['WebPartName']=_0x3526f5(0x110),_0x3adb0a[_0x3526f5(0x1c5)]=checkedAudience,_0x3adb0a[_0x3526f5(0x171)]=_0x3526f5(0x20e),_0x3adb0a[_0x3526f5(0xfe)]=_0x321355,_0x3adb0a[_0x3526f5(0x135)]=_0xb7655e,_0x3adb0a[_0x3526f5(0xec)]=_0x3526f5(0x215)+_0x835460);if(checkedAudience=='Corporate')_0x408033=[0x0],_0x424276=[0x0],_0x1b0583=[0x0],_0x3adb0a['CompanyId']={'results':_0x408033},_0x3adb0a[_0x3526f5(0x1f5)]={'results':_0x1b0583},_0x3adb0a[_0x3526f5(0x191)]={'results':_0x424276};else{if(checkedAudience=='Company')_0x408033['push'](AddedEmployeeList[_0x44f2cd][_0x3526f5(0xfd)][_0x3526f5(0x180)]),_0x424276=[0x0],_0x1b0583=[0x0],_0x3adb0a[_0x3526f5(0x180)]={'results':_0x408033},_0x3adb0a[_0x3526f5(0x1f5)]={'results':_0x1b0583},_0x3adb0a['OfficeLocationsId']={'results':_0x424276};else{if(checkedAudience==_0x3526f5(0x10f))_0x408033=[0x0],_0x424276=[0x0],_0x1b0583[_0x3526f5(0x179)](AddedEmployeeList[_0x44f2cd]['Metadata']['DepartmentId']),_0x3adb0a['CompanyId']={'results':_0x408033},_0x3adb0a[_0x3526f5(0x1f5)]={'results':_0x1b0583},_0x3adb0a['OfficeLocationsId']={'results':_0x424276};else checkedAudience==_0x3526f5(0x1bd)&&(_0x408033=[0x0],_0x424276[_0x3526f5(0x179)](AddedEmployeeList[_0x44f2cd][_0x3526f5(0xfd)][_0x3526f5(0x1c3)]),_0x1b0583=[0x0],_0x3adb0a[_0x3526f5(0x180)]={'results':_0x408033},_0x3adb0a[_0x3526f5(0x1f5)]={'results':_0x1b0583},_0x3adb0a[_0x3526f5(0x191)]={'results':_0x424276});}}InsertWelcomeInAnnouncementList(_0x3adb0a);}$('#overlaysearch')[_0x3526f5(0x163)]();}});});function SubmitReady(){var _0x413896=a0_0x12a6b4;if(contributersGroupId!==''){var _0x21c6ee=tabledata['getSelectedRows']();counusers=0x0,IsaddedNewEmployee=![];for(var _0x4f7b3c=0x0;_0x4f7b3c<_0x21c6ee['length'];_0x4f7b3c++){var _0x135224=alluserdata['filter'](function(_0x3b7c56){var _0x170c10=a0_0x3b66;return _0x3b7c56['Email\x20*']==_0x21c6ee[_0x4f7b3c][_0x170c10(0x183)][_0x170c10(0x153)]['Email\x20*'];});if(AvilableLicenses>0x0)_0x135224[0x0]['Status']==_0x413896(0x10c)?(AddNewEmployeeAllocated(_0x135224,_0x413896(0x16b)),IsaddedNewEmployee=!![]):_0x135224[0x0][_0x413896(0x205)]==_0x413896(0x196)&&UpdateExistingEmployeeAllocated(_0x135224,'Employees');else return alert(_0x413896(0x121)),![];}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$(_0x413896(0x1be))[_0x413896(0x119)](counusers),showmessage(),tabledata[_0x413896(0xf7)](excelRows),tabledata['setPage'](pageIndex),IsaddedNewEmployee&&($('#successfully_notifications')['modal']({'backdrop':_0x413896(0x18e),'keyboard':![]},'show'),AddedEmployeeList['length']>0x0?$(_0x413896(0x1a7))[_0x413896(0x161)]():$('#divAudience')[_0x413896(0x15f)]());}else GetGroupIDByGroupName(),GetSelectItem();}function isReadeySelecteds(){var _0x2ed79d=a0_0x12a6b4;isReadeySelect=document['getElementById'](_0x2ed79d(0x18d));if(isReadeySelect[_0x2ed79d(0x1eb)]){tabledata['deselectRow'](MiisingSelected),$(_0x2ed79d(0x1fb))[_0x2ed79d(0x1b3)]('checked',![]),$('#IsMiisingSelected')[_0x2ed79d(0x1b3)](_0x2ed79d(0x1eb),![]),ReadySelected=[];for(var _0x38ddf7=0x0;_0x38ddf7<excelRows[_0x2ed79d(0x1db)];_0x38ddf7++){(excelRows[_0x38ddf7][_0x2ed79d(0x205)]==_0x2ed79d(0x10c)||excelRows[_0x38ddf7][_0x2ed79d(0x205)]=='Already\x20Exist')&&ReadySelected[_0x2ed79d(0x179)](_0x38ddf7);}$(_0x2ed79d(0x165))[_0x2ed79d(0x1b3)]('checked',!![]),tabledata[_0x2ed79d(0xed)](ReadySelected);}else tabledata[_0x2ed79d(0x1cd)](ReadySelected),$('.select-row_isReadeySelected')['prop'](_0x2ed79d(0x1eb),![]);}function IsMiisingSelecteds(){var _0x2eada7=a0_0x12a6b4;IsMiisingSelect=document[_0x2eada7(0x1d1)](_0x2eada7(0x17d));if(IsMiisingSelect['checked']){tabledata[_0x2eada7(0x1cd)](ReadySelected),$(_0x2eada7(0x10d))[_0x2eada7(0x1b3)](_0x2eada7(0x1eb),![]),$(_0x2eada7(0x165))[_0x2eada7(0x1b3)]('checked',![]),MiisingSelected=[];for(var _0x5ac628=0x0;_0x5ac628<excelRows[_0x2eada7(0x1db)];_0x5ac628++){(excelRows[_0x5ac628][_0x2eada7(0x205)]==_0x2eada7(0x212)||excelRows[_0x5ac628][_0x2eada7(0x205)]=='Already\x20Exist'||excelRows[_0x5ac628][_0x2eada7(0x205)]==_0x2eada7(0x10c))&&(MiisingSelected['push'](_0x5ac628),$(_0x2eada7(0x1fb))['prop'](_0x2eada7(0x1eb),!![]));}tabledata[_0x2eada7(0xed)](MiisingSelected);}else tabledata['deselectRow'](MiisingSelected),$(_0x2eada7(0x1fb))[_0x2eada7(0x1b3)](_0x2eada7(0x1eb),![]);}function AssignPermissiononDMSLibary(_0x2b56a0,_0x2f7344,_0x3ca098){var _0x29ae11=a0_0x12a6b4,_0x2f57ae={'Accept':_0x29ae11(0xf4),'content-Type':'application/json;odata=verbose','X-RequestDigest':jQuery(_0x29ae11(0x12d))['val']()},_0x31fd17=_0x3ca098+_0x29ae11(0x140)+_0x2b56a0+',roleDefId='+_0x2f7344+')';$[_0x29ae11(0x1c6)]({'url':_0x31fd17,'type':_0x29ae11(0x189),'headers':_0x2f57ae,'dataType':_0x29ae11(0x157),'async':![],'success':function(_0x59bb57){console['log']('User\x20has\x20been\x20assigned\x20permission\x20.');},'error':function(_0x141645){var _0x5b04fe=_0x29ae11;console[_0x5b04fe(0x1a9)](JSON[_0x5b04fe(0x1e9)](_0x141645)),Permissionloder[_0x5b04fe(0x1b0)]();}});}function GetGroupIDByGroupName(){var _0x38ea83=a0_0x12a6b4,_0x5a68ae=_spPageContextInfo['webAbsoluteUrl']+_0x38ea83(0xff);$['ajax']({'url':_0x5a68ae,'method':_0x38ea83(0x202),'async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0x2e36a6){contributersGroupId=_0x2e36a6['d']['Id'];},'error':function(_0x44bc65){var _0x3e82a7=_0x38ea83;console[_0x3e82a7(0x1a9)](_0x44bc65);}});}function GetListItems(_0x2cc29b,_0x107f14){var _0x213b4f=a0_0x12a6b4,_0x3d1373,_0x2e8787=_spPageContextInfo[_0x213b4f(0x15c)]+_0x213b4f(0x1dc)+_0x2cc29b+_0x213b4f(0x17b)+_0x107f14+_0x213b4f(0x19c);return $['ajax']({'url':_0x2e8787,'method':_0x213b4f(0x202),'async':![],'headers':{'Accept':_0x213b4f(0x1d2)},'success':function(_0x2e9391){var _0x93421a=_0x213b4f;_0x2e9391['d'][_0x93421a(0x1f6)][_0x93421a(0x1db)]>0x0?_0x3d1373=![]:_0x3d1373=!![];},'error':function(_0x106825){var _0x4ac603=_0x213b4f;console[_0x4ac603(0x1a9)](_0x106825);}}),_0x3d1373;}function GetCompanies(){var _0x3f6dbd=a0_0x12a6b4,_0x45223b=_spPageContextInfo['webAbsoluteUrl']+_0x3f6dbd(0x1b4);$[_0x3f6dbd(0x1c6)]({'url':_0x45223b,'method':_0x3f6dbd(0x202),'async':![],'headers':{'Accept':_0x3f6dbd(0x1d2)},'success':function(_0x14df4a){AllCompanies=_0x14df4a['d']['results'];},'error':function(_0xdbd07c){console['log'](_0xdbd07c);}});}function GetDepartments(){var _0x5733ec=a0_0x12a6b4,_0x386c11=_spPageContextInfo[_0x5733ec(0x15c)]+_0x5733ec(0x174);$[_0x5733ec(0x1c6)]({'url':_0x386c11,'method':_0x5733ec(0x202),'async':![],'headers':{'Accept':_0x5733ec(0x1d2)},'success':function(_0xb084b5){var _0x7f71ce=_0x5733ec;AllDepartments=_0xb084b5['d'][_0x7f71ce(0x1f6)];},'error':function(_0x1e6e09){console['log'](_0x1e6e09);}});}function GetOfficeLocation(){var _0xeaade0=a0_0x12a6b4,_0x35af98=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getByTitle(\x27OfficeLocation\x27)/items?$select=*&$top=4900';$[_0xeaade0(0x1c6)]({'url':_0x35af98,'method':'GET','async':![],'headers':{'Accept':_0xeaade0(0x1d2)},'success':function(_0x2fac91){var _0x3c67ed=_0xeaade0;AllOfficeLocation=_0x2fac91['d'][_0x3c67ed(0x1f6)];},'error':function(_0x2a8840){var _0x34f064=_0xeaade0;console[_0x34f064(0x1a9)](_0x2a8840);}});}function GetSubSiteUrl(_0x2a4cd2,_0x41869c){var _0xa9e89f=a0_0x12a6b4,_0x1a59e2,_0x3ad591=_spPageContextInfo[_0xa9e89f(0x15c)]+_0xa9e89f(0x1dc)+_0x2a4cd2+_0xa9e89f(0x128)+_0x41869c+_0xa9e89f(0x19c);return $[_0xa9e89f(0x1c6)]({'url':_0x3ad591,'method':_0xa9e89f(0x202),'async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0x5e2501){var _0x3b846c=_0xa9e89f;_0x1a59e2=_0x5e2501['d'][_0x3b846c(0x1f6)][0x0][_0x3b846c(0x175)];},'error':function(_0x404f85){console['log'](_0x404f85);}}),_0x1a59e2;}function AddUserinSharePointGroup(_0x4797e2){var _0x603380=a0_0x12a6b4,_0x4a0068=$[_0x603380(0x118)](),_0x3389ea='i:0#.f|membership|',_0x276025=_0x3389ea+_0x4797e2,_0x23a2c4=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/sitegroups('+contributersGroupId+_0x603380(0x1c2);$['ajax']({'url':_0x23a2c4,'type':_0x603380(0x189),'async':![],'data':JSON[_0x603380(0x1e9)]({'__metadata':{'type':_0x603380(0x1cf)},'LoginName':_0x276025}),'headers':{'accept':_0x603380(0xf4),'content-type':'application/json;odata=verbose','X-RequestDigest':$('#__REQUESTDIGEST')[_0x603380(0x1a6)]()},'success':_0x5de0bc,'error':_0x26fb35});function _0x5de0bc(_0x478986){var _0x56685b=_0x603380;_0x4a0068[_0x56685b(0x103)](_0x478986['d']['Id']),console[_0x56685b(0x1a9)](_0x56685b(0xf1));}function _0x26fb35(_0x3c317c){var _0x424274=_0x603380;console[_0x424274(0x1a9)](JSON['stringify'](_0x3c317c));}return _0x4a0068[_0x603380(0x1e4)]();}function GetUserId(_0x443567){var _0x32613f=a0_0x12a6b4,_0x2b39c2='',_0x46df36='i:0#.f|membership|',_0x108849=_spPageContextInfo[_0x32613f(0xe8)],_0x24e1f3=_0x46df36+_0x443567;return $['ajax']({'url':_0x108849+_0x32613f(0xee)+encodeURIComponent(_0x24e1f3)+'\x27','method':_0x32613f(0x202),'headers':{'Accept':_0x32613f(0x1d2)},'async':![],'success':function(_0x3f6e54){_0x2b39c2=_0x3f6e54['d']['Id'];},'error':function(_0x41ab79){var _0x267270=_0x32613f;console['log'](JSON[_0x267270(0x1e9)](_0x41ab79));}}),_0x2b39c2;}var GetAllGroupsUser=[],GroupUrl=_spPageContextInfo[a0_0x12a6b4(0xe8)]+a0_0x12a6b4(0x10b);function GetAllUserId(){var _0x521b14=a0_0x12a6b4;$[_0x521b14(0x1c6)]({'url':GroupUrl,'method':_0x521b14(0x202),'headers':{'Accept':'application/json;\x20odata=verbose'},'async':![],'success':function(_0x3ab92e){var _0x36d32d=_0x521b14;GetAllGroupsUser=GetAllGroupsUser[_0x36d32d(0x1a3)](_0x3ab92e['d'][_0x36d32d(0x1f6)]),_0x3ab92e['d'][_0x36d32d(0x1d0)]!=null&&(GroupUrl=_0x3ab92e['d'][_0x36d32d(0x1d0)],GetAllUserId());},'error':function(_0x502bbb){var _0x38ebb1=_0x521b14;console[_0x38ebb1(0x1a9)](JSON[_0x38ebb1(0x1e9)](_0x502bbb));}});}var LoginName;function UpdateExistingEmployeeAllocated(_0x2a6b63,_0x26e212){var _0x1d958b=a0_0x12a6b4;try{UserEmailId=_0x2a6b63[0x0][_0x1d958b(0x120)],LoginName=_0x1d958b(0x11e)+_0x2a6b63[0x0][_0x1d958b(0x120)];var _0x2fab26,_0x373781,_0x1b234f=GetAllGroupsUser['filter'](function(_0x3d4c0a){var _0x499277=_0x1d958b;return _0x3d4c0a[_0x499277(0x14f)][_0x499277(0x1ff)]()==_0x2a6b63[0x0][_0x499277(0x120)][_0x499277(0x1ff)]();});if(_0x1b234f[_0x1d958b(0x1db)]>0x0)var _0x1244b8=_0x1b234f[0x0]['Id'];else{}if(TopExecutive==_0x1d958b(0xfc)||_0x2a6b63[0x0][_0x1d958b(0x200)]==undefined)_0x2a6b63[0x0][_0x1d958b(0x200)]=_0x1d958b(0xfc),_0x2fab26=-0x1;else{var _0x46c8df=EmployeeListUsers[_0x1d958b(0x1fd)](function(_0x4dee32){var _0x1b079d=_0x1d958b,_0x233fae;if(_0x4dee32[_0x1b079d(0x21c)]!=null)return _0x233fae=_0x4dee32['Email'][_0x1b079d(0x1ff)](),_0x233fae==_0x2a6b63[0x0][_0x1b079d(0x200)][_0x1b079d(0x1ff)]();});if(_0x46c8df[_0x1d958b(0x1db)]>0x0){_0x373781=_0x46c8df[0x0]['FullName'];var _0x1b234f=GetAllGroupsUser[_0x1d958b(0x1fd)](function(_0xe5f5e5){var _0x1c0ce8=_0x1d958b;return _0xe5f5e5[_0x1c0ce8(0x14f)][_0x1c0ce8(0x1ff)]()==_0x2a6b63[0x0][_0x1c0ce8(0x200)]['toLowerCase']();});if(_0x1b234f[_0x1d958b(0x1db)]>0x0)_0x2fab26=_0x1b234f[0x0]['Id'];else{}}else{IsManager=![],_0x2fab26='';var _0x31652b=excelRows[_0x1d958b(0x1ec)](_0x589eb5=>_0x589eb5[_0x1d958b(0x120)][_0x1d958b(0x1ff)]()==_0x2a6b63[0x0]['Email\x20*'][_0x1d958b(0x1ff)]());excelRows[_0x31652b]['Status']=_0x1d958b(0x1a4);}}var _0x114639,_0x1dda92=GetItemTypeForListName(_0x26e212);_0x114639={'__metadata':{'type':_0x1dda92},'Designation':_0x2a6b63[0x0][_0x1d958b(0x144)],'GroupName':_0x2a6b63[0x0][_0x1d958b(0x102)],'Manager':_0x373781,'ManagerLoginNameId':_0x2fab26},$[_0x1d958b(0x192)](updateItemExitUser(_0x26e212,_0x114639,_0x2a6b63[0x0][_0x1d958b(0x10e)]))['done'](function(_0x298ca7){var _0x124a42=_0x1d958b,_0x42c60a=_0x298ca7;if(_0x42c60a){lblUpdate=lblUpdate+0x1,Exits=Exits-0x1;var _0x1c5004=excelRows[_0x124a42(0x1ec)](_0x19e85c=>_0x19e85c['Email\x20*']==UserEmailId);excelRows[_0x1c5004][_0x124a42(0x205)]='Updated',showmessage();}});}catch(_0x2d8837){console[_0x1d958b(0x1a9)](_0x2d8837[_0x1d958b(0x1e3)]);}}var IsManager=!![];function AddNewEmployeeAllocated(_0x7a50c1,_0x44f2fc){var _0x4529db=a0_0x12a6b4;try{if(GetListItems(_0x4529db(0x21b),parseInt(_0x7a50c1[0x0][_0x4529db(0x21e)])))return alert('Department\x20Id\x20is\x20not\x20Correct'),![];if(GetListItems(_0x4529db(0x100),parseInt(_0x7a50c1[0x0][_0x4529db(0x17e)])))return alert(_0x4529db(0x20f)),![];else{if(GetListItems(_0x4529db(0x117),parseInt(_0x7a50c1[0x0][_0x4529db(0x1ef)])))return alert(_0x4529db(0xe6)),![];else{LoginName=_0x7a50c1[0x0][_0x4529db(0x120)]['toLowerCase']();var _0x3cc995,_0x22ac3c,_0x11adc5=GetAllGroupsUser[_0x4529db(0x1fd)](function(_0xe0c749){var _0x575167=_0x4529db;return _0xe0c749[_0x575167(0x14f)][_0x575167(0x1ff)]()==_0x7a50c1[0x0][_0x575167(0x120)][_0x575167(0x1ff)]();}),_0x414ccd;if(_0x11adc5[_0x4529db(0x1db)]>0x0)var _0x414ccd=_0x11adc5[0x0]['Id'];else $['when'](AddUserinSharePointGroup(LoginName))[_0x4529db(0x1d9)](function(_0x33b577){_0x414ccd=_0x33b577;});if(TopExecutive==_0x4529db(0xfc)||_0x7a50c1[0x0]['Manager\x20*']==undefined)_0x7a50c1[0x0][_0x4529db(0x200)]='Chief\x20Executive',_0x3cc995=-0x1;else{var _0x21f28e=EmployeeListUsers[_0x4529db(0x1fd)](function(_0x211fd8){var _0x238bc1=_0x4529db,_0x58013d;if(_0x211fd8['Email']!=null)return _0x58013d=_0x211fd8[_0x238bc1(0x14f)][_0x238bc1(0x1ff)](),_0x58013d==_0x7a50c1[0x0]['Manager\x20*'][_0x238bc1(0x1ff)]();});if(_0x21f28e[_0x4529db(0x1db)]>0x0){_0x22ac3c=_0x21f28e[0x0][_0x4529db(0x116)];var _0x11adc5=GetAllGroupsUser[_0x4529db(0x1fd)](function(_0x2134c0){var _0x5a03eb=_0x4529db;return _0x2134c0['Email'][_0x5a03eb(0x1ff)]()==_0x7a50c1[0x0][_0x5a03eb(0x200)][_0x5a03eb(0x1ff)]();});_0x11adc5[_0x4529db(0x1db)]>0x0?_0x3cc995=_0x11adc5[0x0]['Id']:_0x3cc995=AddUserinSharePointGroup(_0x7a50c1[0x0]['Manager\x20*'][_0x4529db(0x1ff)]());}else{IsManager=![],_0x3cc995='';var _0x125d7d=excelRows[_0x4529db(0x1ec)](_0x1c009d=>_0x1c009d[_0x4529db(0x120)][_0x4529db(0x1ff)]()==LoginName);excelRows[_0x125d7d][_0x4529db(0x205)]=_0x4529db(0x177);}}var _0x2499d7,_0x3bcc64=GetItemTypeForListName(_0x44f2fc);_0x2499d7={'__metadata':{'type':_0x3bcc64},'CompanyId':parseInt(_0x7a50c1[0x0][_0x4529db(0x17e)]),'DepartmentId':parseInt(_0x7a50c1[0x0][_0x4529db(0x21e)]),'FullName':_0x7a50c1[0x0]['Name'],'Title':_0x7a50c1[0x0][_0x4529db(0x209)],'ParentId':'-1','Email':_0x7a50c1[0x0][_0x4529db(0x120)],'LogonNameId':_0x414ccd,'Manager':_0x7a50c1[0x0][_0x4529db(0x200)],'ManagerLoginNameId':_0x3cc995,'OfficeLocationId':parseInt(_0x7a50c1[0x0][_0x4529db(0x1ef)]),'MobileNumber':_0x7a50c1[0x0][_0x4529db(0x12b)],'DateOfBirth':_0x7a50c1[0x0]['Date\x20Of\x20Birth'],'Gender':_0x7a50c1[0x0][_0x4529db(0x1d5)],'DateOfAnniversary':_0x7a50c1[0x0]['Date\x20Of\x20Marriage'],'JoiningDate':_0x7a50c1[0x0][_0x4529db(0x115)],'Designation':_0x7a50c1[0x0]['Designation\x20*'],'PrimaryCompany':'Primary','EmployeeID':_0x7a50c1[0x0]['Employee\x20Code'],'GroupName':_0x7a50c1[0x0][_0x4529db(0x102)],'Status':_0x4529db(0x143),'PostalAddresses':_0x7a50c1[0x0][_0x4529db(0x1d6)],'City':_0x7a50c1[0x0][_0x4529db(0x211)],'StateProvince':_0x7a50c1[0x0][_0x4529db(0x188)],'ZIPPostalCode':_0x7a50c1[0x0][_0x4529db(0x1fa)],'Country':_0x7a50c1[0x0][_0x4529db(0x155)],'HomePhone':_0x7a50c1[0x0][_0x4529db(0x169)],'OtherEMailAddress':_0x7a50c1[0x0][_0x4529db(0x108)],'HomeAddress':_0x7a50c1[0x0][_0x4529db(0x13d)]},AddItemToList(_0x44f2fc,_0x2499d7);var _0x3419f4=new Date(),_0x195505=new Date(_0x7a50c1[0x0][_0x4529db(0x115)]),_0x14ea00=daysDifference(_0x195505,_0x3419f4);if(_0x14ea00<=0xf)AddedEmployeeList[_0x4529db(0x179)]({'Metadata':_0x2499d7,'EmployeeId':EmployeeId,'EmployeeOfficeLocation':_0x7a50c1[0x0]['OfficeNameDetail'],'EmployeeDepartment':_0x7a50c1[0x0][_0x4529db(0x1d7)]});else{}}}}catch(_0x35391f){console['log'](_0x35391f[_0x4529db(0x1e3)]);}}function daysDifference(_0x2ddfb1,_0x526389){var _0x254b52=a0_0x12a6b4,_0x316371=new Date(+_0x526389)['setHours'](0xc)-new Date(+_0x2ddfb1)[_0x254b52(0x195)](0xc);return Math[_0x254b52(0x16c)](_0x316371/0x5265c00);}function updateItemExitUser(_0x27e09d,_0x4aa1dd,_0x4cc20f){var _0x32f6e8=a0_0x12a6b4,_0x1be2d2=$[_0x32f6e8(0x118)]();return $[_0x32f6e8(0x1c6)]({'url':_spPageContextInfo[_0x32f6e8(0x15c)]+'/_api/web/lists/getbytitle(\x27'+_0x27e09d+_0x32f6e8(0x1c7)+_0x4cc20f+'\x27)','type':'POST','headers':{'accept':_0x32f6e8(0xf4),'X-RequestDigest':$(_0x32f6e8(0x12d))['val'](),'content-Type':_0x32f6e8(0xf4),'X-Http-Method':_0x32f6e8(0x1b9),'If-Match':'*'},'data':JSON['stringify'](_0x4aa1dd),'async':![],'success':function(_0x180004){var _0x41e1d8=_0x32f6e8;_0x1be2d2[_0x41e1d8(0x103)](!![]);},'error':function(_0x272fd8){_0x1be2d2['reject'](_0x272fd8);}}),_0x1be2d2[_0x32f6e8(0x1e4)]();}function AddItemToList(_0x4b4494,_0x3e4adf){var _0x1098d8=a0_0x12a6b4;UserEmailId=_0x3e4adf['Email'];var _0xa36943=_0x3e4adf[_0x1098d8(0x116)];EmployeeId='';var _0x4b7742=$[_0x1098d8(0x118)]();return $[_0x1098d8(0x1c6)]({'url':_spPageContextInfo[_0x1098d8(0x15c)]+'/_api/web/lists/getbytitle(\x27'+_0x4b4494+_0x1098d8(0x113),'type':_0x1098d8(0x189),'async':![],'headers':{'accept':_0x1098d8(0xf4),'X-RequestDigest':$(_0x1098d8(0x12d))['val'](),'content-Type':_0x1098d8(0xf4)},'data':JSON[_0x1098d8(0x1e9)](_0x3e4adf),'success':function(_0x2acd9a){var _0x177be6=_0x1098d8;EmployeeId=_0x2acd9a['d']['Id'],counusers=counusers+0x1,AvilableLicenses=AvilableLicenses-0x1,Ready=Ready-0x1;var _0xed1a51=excelRows[_0x177be6(0x1ec)](_0xd9a692=>_0xd9a692['Email\x20*']==UserEmailId);excelRows[_0xed1a51][_0x177be6(0x205)]=_0x177be6(0x182),showmessage();var _0x41af0=GetSubSiteUrl(_0x177be6(0x21b),_0x2acd9a['d'][_0x177be6(0x190)]);AssignPermissiononDMSLibary(_0x2acd9a['d'][_0x177be6(0x16f)],'1073741826',_0x41af0),_0x4b7742[_0x177be6(0x103)](_0x2acd9a);},'error':function(_0x85d9fa){var _0x119317=_0x1098d8;if(IsManager){var _0x1f4809=excelRows[_0x119317(0x1ec)](_0x312f70=>_0x312f70[_0x119317(0x120)]==UserEmailId);excelRows[_0x1f4809][_0x119317(0x205)]=_0x119317(0x1d8);}userfullname==''?(userfullname+=_0xa36943,warningmessage='The\x20following\x20users\x20failed\x20to\x20sync\x20due\x20to\x20wrong\x20manager\x20defined!.\x0a'):userfullname+=_0x119317(0x1e0)+_0xa36943,Ready=Ready-0x1,Error=Error+0x1,console[_0x119317(0x1a9)](JSON['stringify'](_0x85d9fa)),_0x4b7742[_0x119317(0x206)](JSON[_0x119317(0x1e9)](_0x85d9fa));}}),_0x4b7742['promise']();}function LoadShowUser(_0x35091d){var _0x42b3e8=a0_0x12a6b4;tabledata=new Tabulator(_0x42b3e8(0x1de),{'height':'','pagination':'local','paginationSize':0xa,'layout':_0x42b3e8(0x134),'paginationSizeSelector':[0xa,0x19,0x32,0x64],'placeholder':_0x42b3e8(0x125),'data':_0x35091d,'pageLoaded':function(_0x15b3fa){var _0x29a864=_0x42b3e8;_0x15b3fa>=0x1?pageIndex=_0x15b3fa:pageIndex=_0x15b3fa,IsMiisingSelect=document[_0x29a864(0x1d1)]('IsMiisingSelected'),IsMiisingSelect[_0x29a864(0x1eb)]&&$('.select-row_IsMiisingSelected')[_0x29a864(0x1b3)]('checked',!![]),isReadeySelect=document[_0x29a864(0x1d1)](_0x29a864(0x18d)),isReadeySelect[_0x29a864(0x1eb)]&&$('.select-row_isReadeySelected')[_0x29a864(0x1b3)]('checked',!![]);},'columns':[{'formatter':function(_0x2c5360,_0x51d5a9){var _0x2823be=_0x42b3e8,_0x5180eb=_0x2c5360[_0x2823be(0x13c)]['row']['data']['Status'];return _0x5180eb==_0x2823be(0x1cb)||_0x5180eb==_0x2823be(0x212)||_0x5180eb==_0x2823be(0x182)||_0x5180eb==_0x2823be(0x1ad)?_0x2823be(0x1c4):_0x2823be(0x15a);},'title':'<input\x20type=\x22checkbox\x22\x20id=\x22isReadeySelected\x22\x20onclick=\x22isReadeySelecteds()\x22\x20/>','field':'ID','width':'1%','headerSort':![],'cellClick':function(_0x263e3b,_0x288951){var _0x5d8757=_0x42b3e8,_0x25ffd5=$(_0x288951[_0x5d8757(0x219)]()),_0x39b76c=_0x25ffd5[_0x5d8757(0xf2)](_0x5d8757(0x165));_0x39b76c[0x0][_0x5d8757(0x1eb)]==![]&&$(_0x288951[_0x5d8757(0x14b)]()[_0x5d8757(0x219)]())[_0x5d8757(0xf2)](_0x5d8757(0x1fb))[0x0][_0x5d8757(0x1eb)]==![]?_0x288951['getRow']()['deselect']():_0x288951[_0x5d8757(0x14b)]()['select']();}},{'formatter':function(_0x3fa5b5,_0x49ac23){var _0x1d67cb=_0x42b3e8,_0x138fba=_0x3fa5b5['_cell'][_0x1d67cb(0x204)][_0x1d67cb(0x153)][_0x1d67cb(0x205)];return _0x138fba==_0x1d67cb(0x212)||_0x138fba==_0x1d67cb(0x196)||_0x138fba=='Ready'?_0x1d67cb(0xe5):_0x1d67cb(0x1c4);},'title':_0x42b3e8(0x139),'hozAlign':_0x42b3e8(0x213),'field':'ID','headerSort':![],'width':'1%','cellClick':function(_0x1ad679,_0x31245e){var _0x4cb819=_0x42b3e8,_0x5c37ec=$(_0x31245e[_0x4cb819(0x219)]()),_0x52a2f8=_0x5c37ec[_0x4cb819(0xf2)](_0x4cb819(0x1fb));_0x52a2f8[0x0]['checked']==![]&&$(_0x31245e['getRow']()['getElement']())[_0x4cb819(0xf2)](_0x4cb819(0x165))[0x0]['checked']==![]?_0x31245e[_0x4cb819(0x14b)]()['deselect']():_0x31245e[_0x4cb819(0x14b)]()['select']();}},{'title':_0x42b3e8(0x205),'field':_0x42b3e8(0x205),'width':'8%','formatter':function(_0x28776a,_0x233c16){var _0x5494d3=_0x42b3e8,_0x40843f=_0x28776a[_0x5494d3(0x1dd)]();if(_0x40843f==_0x5494d3(0x1cb)||_0x40843f=='Required\x20Value\x20Missing'||_0x40843f==_0x5494d3(0x1d8)||_0x40843f==_0x5494d3(0x1a4))return'\x20<span\x20style=\x27color:red;\x20font-weight:bold;\x27>'+_0x40843f+_0x5494d3(0x1f8);else return _0x40843f==_0x5494d3(0x196)?_0x5494d3(0x173)+_0x40843f+_0x5494d3(0x1f8):_0x5494d3(0x11c)+_0x40843f+_0x5494d3(0x1f8);}},{'title':_0x42b3e8(0x13e),'field':_0x42b3e8(0x13e),'width':_0x42b3e8(0x13a)},{'title':_0x42b3e8(0x209),'field':_0x42b3e8(0x209),'width':'10%'},{'title':_0x42b3e8(0x14f),'field':_0x42b3e8(0x120),'align':_0x42b3e8(0x1f1),'width':_0x42b3e8(0x1b1)},{'title':_0x42b3e8(0x1ac),'field':_0x42b3e8(0x17e),'width':'10%','align':_0x42b3e8(0x213)},{'title':_0x42b3e8(0x10f),'field':_0x42b3e8(0x21e),'width':_0x42b3e8(0x13a),'align':_0x42b3e8(0x213)},{'title':_0x42b3e8(0x1bd),'field':_0x42b3e8(0x1ef),'width':'8%','align':'center'},{'title':'Designation','field':_0x42b3e8(0x144),'width':_0x42b3e8(0x13a)},{'title':_0x42b3e8(0x21c),'field':_0x42b3e8(0x200),'width':_0x42b3e8(0x13a)},{'title':_0x42b3e8(0x115),'field':_0x42b3e8(0x115),'width':_0x42b3e8(0x13a)},{'title':_0x42b3e8(0x102),'field':_0x42b3e8(0x102),'width':_0x42b3e8(0x13a)}]}),showmessage(),$('#Rowcount')[_0x42b3e8(0x18a)](_0x42b3e8(0x1f3)),$(_0x42b3e8(0x1e2))[_0x42b3e8(0x1cc)](),$(_0x42b3e8(0x19d))['after'](_0x42b3e8(0x168));}function showmessage(){var _0x442b8f=a0_0x12a6b4;$(_0x442b8f(0x12a))[_0x442b8f(0x119)](Ready),$(_0x442b8f(0x201))[_0x442b8f(0x119)](Error),$('#Exits')['text'](Exits),$(_0x442b8f(0x162))[_0x442b8f(0x119)](lblUpdate),$(_0x442b8f(0x13b))['text'](AvilableLicenses);}function requestToken(){var _0x18470=a0_0x12a6b4;$['ajax']({'async':!![],'crossDomain':!![],'url':ClientUrl,'method':'POST','headers':{'content-type':_0x18470(0x1bb)},'data':{'grant_type':_0x18470(0x166),'client_id\x20':ClientId,'client_secret':ClentSecret,'scope\x20':_0x18470(0x132)},'success':function(_0x3e3c89){var _0x356c11=_0x18470;console[_0x356c11(0x1a9)](_0x3e3c89),token=_0x3e3c89[_0x356c11(0x16e)];},'error':function(_0x4c1b67){var _0x5be553=_0x18470;console[_0x5be553(0x1a9)](JSON['stringify'](_0x4c1b67));}});}function GraphAccessTokenTogetUserDetails(){var _0x454320=a0_0x12a6b4,_0x4c6b92=new jQuery[(_0x454320(0x118))](),_0x59af03={'X-RequestDigest':$(_0x454320(0x12d))[_0x454320(0x1a6)](),'accept':_0x454320(0x1c1),'content-type':'application/json;odata=nometadata'},_0x42bc08={'resource':'https://graph.microsoft.com'};return $[_0x454320(0x1c6)]({'url':_spPageContextInfo[_0x454320(0x15c)]+'/_api/SP.OAuth.Token/Acquire','headers':_0x59af03,'type':_0x454320(0x189),'async':![],'data':JSON[_0x454320(0x1e9)](_0x42bc08),'success':function(_0x5f59bc){var _0x53fe6c=_0x454320;token=_0x5f59bc[_0x53fe6c(0x16e)],_0x4c6b92[_0x53fe6c(0x103)](token);},'error':function(_0x4bf425,_0x310da8,_0x3a1280){var _0x3636f9=_0x454320;console[_0x3636f9(0x1a9)](_0x4bf425[_0x3636f9(0xf6)]),_0x4c6b92[_0x3636f9(0x206)](_0x4bf425[_0x3636f9(0xf6)]);}}),_0x4c6b92[_0x454320(0x1e4)]();}var employeehtml='',userName='',AzureUsrlist=[],AdusersUrl='https://graph.microsoft.com/beta/users?$top=100&$select=mail,displayName,userPrincipalName';function GetAzureUsrlist(_0x225d53,_0x1b448f){var _0x38d3ab=a0_0x12a6b4;return DeferredObj=$[_0x38d3ab(0x118)](),$[_0x38d3ab(0x1c6)]({'method':_0x38d3ab(0x202),'url':_0x225d53,'headers':{'Authorization':_0x38d3ab(0x1a0)+_0x1b448f,'Content-Type':_0x38d3ab(0x21d)},'async':![],'success':function(_0x464e55){var _0x1b9298=_0x38d3ab;AzureUsrlist=AzureUsrlist[_0x1b9298(0x1a3)](_0x464e55[_0x1b9298(0x187)]),_0x464e55[_0x1b9298(0x1ae)]!=null&&(AdusersUrl=_0x464e55[_0x1b9298(0x1ae)],GetAzureUsrlist(AdusersUrl,_0x1b448f));},'error':function(_0x3a12e7){var _0x4c9de6=_0x38d3ab;DeferredObj[_0x4c9de6(0x206)](_0x3a12e7),alert(_0x4c9de6(0x20d)+JSON[_0x4c9de6(0x1e9)](_0x3a12e7));}}),DeferredObj['promise']();}function getEmployee(_0x5ef04a){var _0x2572cf=a0_0x12a6b4,_0x46b647=_0x2572cf(0x13f)+_0x5ef04a+'\x27';return DeferredObj=$[_0x2572cf(0x118)](),$[_0x2572cf(0x1c6)]({'method':_0x2572cf(0x202),'url':_0x46b647,'headers':{'Authorization':_0x2572cf(0x1a0)+token,'Content-Type':_0x2572cf(0x21d)},'async':![],'success':function(_0x1bd1a7){var _0x2b705b=_0x2572cf;_0x1bd1a7['value']['length']>0x0?DeferredObj['resolve'](_0x1bd1a7['value'][0x0][_0x2b705b(0x181)]):DeferredObj[_0x2b705b(0x103)]('Invalid\x20Profile');},'error':function(_0x55687d){var _0x4a9008=_0x2572cf;DeferredObj[_0x4a9008(0x206)](_0x55687d),alert(_0x4a9008(0x20d)+JSON[_0x4a9008(0x1e9)](_0x55687d));}}),DeferredObj[_0x2572cf(0x1e4)]();}function ClientCredentials(){var _0x30f173=a0_0x12a6b4,_0xb7f392='EnvironmentalSettings',_0x54e7aa=titanForWork[_0x30f173(0x126)](_0x30f173(0x180)),_0x1140e1=_spPageContextInfo['webAbsoluteUrl']+_0x30f173(0xf3)+_0xb7f392+_0x30f173(0x1b6);$[_0x30f173(0x1c6)]({'url':_0x1140e1,'headers':{'Accept':_0x30f173(0xf4)},'async':![],'success':function(_0x19ea24){var _0x2c8432=_0x30f173,_0xfad973=_0x19ea24['d'][_0x2c8432(0x1f6)];ClientId=_0xfad973[0x0]['ClientName'],ClentSecret=_0xfad973[0x0][_0x2c8432(0x217)],ClientUrl=_0xfad973[0x0][_0x2c8432(0xec)];},'error':function(_0x19346c){var _0x964d8e=_0x30f173;console[_0x964d8e(0x1a9)](_0x19346c);}});}function a0_0x184d(){var _0x38a53d=['SearchPrincipalSource','639843uZmVRw','902570qRdVHX','SP.Data.AnnouncementsListItem','getRow','EmployeeSyncReport.xlsx','mail','binary','Email','getMonth','map','Please\x20upload\x20a\x20valid\x20Excel\x20file.','data','JoiningDate','Country','4EZtnph','json','onchange','121JLXxUe','<input\x20type=\x22checkbox\x22\x20class=\x22select-row_isReadeySelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>','UserType','webAbsoluteUrl','MaximumEntitySuggestions','#ddlOfficeLocation','hide','datepicker','show','#lblUpdate','fadeOut','#btnUploadExcel','.select-row_isReadeySelected','client_credentials','Please\x20select\x20required\x20value\x20missing\x20row','<span\x20class=\x27breakpoint\x27></span>','Home\x20Phone','EmployeeName','Employees','round','join','access_token','LogonNameId','read','ApprovalStatus','#txtmanager','\x20<span\x20style=\x27color:blue;\x20font-weight:bold;\x27>','/_api/web/lists/getByTitle(\x27Departments\x27)/items?$select=*&$top=4900','SiteURL','All','Wrong\x20Manager','chkGroup','push','onload','\x27)/items?$select=ID&$filter=ID\x20eq\x20','please\x20check\x20at\x20list\x20one\x20checkbox\x20','IsMiisingSelected','Company\x20*','#ddlfilterDepartments','CompanyId','displayName','Added','_row','SheetNames','#txtDesignation','#btnsubmitready','value','Sate','POST','html','setPage','.searching','isReadeySelected','static','dd\x20M\x20yy','DepartmentId','OfficeLocationsId','when','EmployeeId','slice','setHours','Already\x20Exist','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=999&$select=ID,AttachmentFiles,FullName,Designation,Manager,MobileNumber,ExtensionName,Email,LogonName/UserName,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department,AttachmentFiles\x20&$filter=\x20PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20','test','495rEZyyl','option:selected','innerHTML','&$top=1','.tabulator-page-size','ready','result','Bearer\x20','This\x20browser\x20does\x20not\x20support\x20HTML5.','\x27)\x20and\x20(Status\x20eq\x20\x27Active\x27)','concat','Worng\x20Manager','15139800aNqYkE','val','#divAudience','Data\x20Send\x20to\x20Announcements\x20Failed','log','#txtGroup','chkDesignation','Company','Updated','@odata.nextLink','exceltble','close','15%','ddlAllCompanies','prop','/_api/web/lists/getByTitle(\x27Companies\x27)/items?$select=*&$top=4900','GetAllUserInfo','\x27)/items?$filter=Title\x20eq\x20\x27Client_Credentials\x27\x20','Title','sheet_to_row_object_array','PATCH','#UploadedItems','application/x-www-form-urlencoded','byteLength','Location','#added','.form-check-input','SPClientPeoplePickerDict','application/json;odata=nometadata',')/users','OfficeLocationId','<input\x20type=\x22checkbox\x22\x20class=\x22\x22\x20disabled\x20/>','Audience','ajax','\x27)/GetItemById(\x27','#btnFilter','171PiqqmI','PrincipalAccountType','Invalid\x20Profile','remove','deselectRow','fromCharCode','SP.User','__next','getElementById','application/json;\x20odata=verbose','appendChild','AssaginTomanager','Gender','Postal\x20Address','DepartmentNameDetail','Not\x20SP\x20Permission','done','User,DL,SecGroup,SPGroup','length','/_api/web/lists/getByTitle(\x27','getValue','#example-table','EmployeeID','\x20,\x20','Internal\x20Users','.breakpoint','message','promise','split','files','#dvExcel','EmployeeOfficeLocation','stringify','CompanyIDId','checked','findIndex','SP.Data.','#UploadExcel','Location\x20*','#btnDownLoadReport','left','Designation','Total\x20Row\x20Count:\x20','ListItem','DepartmentsId','results','fileUpload','</span>','NotSave','PIN/ZIP','.select-row_IsMiisingSelected','251px','filter','2846538qlnzkW','toLowerCase','Manager\x20*','#Error','GET','OfficeName','row','Status','reject','focus','ddlDepartment','Name','click','#chkManager','target','error1','Approved','Company\x20Id\x20is\x20not\x20Correct','Announcement_Type','City','Required\x20Value\x20Missing','center','onclick','DOJ:\x20','Width','ChangeFileName','ddlOfficeLocation','getElement','#successfully_notifications','Departments','Manager','application/json','Department\x20*','DepartmentName','ddlfilterAllCompanies','#upload','chkManager','<input\x20type=\x22checkbox\x22\x20class=\x22select-row_IsMiisingSelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>','Office\x20Location\x20Id\x20is\x20not\x20Correct','width','siteAbsoluteUrl','SPClientPeoplePicker_InitStandaloneControlWrapper','fadeIn','getSelectedRows','Description','selectRow','/_api/web/siteusers(@v)?@v=\x27','2jBypjR','2568622WpMCqX','User\x20Added','find','/_api/web/lists/GetByTitle(\x27','application/json;odata=verbose','/_api/web/lists/getbytitle(\x27ExternalUsers\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=(ValidUpto\x20ge\x20\x27','responseText','setData','</option>','option','modal','#btnAudience','Chief\x20Executive','Metadata','Publish_Date','/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id','Companies','EmployeeDepartment','Group\x20Name','resolve','OfficeNameDetail','<h3\x20class=\x27m-0\x27>','73410mggOSk','readAsBinaryString','Email(Other)','indexOf','279688NSZuwN','/_api/web/siteusers?$top=1000&$select=*,Id','Ready','#isReadeySelected','EmpUserId','Department','Welcome','EntityData','color-red','\x27)/items','change','Date\x20Of\x20Joining','FullName','OfficeLocation','Deferred','text','select#dropDownId\x20option:selected','Select\x20Company','\x20<span\x20style=\x27color:green;\x20font-weight:bold;\x27>','mm/dd/yy','i:0#.f|membership|','Please\x20select\x20Department','Email\x20*','Your\x20License\x20limit\x20has\x20been\x20ended','readAsArrayBuffer','#btnfiltervalue','#chkTopExecutive','Please\x20upload\x20xlsx\x20file','getQueryStringParameter','#ddlDepartment','\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20','chkOfficeLocation','#Ready','Mobile','#ddlfilterAllCompanies','#__REQUESTDIGEST','New\x20Joinee','</h3>\x20<p\x20class\x20=\x20\x22m-0\x22\x20>\x20Uploaded\x20</p>','#ddlfilterOfficeLocation','undefined','https://graph.microsoft.com/.default','AllowMultipleValues','fitColumns','Expires','formatDate','#overlaysearch','createElement','<input\x20type=\x22checkbox\x22\x20id=\x22IsMiisingSelected\x22\x20onclick=\x22IsMiisingSelecteds()\x22\x20/>','10%','#AvilableLicenses','_cell','Home\x20Address','Type','https://graph.microsoft.com/v1.0/users?$filter=mail\x20eq\x20\x27','/_api/web/lists/getByTitle(\x27DepartmentalDMS\x27)/roleassignments/addroleassignment(principalid=','Please\x20select\x20Location','input[type=radio][name=datasend]','Active','Designation\x20*','chkTopExecutive','#btnmissingrequedvalue'];a0_0x184d=function(){return _0x38a53d;};return a0_0x184d();}var EmployeeListUsers=[],GetQueryURL=_spPageContextInfo[a0_0x12a6b4(0x15c)]+a0_0x12a6b4(0x197);function GetEmployees(){var _0x39f6f8=a0_0x12a6b4;$[_0x39f6f8(0x1c6)]({'url':GetQueryURL,'headers':{'Accept':_0x39f6f8(0xf4)},'async':![],'beforeSend':function(){},'success':function(_0x4b7341){var _0x5a9afb=_0x39f6f8;EmployeeListUsers=EmployeeListUsers[_0x5a9afb(0x1a3)](_0x4b7341['d'][_0x5a9afb(0x1f6)]);if(_0x4b7341['d'][_0x5a9afb(0x1d0)]!=null)GetQueryURL=_0x4b7341['d']['__next'],GetEmployees();else{GetQueryURL=_spPageContextInfo[_0x5a9afb(0x15c)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=999&$select=ID,AttachmentFiles,FullName,Designation,Manager,MobileNumber,ExtensionName,Email,LogonName/UserName,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department,AttachmentFiles\x20&$filter=\x20PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20';var _0x246674=0x0,_0x28f44c=_spPageContextInfo[_0x5a9afb(0x15c)]+_0x5a9afb(0xf5)+new Date()['toISOString']()+_0x5a9afb(0x1a2);extdfds=$[_0x5a9afb(0x118)](),$[_0x5a9afb(0x192)](getItems(_0x28f44c,extdfds))[_0x5a9afb(0x1d9)](function(_0x1d9fd0){var _0x4afb05=_0x5a9afb;response=[],_0x246674=_0x1d9fd0[_0x4afb05(0x1db)];});}_0x246674!=undefined?AvilableLicenses=parseInt(UsersLicenceRequired)-(parseInt(EmployeeListUsers[_0x5a9afb(0x1db)])+parseInt(_0x246674)):AvilableLicenses=parseInt(UsersLicenceRequired)-parseInt(EmployeeListUsers[_0x5a9afb(0x1db)]);},'error':function(_0x494b1e){var _0x49eaeb=_0x39f6f8;console[_0x49eaeb(0x1a9)](_0x494b1e);}});}var fileUploadevent=document[a0_0x12a6b4(0x1d1)](a0_0x12a6b4(0x1f7));fileUploadevent[a0_0x12a6b4(0x214)]=function(){var _0x4fa32e=a0_0x12a6b4;EmployeeListUsers=[],AvilableLicenses=0x0,this[_0x4fa32e(0x187)]=null;},fileUploadevent[a0_0x12a6b4(0x158)]=function(){var _0x32ca33=a0_0x12a6b4;$[_0x32ca33(0x1c6)]({'cache':![],'beforeSend':function(){var _0x38b17d=_0x32ca33;$(_0x38b17d(0x137))[_0x38b17d(0xea)]();},'success':function(_0x5526c3){var _0x2cad4e=_0x32ca33,_0x202c90=document[_0x2cad4e(0x1d1)](_0x2cad4e(0x1f7));AzureUsrlist[_0x2cad4e(0x1db)]==0x0&&GetAzureUsrlist(AdusersUrl,token);AvilableLicenses=0x0,GetEmployees(),LoadShowUser([]),Ready=0x0,Error=0x0,lblUpdate=0x0,counusers=0x0,Exits=0x0,$(_0x2cad4e(0x12a))[_0x2cad4e(0x119)](0x0),$('#Error')['text'](0x0),$(_0x2cad4e(0x1be))[_0x2cad4e(0x119)](0x0),$(_0x2cad4e(0x162))[_0x2cad4e(0x119)](0x0),$('#Exits')[_0x2cad4e(0x119)](0x0);var _0x56151f=/^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;if(_0x56151f[_0x2cad4e(0x198)](_0x202c90[_0x2cad4e(0x187)]['toLowerCase']())){if(typeof FileReader!=_0x2cad4e(0x131)){var _0x1c73b8=new FileReader();_0x1c73b8[_0x2cad4e(0x107)]?(_0x1c73b8[_0x2cad4e(0x17a)]=function(_0x302b82){var _0x2ebc5a=_0x2cad4e;ProcessExcel(_0x302b82[_0x2ebc5a(0x20c)]['result']);},_0x1c73b8[_0x2cad4e(0x107)](_0x202c90[_0x2cad4e(0x1e6)][0x0])):(_0x1c73b8[_0x2cad4e(0x17a)]=function(_0x3343af){var _0x18d675=_0x2cad4e,_0x34d532='',_0x2418ce=new Uint8Array(_0x3343af['target'][_0x18d675(0x19f)]);for(var _0x5a0cb0=0x0;_0x5a0cb0<_0x2418ce[_0x18d675(0x1bc)];_0x5a0cb0++){_0x34d532+=String[_0x18d675(0x1ce)](_0x2418ce[_0x5a0cb0]);}ProcessExcel(_0x34d532);},_0x1c73b8[_0x2cad4e(0x122)](_0x202c90[_0x2cad4e(0x1e6)][0x0]));}else alert(_0x2cad4e(0x1a1));}else alert(_0x2cad4e(0x152));$('#overlaysearch')[_0x2cad4e(0x163)]();}});},$(function(){var _0x1a3eab=a0_0x12a6b4;$(_0x1a3eab(0x221))['click'](function(){var _0x207cb5=_0x1a3eab,_0x243d48=document['getElementById'](_0x207cb5(0x1f7));GetEmployees(),LoadShowUser([]),Ready=0x0,Error=0x0,counusers=0x0;var _0x18f425=/^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;if(_0x18f425[_0x207cb5(0x198)](_0x243d48[_0x207cb5(0x187)]['toLowerCase']())){if(typeof FileReader!=_0x207cb5(0x131)){var _0x1f4ec6=new FileReader();_0x1f4ec6['readAsBinaryString']?(_0x1f4ec6[_0x207cb5(0x17a)]=function(_0x2f194e){var _0x5a57fc=_0x207cb5;ProcessExcel(_0x2f194e[_0x5a57fc(0x20c)][_0x5a57fc(0x19f)]);},_0x1f4ec6[_0x207cb5(0x107)](_0x243d48[_0x207cb5(0x1e6)][0x0])):(_0x1f4ec6[_0x207cb5(0x17a)]=function(_0x162b98){var _0x3c2c7f=_0x207cb5,_0x5a419d='',_0x294504=new Uint8Array(_0x162b98[_0x3c2c7f(0x20c)][_0x3c2c7f(0x19f)]);for(var _0x47d973=0x0;_0x47d973<_0x294504[_0x3c2c7f(0x1bc)];_0x47d973++){_0x5a419d+=String[_0x3c2c7f(0x1ce)](_0x294504[_0x47d973]);}ProcessExcel(_0x5a419d);},_0x1f4ec6[_0x207cb5(0x122)](_0x243d48[_0x207cb5(0x1e6)][0x0]));}else alert(_0x207cb5(0x1a1));}else alert(_0x207cb5(0x152));});});function ProcessExcel(_0x4e5b8d){var _0x5881f3=a0_0x12a6b4,_0x4c0041=XLSX[_0x5881f3(0x170)](_0x4e5b8d,{'type':_0x5881f3(0x14e)}),_0x2af68a=_0x4c0041[_0x5881f3(0x184)][0x0];excelRows=XLSX['utils'][_0x5881f3(0x1b8)](_0x4c0041['Sheets'][_0x2af68a]),$(_0x5881f3(0x1ba))['empty'](),$('#UploadedItems')['append'](_0x5881f3(0x105)+excelRows[_0x5881f3(0x1db)]+_0x5881f3(0x12f)),$(_0x5881f3(0x1e7))[_0x5881f3(0x18a)]('');for(var _0x95e39b=0x0;_0x95e39b<excelRows[_0x5881f3(0x1db)];_0x95e39b++){var _0x4a85ad='';ErrorUser='';var _0x446502=EmployeeListUsers[_0x5881f3(0x1fd)](function(_0x8be20f){var _0x5d0b37=_0x5881f3,_0x4cc8bc=_0x8be20f[_0x5d0b37(0x14f)][_0x5d0b37(0x1ff)]();return _0x4cc8bc==excelRows[_0x95e39b][_0x5d0b37(0x120)]['toLowerCase']();});if(_0x446502[_0x5881f3(0x1db)]>0x0){_0x4a85ad=_0x446502[0x0]['FullName'],color_red=_0x5881f3(0x112),ErrorUser=_0x5881f3(0x196),Exits=Exits+0x1;var _0x4f62b8=_0x446502[0x0]['ID'];excelRows[_0x95e39b][_0x5881f3(0x17e)]='-',excelRows[_0x95e39b][_0x5881f3(0x21e)]='-',excelRows[_0x95e39b]['Location\x20*']='-';}else{var _0xd23eda=AzureUsrlist['filter'](function(_0x1dc6fa){var _0x439a20=_0x5881f3;if(_0x1dc6fa[_0x439a20(0x14d)]!=null){var _0x213cd8=_0x1dc6fa[_0x439a20(0x14d)][_0x439a20(0x1ff)]();return _0x213cd8==excelRows[_0x95e39b][_0x439a20(0x120)][_0x439a20(0x1ff)]();}});if(_0xd23eda[_0x5881f3(0x1db)]>0x0){_0x4a85ad=_0xd23eda[0x0][_0x5881f3(0x181)];var _0x36554d=AllCompanies[_0x5881f3(0x1fd)](function(_0x4cb8d6){return _0x4cb8d6['ID']==excelRows[_0x95e39b]['Company\x20*'];}),_0x4b4cef=AllDepartments['filter'](function(_0x442257){var _0x15db0a=_0x5881f3;return _0x442257['ID']==excelRows[_0x95e39b][_0x15db0a(0x21e)];}),_0x24a663=AllOfficeLocation['filter'](function(_0x1fb715){var _0x398e1e=_0x5881f3;return _0x1fb715['ID']==excelRows[_0x95e39b][_0x398e1e(0x1ef)];});_0x36554d['length']>0x0&&_0x4b4cef[_0x5881f3(0x1db)]>0x0&&_0x24a663[_0x5881f3(0x1db)]>0x0?(Ready=Ready+0x1,ErrorUser=_0x5881f3(0x10c),excelRows[_0x95e39b]['DepartmentNameDetail']=_0x4b4cef[0x0][_0x5881f3(0x21f)],excelRows[_0x95e39b][_0x5881f3(0x104)]=_0x24a663[0x0][_0x5881f3(0x203)]):(ErrorUser=_0x5881f3(0x212),Error=Error+0x1);}else ErrorUser='Invalid\x20Profile',color_red='color-red',Error=Error+0x1;}excelRows[_0x95e39b][_0x5881f3(0x209)]=_0x4a85ad,excelRows[_0x95e39b]['id']=_0x95e39b,excelRows[_0x95e39b][_0x5881f3(0x205)]=ErrorUser,excelRows[_0x95e39b][_0x5881f3(0x10e)]=_0x4f62b8;}alluserdata=excelRows,LoadShowUser(excelRows);}function CompaniesDetails(){var _0x52c8f7=a0_0x12a6b4,_0xc72838=document[_0x52c8f7(0x1d1)](_0x52c8f7(0x1b2));_0xc72838[_0x52c8f7(0x19b)]='',opt['value']='0',opt[_0x52c8f7(0x119)]=_0x52c8f7(0x11b),_0xc72838[_0x52c8f7(0x1d3)](opt);for(var _0x5b41c0=0x0;_0x5b41c0<AllCompanies[_0x52c8f7(0x1db)];_0x5b41c0++){var _0x416003=AllCompanies[_0x5b41c0]['CompanyName'],_0x3fe57e=AllCompanies[_0x5b41c0]['ID'];opt=document[_0x52c8f7(0x138)](_0x52c8f7(0xf9)),opt[_0x52c8f7(0x187)]=_0x3fe57e,opt['text']=_0x416003,_0xc72838[_0x52c8f7(0x1d3)](opt);}$(_0x52c8f7(0x1bf))[_0x52c8f7(0x1b3)](_0x52c8f7(0x1eb),![]),$('#txtmanager')[_0x52c8f7(0x1a6)](''),$(_0x52c8f7(0x1aa))['val'](''),$(_0x52c8f7(0x185))[_0x52c8f7(0x1a6)]('');}function a0_0x3b66(_0x43d336,_0x37cdf1){var _0x184da9=a0_0x184d();return a0_0x3b66=function(_0x3b6685,_0x55e4b6){_0x3b6685=_0x3b6685-0xe5;var _0xc1fff2=_0x184da9[_0x3b6685];return _0xc1fff2;},a0_0x3b66(_0x43d336,_0x37cdf1);}$(a0_0x12a6b4(0x164))[a0_0x12a6b4(0x20a)](function(){var _0x8b183b=a0_0x12a6b4,_0x4d7f9d=tabledata[_0x8b183b(0xeb)]();debugger;_0x4d7f9d[_0x8b183b(0x1db)]>0x0?(CompaniesDetails(),$(_0x8b183b(0x1ee))[_0x8b183b(0xfa)](_0x8b183b(0x161)),initializePeoplePicker(_0x8b183b(0x1d4)),peoplePickerDiv=$('[id$=\x27AssaginTomanager_TopSpan\x27]')):alert(_0x8b183b(0x167));});var GetDepartments,Getofficelocation,GetDesignation,GetGroup,CompaniesId;$(a0_0x12a6b4(0x146))['click'](function(){var _0x9b1bf8=a0_0x12a6b4;if(document[_0x9b1bf8(0x1d1)]('chkDepartment')[_0x9b1bf8(0x1eb)]==!![]||document[_0x9b1bf8(0x1d1)](_0x9b1bf8(0x129))[_0x9b1bf8(0x1eb)]==!![]||document[_0x9b1bf8(0x1d1)](_0x9b1bf8(0x1ab))['checked']==!![]||document['getElementById']('chkManager')[_0x9b1bf8(0x1eb)]==!![]||document[_0x9b1bf8(0x1d1)](_0x9b1bf8(0x145))['checked']==!![]||document[_0x9b1bf8(0x1d1)](_0x9b1bf8(0x178))[_0x9b1bf8(0x1eb)]==!![]){var _0x2b9aa4=tabledata['getSelectedRows'](),_0x179e17=SPClientPeoplePicker[_0x9b1bf8(0x1c0)][peoplePickerDiv[0x0]['id']],_0x31e9f8=_0x179e17[_0x9b1bf8(0x1b5)]();for(var _0x3497de=0x0;_0x3497de<_0x2b9aa4[_0x9b1bf8(0x1db)];_0x3497de++){var _0x589fc9=excelRows[_0x9b1bf8(0x1ec)](_0x5d048f=>_0x5d048f[_0x9b1bf8(0x120)]==_0x2b9aa4[_0x3497de][_0x9b1bf8(0x183)][_0x9b1bf8(0x153)][_0x9b1bf8(0x120)]);if(excelRows[_0x589fc9][_0x9b1bf8(0x205)]==_0x9b1bf8(0x196))excelRows[_0x589fc9]['Company\x20*']='-',excelRows[_0x589fc9]['Department\x20*']='-',excelRows[_0x589fc9][_0x9b1bf8(0x1ef)]='-',document['getElementById']('chkDesignation')[_0x9b1bf8(0x1eb)]&&(excelRows[_0x589fc9][_0x9b1bf8(0x144)]=$(_0x9b1bf8(0x185))['val']()),document['getElementById'](_0x9b1bf8(0x222))[_0x9b1bf8(0x1eb)]&&(excelRows[_0x589fc9][_0x9b1bf8(0x200)]=_0x31e9f8[0x0][_0x9b1bf8(0x111)][_0x9b1bf8(0x14f)]),document[_0x9b1bf8(0x1d1)](_0x9b1bf8(0x145))[_0x9b1bf8(0x1eb)]&&(excelRows[_0x589fc9]['Manager\x20*']=_0x9b1bf8(0xfc)),document['getElementById'](_0x9b1bf8(0x178))[_0x9b1bf8(0x1eb)]&&(excelRows[_0x589fc9][_0x9b1bf8(0x102)]=$(_0x9b1bf8(0x1aa))[_0x9b1bf8(0x1a6)]());else{if(excelRows[_0x589fc9][_0x9b1bf8(0x205)]==_0x9b1bf8(0x212)||excelRows[_0x589fc9]['Status']==_0x9b1bf8(0x10c)){document[_0x9b1bf8(0x1d1)]('chkDepartment')[_0x9b1bf8(0x1eb)]&&(excelRows[_0x589fc9][_0x9b1bf8(0x17e)]=CompaniesId,excelRows[_0x589fc9]['Department\x20*']=GetDepartments);document[_0x9b1bf8(0x1d1)](_0x9b1bf8(0x129))[_0x9b1bf8(0x1eb)]&&(excelRows[_0x589fc9][_0x9b1bf8(0x17e)]=CompaniesId,excelRows[_0x589fc9][_0x9b1bf8(0x1ef)]=Getofficelocation);document[_0x9b1bf8(0x1d1)]('chkDesignation')[_0x9b1bf8(0x1eb)]&&(excelRows[_0x589fc9][_0x9b1bf8(0x144)]=$(_0x9b1bf8(0x185))[_0x9b1bf8(0x1a6)]());document[_0x9b1bf8(0x1d1)](_0x9b1bf8(0x222))['checked']&&(excelRows[_0x589fc9]['Manager\x20*']=_0x31e9f8[0x0][_0x9b1bf8(0x111)]['Email']);document[_0x9b1bf8(0x1d1)](_0x9b1bf8(0x145))['checked']&&(excelRows[_0x589fc9][_0x9b1bf8(0x200)]=_0x9b1bf8(0xfc));document[_0x9b1bf8(0x1d1)](_0x9b1bf8(0x178))[_0x9b1bf8(0x1eb)]&&(excelRows[_0x589fc9]['Group\x20Name']=$(_0x9b1bf8(0x1aa))[_0x9b1bf8(0x1a6)]());var _0x209719=AllCompanies['filter'](function(_0x4c2c64){var _0x33b46c=_0x9b1bf8;return _0x4c2c64['ID']==excelRows[_0x589fc9][_0x33b46c(0x17e)];}),_0x54feea=AllDepartments[_0x9b1bf8(0x1fd)](function(_0x255929){var _0x110b1c=_0x9b1bf8;return _0x255929['ID']==excelRows[_0x589fc9][_0x110b1c(0x21e)];}),_0x50ac45=AllOfficeLocation[_0x9b1bf8(0x1fd)](function(_0x7fe1ef){var _0x51ac19=_0x9b1bf8;return _0x7fe1ef['ID']==excelRows[_0x589fc9][_0x51ac19(0x1ef)];});_0x209719[_0x9b1bf8(0x1db)]>0x0&&_0x54feea[_0x9b1bf8(0x1db)]>0x0&&_0x50ac45[_0x9b1bf8(0x1db)]>0x0?(Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x589fc9][_0x9b1bf8(0x205)]=_0x9b1bf8(0x10c)):(excelRows[_0x589fc9][_0x9b1bf8(0x205)]=_0x9b1bf8(0x212),Error=Error+0x1);}else excelRows[_0x589fc9][_0x9b1bf8(0x205)]=='Wrong\x20Manager'&&(document[_0x9b1bf8(0x1d1)](_0x9b1bf8(0x1ab))[_0x9b1bf8(0x1eb)]&&(excelRows[_0x589fc9]['Designation\x20*']=$(_0x9b1bf8(0x185))['val']()),document[_0x9b1bf8(0x1d1)]('chkManager')[_0x9b1bf8(0x1eb)]&&(excelRows[_0x589fc9]['Manager\x20*']=_0x31e9f8[0x0][_0x9b1bf8(0x111)][_0x9b1bf8(0x14f)]),document[_0x9b1bf8(0x1d1)](_0x9b1bf8(0x145))['checked']&&(excelRows[_0x589fc9][_0x9b1bf8(0x200)]=_0x9b1bf8(0xfc)),document[_0x9b1bf8(0x1d1)](_0x9b1bf8(0x178))[_0x9b1bf8(0x1eb)]&&(excelRows[_0x589fc9][_0x9b1bf8(0x102)]=$(_0x9b1bf8(0x1aa))['val']()),Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x589fc9][_0x9b1bf8(0x205)]=_0x9b1bf8(0x10c));}}tabledata[_0x9b1bf8(0xf7)](excelRows),tabledata['setPage'](pageIndex),$(_0x9b1bf8(0x1ee))[_0x9b1bf8(0xfa)](_0x9b1bf8(0x15f)),showmessage();}else alert(_0x9b1bf8(0x17c)),$(_0x9b1bf8(0x11a))[_0x9b1bf8(0x1a6)]();}),$('#ddlAllCompanies')[a0_0x12a6b4(0x114)](function(){var _0x178c06=a0_0x12a6b4;CompaniesId=parseInt($(_0x178c06(0x19a),$(this))[_0x178c06(0x1a6)]());var _0x1f12ed=AllOfficeLocation[_0x178c06(0x1fd)](function(_0x22411e){return _0x22411e['CompanyIDId']===CompaniesId;}),_0x581b05=document['getElementById'](_0x178c06(0x218));_0x581b05[_0x178c06(0x19b)]='';for(var _0x37a77c=0x0;_0x37a77c<_0x1f12ed[_0x178c06(0x1db)];_0x37a77c++){var _0x3603f0=_0x1f12ed[_0x37a77c][_0x178c06(0x203)],_0xcf8a4e=_0x1f12ed[_0x37a77c]['ID'];opt=document[_0x178c06(0x138)](_0x178c06(0xf9)),opt['value']=_0xcf8a4e,opt['text']=_0x3603f0,_0x581b05['appendChild'](opt);}Getofficelocation=parseInt($('option:selected',$(_0x178c06(0x15e)))[_0x178c06(0x1a6)]());var _0x541ee2=AllDepartments[_0x178c06(0x1fd)](function(_0x3acc78){var _0x105fba=_0x178c06;return _0x3acc78[_0x105fba(0x1ea)]===CompaniesId;}),_0x581b05=document[_0x178c06(0x1d1)](_0x178c06(0x208));_0x581b05[_0x178c06(0x19b)]='';for(var _0x37a77c=0x0;_0x37a77c<_0x541ee2[_0x178c06(0x1db)];_0x37a77c++){var _0x3603f0=_0x541ee2[_0x37a77c][_0x178c06(0x21f)],_0xcf8a4e=_0x541ee2[_0x37a77c]['ID'];opt=document[_0x178c06(0x138)]('option'),opt[_0x178c06(0x187)]=_0xcf8a4e,opt[_0x178c06(0x119)]=_0x3603f0,_0x581b05[_0x178c06(0x1d3)](opt);}GetDepartments=parseInt($('option:selected',$(_0x178c06(0x127)))[_0x178c06(0x1a6)]());}),$('#ddlDepartment')['change'](function(){var _0x312d74=a0_0x12a6b4;GetDepartments=parseInt($('option:selected',$(this))[_0x312d74(0x1a6)]());}),$('#ddlOfficeLocation')['change'](function(){Getofficelocation=parseInt($('option:selected',$(this))['val']());});function chkManagerevent(_0x2083b2){var _0x30e9af=a0_0x12a6b4;if(_0x2083b2[_0x30e9af(0x1eb)])$(_0x30e9af(0x124))[_0x30e9af(0x1b3)](_0x30e9af(0x1eb),![]),$(_0x30e9af(0x172))['removeProp']('readonly'),$(_0x30e9af(0x172))[_0x30e9af(0x207)]();else{}}var TopExecutive='';function chkTopExecutiveevent(_0x5dd647){var _0x46bcc8=a0_0x12a6b4;if(_0x5dd647[_0x46bcc8(0x1eb)])$(_0x46bcc8(0x20b))[_0x46bcc8(0x1b3)]('checked',![]),$(_0x46bcc8(0x172))[_0x46bcc8(0x1b3)]('readonly',!![]),$('#txtmanager')[_0x46bcc8(0x1a6)](''),TopExecutive=_0x46bcc8(0xfc);else{}}$(a0_0x12a6b4(0x1f0))[a0_0x12a6b4(0x20a)](function(){var _0xdc09f7=a0_0x12a6b4;tabledata['download']('xlsx',_0xdc09f7(0x14c),{'sheetName':'EmployeeSyncreport'});});var dvExcel=document[a0_0x12a6b4(0x1d1)](a0_0x12a6b4(0x1af));dvExcel['innerHTML']='';var outputArray=[];function removewithfilter(_0x5cf02b){var _0x404f64=a0_0x12a6b4;let _0x4d17ee=_0x5cf02b[_0x404f64(0x1fd)](function(_0x51305b,_0x1295c3,_0x2eec0a){var _0x28485c=_0x404f64;return _0x1295c3==_0x2eec0a[_0x28485c(0x109)](_0x51305b);});return _0x4d17ee;}function GetItemTypeForListName(_0x479830){var _0x778a21=a0_0x12a6b4;return _0x778a21(0x1ed)+_0x479830['charAt'](0x0)['toUpperCase']()+_0x479830[_0x778a21(0x1e5)]('\x20')[_0x778a21(0x16d)]('')[_0x778a21(0x194)](0x1)+_0x778a21(0x1f4);}var response=response||[];function getItems(_0x193f7a,_0x71c81){var _0x2a26c0=a0_0x12a6b4;return $['ajax']({'url':_0x193f7a,'type':_0x2a26c0(0x202),'async':![],'headers':{'accept':_0x2a26c0(0xf4)},'success':function(_0x40b0d6){var _0x1edc61=_0x2a26c0;response=response[_0x1edc61(0x1a3)](_0x40b0d6['d']['results']),_0x40b0d6['d']['__next']?(_0x193f7a=_0x40b0d6['d'][_0x1edc61(0x1d0)],getItems(_0x193f7a,_0x71c81)):_0x71c81[_0x1edc61(0x103)](response);},'error':function(_0x2317c8){var _0x176ec6=_0x2a26c0;_0x71c81[_0x176ec6(0x206)](_0x2317c8),console[_0x176ec6(0x1a9)](_0x2317c8);}}),_0x71c81[_0x2a26c0(0x1e4)]();}function ConvertddmmyyTommddyy(_0x2545a8){var _0x4bd9e9=a0_0x12a6b4;return _0x2545a8[_0x4bd9e9(0x1e5)]('/')[0x1]+'/'+_0x2545a8[_0x4bd9e9(0x1e5)]('/')[0x0]+'/'+_0x2545a8[_0x4bd9e9(0x1e5)]('/')[0x2];}function InsertWelcomeInAnnouncementList(_0x2a4bf1){var _0x542e8f=a0_0x12a6b4;$['ajax']({'url':_spPageContextInfo[_0x542e8f(0x15c)]+'/_api/web/lists/GetByTitle(\x27Announcements\x27)/items','type':_0x542e8f(0x189),'async':![],'data':JSON[_0x542e8f(0x1e9)](_0x2a4bf1),'headers':{'Accept':_0x542e8f(0xf4),'Content-Type':_0x542e8f(0xf4),'X-RequestDigest':$(_0x542e8f(0x12d))[_0x542e8f(0x1a6)](),'X-HTTP-Method':'POST'},'success':function(_0x248151,_0x40335d,_0x3d352b){var _0x2cd204=_0x542e8f;console[_0x2cd204(0x1a9)]('Data\x20Send\x20to\x20Announcements');},'error':function(_0x42b1ee){var _0x148412=_0x542e8f;console[_0x148412(0x1a9)](_0x42b1ee),console[_0x148412(0x1a9)](_0x148412(0x1a8)),currentDlg[_0x148412(0x1b0)]();}});}