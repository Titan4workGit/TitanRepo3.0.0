var a0_0x28c667=a0_0x1a6b;(function(_0x16b04a,_0x2f3d55){var _0x4e89ec=a0_0x1a6b,_0xfba939=_0x16b04a();while(!![]){try{var _0x502a41=-parseInt(_0x4e89ec(0xe5))/0x1*(parseInt(_0x4e89ec(0xe8))/0x2)+parseInt(_0x4e89ec(0x152))/0x3*(-parseInt(_0x4e89ec(0xf6))/0x4)+-parseInt(_0x4e89ec(0x19d))/0x5+parseInt(_0x4e89ec(0x110))/0x6+parseInt(_0x4e89ec(0xef))/0x7+-parseInt(_0x4e89ec(0x16d))/0x8*(-parseInt(_0x4e89ec(0x120))/0x9)+-parseInt(_0x4e89ec(0x16a))/0xa*(-parseInt(_0x4e89ec(0x11b))/0xb);if(_0x502a41===_0x2f3d55)break;else _0xfba939['push'](_0xfba939['shift']());}catch(_0xb21f0f){_0xfba939['push'](_0xfba939['shift']());}}}(a0_0xcc01,0xce343));var clientContext='',oNewWebsite='',departmentID='',companyID='',siteURLProjects='',siteUrl='',siteclientContext='',projectInternalName='';stackToUsers='',sponsorToUsers='',alluser='',projecttouser='';var IsProjectAdmin=![],IsdeptAdmin=![];$(document)['ready'](function(){var _0x131ccf=a0_0x1a6b;$[_0x131ccf(0x128)](getProjectRights())[_0x131ccf(0xad)](function(_0x5a8fa8){var _0x4764c7=_0x131ccf;if(_0x5a8fa8)SP[_0x4764c7(0x105)][_0x4764c7(0xd3)](Initialization_ProjectSite,_0x4764c7(0x149));else IsDepartmentAdmin()==!![]?SP[_0x4764c7(0x105)][_0x4764c7(0xd3)](Initialization_ProjectSite,_0x4764c7(0x149)):(alert('Unauthorized\x20access!'),window['location'][_0x4764c7(0x12f)]=_0x4764c7(0xfe)+titanForWork[_0x4764c7(0x162)](_0x4764c7(0x183))+'');});}),$(document)[a0_0x28c667(0x165)](function(){var _0x34f0c7=a0_0x28c667;companyID=titanForWork[_0x34f0c7(0x162)](_0x34f0c7(0x183)),$(_0x34f0c7(0x179))['on']('click',function(){var _0x34d9f4=_0x34f0c7;$(_0x34d9f4(0xca))[_0x34d9f4(0xfd)](_0x34d9f4(0x15e));}),$(_0x34f0c7(0xf2))['on']('click',function(){var _0x2c5ae3=_0x34f0c7;$(_0x2c5ae3(0xca))[_0x2c5ae3(0xf0)]();});function _0x1a92c7(_0x1971d4){var _0x5414a4=_0x34f0c7;return $('#'+_0x1971d4)[_0x5414a4(0xc3)]('dt\x20a\x20span.value')[_0x5414a4(0xcc)]();}$(document)[_0x34f0c7(0x14c)](_0x34f0c7(0x92),function(_0x54aa60){var _0x8e59db=_0x34f0c7,_0x2b43d0=$(_0x54aa60[_0x8e59db(0x180)]);if(!_0x2b43d0['parents']()[_0x8e59db(0x116)]('dropdown'))$(_0x8e59db(0xca))[_0x8e59db(0xf0)]();}),$(_0x34f0c7(0x150))[_0x34f0c7(0x19b)](_0x34f0c7(0x96),!![]),$(_0x34f0c7(0xba))[_0x34f0c7(0xf0)](),$(_0x34f0c7(0x98))['datepicker']({'changeMonth':!![],'changeYear':!![],'yearRange':'-50:+50'}),$(_0x34f0c7(0x98))[_0x34f0c7(0x15b)](_0x34f0c7(0xcd),'dateFormat',_0x34f0c7(0xa5)),$(_0x34f0c7(0x13b))[_0x34f0c7(0x15b)]({'changeMonth':!![],'changeYear':!![],'yearRange':_0x34f0c7(0x18e)}),$(_0x34f0c7(0x13b))[_0x34f0c7(0x15b)]('option',_0x34f0c7(0x196),'dd/mm/yy'),$(_0x34f0c7(0x17f))[_0x34f0c7(0x15b)]({'changeMonth':!![],'changeYear':!![],'yearRange':_0x34f0c7(0x18e)}),$(_0x34f0c7(0x17f))[_0x34f0c7(0x15b)](_0x34f0c7(0xcd),'dateFormat',_0x34f0c7(0xa5)),$(_0x34f0c7(0x12a))[_0x34f0c7(0x15b)]({'changeMonth':!![],'changeYear':!![],'yearRange':'-50:+50'}),$('.txtActualEndDate')[_0x34f0c7(0x15b)](_0x34f0c7(0xcd),_0x34f0c7(0x196),'dd/mm/yy'),$(_0x34f0c7(0xa6))[_0x34f0c7(0x182)](function(){var _0x334549=_0x34f0c7,_0x51d6b3=$(_0x334549(0xa6))[_0x334549(0x11c)]();$['trim']($('#txtProjectName')['val']())!=''&&CheckProjectCodeExistOrNot('True',_0x51d6b3);}),$(_0x34f0c7(0xd2))[_0x34f0c7(0x182)](function(){var _0x33c1f4=_0x34f0c7,_0x34d604=$(_0x33c1f4(0xd2))[_0x33c1f4(0x11c)]();$['trim']($('#txtProjectCode')[_0x33c1f4(0x11c)]())!=''&&CheckProjectCodeExistOrNot(_0x33c1f4(0x130),_0x34d604);});var _0x34249e=new Array();_0x34249e['push'](0x8),_0x34249e[_0x34f0c7(0x13a)](0x9),_0x34249e[_0x34f0c7(0x13a)](0x2e),_0x34249e[_0x34f0c7(0x13a)](0x24),_0x34249e['push'](0x23),_0x34249e[_0x34f0c7(0x13a)](0x25),_0x34249e['push'](0x27),_0x34249e['push'](0x20),$('#txtProjectName')[_0x34f0c7(0x14a)](function(_0x4b9204){var _0x75ad2a=_0x34f0c7,_0x5c926f=_0x4b9204[_0x75ad2a(0x129)]==0x0?_0x4b9204['charCode']:_0x4b9204['keyCode'],_0x23b151=_0x5c926f==0x2d||_0x5c926f==0x26||_0x5c926f==0x5f||_0x5c926f>=0x30&&_0x5c926f<=0x39||_0x5c926f>=0x41&&_0x5c926f<=0x5a||_0x5c926f>=0x61&&_0x5c926f<=0x7a||_0x34249e[_0x75ad2a(0x101)](_0x4b9204[_0x75ad2a(0x129)])!=-0x1&&_0x4b9204[_0x75ad2a(0x184)]!=_0x4b9204[_0x75ad2a(0x129)]||_0x4b9204[_0x75ad2a(0x129)]==0x20;return _0x23b151;});});function getmultiselctValue(){var _0x588df8=a0_0x28c667;$(_0x588df8(0x11f))['on'](_0x588df8(0x92),function(){var _0x50ad30=_0x588df8,_0x2d8357=$(this)[_0x50ad30(0x12e)](_0x50ad30(0x17c))[_0x50ad30(0xc3)](_0x50ad30(0x119))[_0x50ad30(0x11c)](),_0x2d8357=$(this)['val']()+',';if($(this)['is'](':checked')){var _0x14cae0=_0x50ad30(0xf9)+_0x2d8357+'\x22>'+_0x2d8357+'</span>';$(_0x50ad30(0x13c))[_0x50ad30(0xff)](_0x14cae0),$(_0x50ad30(0x190))['hide']();}else{$(_0x50ad30(0x18d)+_0x2d8357+'\x22]')[_0x50ad30(0xb4)]();var _0x1caeeb=$(_0x50ad30(0x190));$('.dropdown\x20dt\x20a')[_0x50ad30(0xff)](_0x1caeeb);}});}function Initialization_ProjectSite(){var _0xacd46b=a0_0x28c667;InitializePeoplePicker('ProjectManagerEmployeePicker',![]),InitializePeoplePicker(_0xacd46b(0xc5),!![]),InitializePeoplePicker(_0xacd46b(0xdc),!![]),departmentID=titanForWork[_0xacd46b(0x162)](_0xacd46b(0x103)),companyID=titanForWork[_0xacd46b(0x162)]('CompanyId'),companyID>0x0&&getCurrentURL_EventCreateProjectSite('Companies',companyID),$(_0xacd46b(0xe7))[_0xacd46b(0x92)](function(){RedirectToListViewPage();});}function getCurrentURL_EventCreateProjectSite(_0x197330,_0x7c5818){var _0x28caf1=a0_0x28c667;siteURLProjects=_spPageContextInfo[_0x28caf1(0x12c)]+'/_api/web/lists/getbytitle(\x27'+_0x197330+_0x28caf1(0x134)+_0x7c5818+'\x27',$[_0x28caf1(0xb1)]({'url':siteURLProjects,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x48ada6){var _0x3dc550=_0x28caf1,_0x53d53b=_0x48ada6['d'][_0x3dc550(0x14f)];_0x53d53b[_0x3dc550(0x18c)]>0x0&&(siteURL=_0x53d53b[0x0][_0x3dc550(0x154)],siteclientContext=new SP['ClientContext'](siteURL),siteURLProjects=_0x53d53b[0x0]['SiteURL'],siteURLProjects=siteURLProjects+_0x3dc550(0xe9),clientContext=new SP[(_0x3dc550(0xde))](siteURLProjects),getConsultantDetails(siteclientContext),officeLocation(),getClientMaster(),getDepartment(),bindProjectType());},'eror':function(_0x4b7568){var _0x681bc3=_0x28caf1;console[_0x681bc3(0x94)]($(_0x681bc3(0xa9))['val']());}});}function getDepartment(){var _0x1c5aeb=a0_0x28c667,_0x418ec6=titanForWork[_0x1c5aeb(0x162)](_0x1c5aeb(0x183)),_0x3c6992=new SP[(_0x1c5aeb(0xde))](),_0x1a33d6=_0x3c6992['get_web']()[_0x1c5aeb(0x16c)]()[_0x1c5aeb(0xb2)]('Departments'),_0x21a1ae=new SP['CamlQuery'](),_0x38f29d='<View><Query><Where><Eq><FieldRef\x20Name=\x27CompanyID\x27\x20/><Value\x20Type=\x27Lookup\x27>'+_0x418ec6+_0x1c5aeb(0x14d);_0x21a1ae[_0x1c5aeb(0x173)](_0x38f29d);var _0x779d05=_0x1a33d6[_0x1c5aeb(0xa4)](_0x21a1ae);_0x3c6992[_0x1c5aeb(0x10f)](_0x779d05),_0x3c6992[_0x1c5aeb(0x19e)](function(){var _0x48525e=_0x1c5aeb,_0x2f4c3f=_0x779d05['getEnumerator'](),_0x30ca84=0x1,_0x461d4b=_0x48525e(0xd5);_0x461d4b+='<option\x20value=\x220\x22>-Select-</option>';while(_0x2f4c3f['moveNext']()){var _0x1e4144=_0x2f4c3f[_0x48525e(0xd8)](),_0x52c333=_0x1e4144['get_item']('ID'),_0x31d937=_0x1e4144[_0x48525e(0x109)](_0x48525e(0xf7));_0x461d4b+=_0x48525e(0x194)+_0x52c333+'\x22>'+_0x31d937+_0x48525e(0xd0),_0x30ca84++;}_0x461d4b+='</select>',$(_0x48525e(0xbe))['append'](_0x461d4b),IsdeptAdmin==!![]&&($(_0x48525e(0x198))['val'](Logged_DepartmentId),$(_0x48525e(0x198))[_0x48525e(0x125)](_0x48525e(0x96),!![]));},function(){var _0x54eef7=_0x1c5aeb;console[_0x54eef7(0x94)](_0x54eef7(0xcb));});}function officeLocation(){var _0x20c26a=a0_0x28c667,_0x4fd6d9=titanForWork[_0x20c26a(0x162)]('CompanyId'),_0x421936=new SP[(_0x20c26a(0xde))](),_0x10855e=_0x421936['get_web']()['get_lists']()[_0x20c26a(0xb2)]('OfficeLocation'),_0x5f2ee0=new SP[(_0x20c26a(0x91))](),_0x493d59=_0x20c26a(0xa0)+_0x4fd6d9+_0x20c26a(0x122);_0x5f2ee0[_0x20c26a(0x173)](_0x493d59);var _0x322239=_0x10855e['getItems'](_0x5f2ee0);_0x421936[_0x20c26a(0x10f)](_0x322239),_0x421936[_0x20c26a(0x19e)](function(){var _0x3292e6=_0x20c26a,_0x492fc1=_0x322239['getEnumerator'](),_0x36a751=0x1,_0x3d9f3a=_0x3292e6(0x90);_0x3d9f3a+=_0x3292e6(0x15d);while(_0x492fc1[_0x3292e6(0x133)]()){var _0xaca2b8=_0x492fc1['get_current'](),_0x4b305a=_0xaca2b8[_0x3292e6(0x109)]('ID'),_0x40abab=_0xaca2b8[_0x3292e6(0x109)](_0x3292e6(0xc9));_0x3d9f3a+='<option\x20value=\x22'+_0x4b305a+'\x22>'+_0x40abab+'</option>',_0x36a751++;}_0x3d9f3a+=_0x3292e6(0x1a1),$('#officeLocation')['append'](_0x3d9f3a);},function(){var _0x37acd3=_0x20c26a;console[_0x37acd3(0x94)](_0x37acd3(0xcb));});}function getClientMaster(){var _0x4900e2=a0_0x28c667,_0x1873c3=titanForWork[_0x4900e2(0x162)](_0x4900e2(0x183)),_0x2349a4=new SP[(_0x4900e2(0xde))](),_0x21c512=_0x2349a4[_0x4900e2(0xce)]()[_0x4900e2(0x16c)]()[_0x4900e2(0xb2)](_0x4900e2(0xaa)),_0x76ebf0=new SP[(_0x4900e2(0x91))](),_0x505ea5=_0x4900e2(0xa0)+_0x1873c3+_0x4900e2(0x117);_0x76ebf0['set_viewXml'](_0x505ea5);var _0x44fecf=_0x21c512[_0x4900e2(0xa4)](_0x76ebf0);_0x2349a4['load'](_0x44fecf),_0x2349a4[_0x4900e2(0x19e)](function(){var _0x1fa07a=_0x4900e2;debugger;var _0x44ce31=_0x44fecf[_0x1fa07a(0x113)](),_0x211731=0x1,_0x29f39e=_0x1fa07a(0xaf);_0x29f39e+='<option\x20value=\x220\x22>Select\x20Customer</option>';while(_0x44ce31['moveNext']()){var _0x8b509a=_0x44ce31['get_current'](),_0x2b0d01=_0x8b509a[_0x1fa07a(0x109)]('ID'),_0x37b517=_0x8b509a[_0x1fa07a(0x109)]('Title');_0x29f39e+=_0x1fa07a(0x194)+_0x2b0d01+'\x22>'+_0x37b517+_0x1fa07a(0xd0),_0x211731++;}_0x29f39e+=_0x1fa07a(0x1a1),$('#clientNameDiv')[_0x1fa07a(0xff)](_0x29f39e),$('#clientName')[_0x1fa07a(0x15c)]({'placeholder':_0x1fa07a(0xda),'allowClear':![]});},function(){var _0x13667a=_0x4900e2;console[_0x13667a(0x94)](_0x13667a(0xcb));});}function getConsultantDetails(_0x3ee369){var _0x2e0ec4=a0_0x28c667,_0x590424=_0x3ee369['get_web']()[_0x2e0ec4(0x16c)]()['getByTitle'](_0x2e0ec4(0x157)),_0x16d4fd=new SP[(_0x2e0ec4(0x91))]();_0x16d4fd[_0x2e0ec4(0x173)](_0x2e0ec4(0x146));var _0x230509=_0x590424[_0x2e0ec4(0xa4)](_0x16d4fd);_0x3ee369[_0x2e0ec4(0x10f)](_0x230509),_0x3ee369[_0x2e0ec4(0x19e)](function(){var _0x34f31a=_0x2e0ec4,_0x55596e=_0x34f31a(0xbc),_0x38b930=_0x230509['getEnumerator'](),_0x15567a=_0x230509['get_count'](),_0x3a19ee=0x1;if(_0x15567a>0x0){while(_0x38b930[_0x34f31a(0x133)]()){var _0xcf97c6=_0x38b930['get_current'](),_0x200833=_0xcf97c6[_0x34f31a(0x109)](_0x34f31a(0x187));_0x55596e+='<li><input\x20type=\x22checkbox\x22\x20value='+_0x200833+_0x34f31a(0x147)+_0x200833+_0x34f31a(0x168),_0x3a19ee++;}_0x55596e+=_0x34f31a(0x138),$('.mutliSelect')[_0x34f31a(0xff)](_0x55596e),getmultiselctValue();}},function(){});}function getConsultantValue(){var _0x1607ad=a0_0x28c667,_0x4b610b='';return $(_0x1607ad(0x10a))[_0x1607ad(0x197)](function(){var _0xe1232a=_0x1607ad;_0x4b610b+=$(this)[_0xe1232a(0xcc)]();}),_0x4b610b;}$(function(){bindButtonClick();});function bindButtonClick(){var _0x16ecec=a0_0x28c667;$(_0x16ecec(0xf4))['on'](_0x16ecec(0x92),function(){var _0x3f13cb=_0x16ecec;debugger;var _0xa77338=$(_0x3f13cb(0xa6))[_0x3f13cb(0x11c)](),_0x2f446e=$(_0x3f13cb(0xd2))[_0x3f13cb(0x11c)](),_0x5c3fc4=$(_0x3f13cb(0xbe))['find'](_0x3f13cb(0x198))[_0x3f13cb(0x11c)](),_0x3ba3c1=$(_0x3f13cb(0x143))[_0x3f13cb(0xc3)](_0x3f13cb(0xc8))['val'](),_0x4c4dbd=$('.txtPlannedStartDate')[_0x3f13cb(0x11c)](),_0x4ec817=$(_0x3f13cb(0x13b))[_0x3f13cb(0x11c)](),_0x3a6fab=getPeopleUserInfoGroups(_0x3f13cb(0xdd));if(_0x3a6fab[_0x3f13cb(0x18c)]==0x0)return alert(_0x3f13cb(0xe3)),![];if(_0x3a6fab['length']==0x1){var _0x20aa9b=IsMangerActive(_0x3a6fab);if(!_0x20aa9b)return alert(_0x3f13cb(0xab)),_0x20aa9b='',![];else var _0x129e58=_0x3a6fab[0x0];}if(_0x3a6fab[_0x3f13cb(0x18c)]>0x1)return alert(_0x3f13cb(0x14e)),![];var _0x50f0e3=$('#txtDescription')[_0x3f13cb(0x11c)](),_0x549ab4=$(_0x3f13cb(0x158))[_0x3f13cb(0x8f)](),_0x54a8cd='';projectInternalName=GenerateGUID();_0x4c4dbd!=null&&_0x4c4dbd!=''&&(_0x54a8cd=GetDateStandardFormat(_0x4c4dbd));var _0x5a5389='';_0x4ec817!=null&&_0x4ec817!=''&&(_0x5a5389=GetDateStandardFormat(_0x4ec817));if(_0xa77338[_0x3f13cb(0x118)]()==''||_0x4c4dbd==''||_0x4ec817==''||$('#departmentDetails')[_0x3f13cb(0x11c)]()=='0'||_0x549ab4==_0x3f13cb(0xda))alert(_0x3f13cb(0xeb));else _0x5a5389>_0x54a8cd?(waitingDialog['show'](),createSite()):alert(_0x3f13cb(0x95));});}function createSite(){var _0x160804=a0_0x28c667,_0x5d4170=$('#txtProjectName')[_0x160804(0x11c)](),_0x5ec440=$(_0x160804(0x132))[_0x160804(0x11c)]();siteUrl=projectInternalName;var _0x1de020=clientContext[_0x160804(0xce)]()[_0x160804(0x18b)](),_0x58d23f=new SP[(_0x160804(0xd9))]();_0x58d23f[_0x160804(0x13f)](_0x5d4170),_0x58d23f[_0x160804(0x159)](_0x5ec440),_0x58d23f[_0x160804(0x167)](0x409),_0x58d23f[_0x160804(0x137)](siteUrl),_0x58d23f[_0x160804(0x178)](!![]),_0x58d23f['set_webTemplate'](_0x160804(0x10e)),_0x1de020['add'](_0x58d23f),clientContext[_0x160804(0x19e)](Function[_0x160804(0xb7)](this,this[_0x160804(0xe1)]),Function[_0x160804(0xb7)](this,this[_0x160804(0x9a)]));}function createSite2(){var _0x5c0e90=a0_0x28c667,_0x18de04=$('#txtProjectName')['val'](),_0x47f14a=$(_0x5c0e90(0x132))['val']();siteUrl=_0x18de04[_0x5c0e90(0x176)](/\s/g,'');var _0x4b45f4=clientContext[_0x5c0e90(0xce)]()[_0x5c0e90(0x18b)](),_0x5d7650=new SP['WebCreationInformation']();_0x5d7650[_0x5c0e90(0x13f)](_0x18de04),_0x5d7650['set_description'](_0x47f14a),_0x5d7650['set_language'](0x409),_0x5d7650[_0x5c0e90(0x137)](siteUrl),_0x5d7650[_0x5c0e90(0x178)](!![]),_0x5d7650[_0x5c0e90(0x10b)](_0x5c0e90(0x10e)),oNewWebsite=_0x4b45f4['add'](_0x5d7650),clientContext[_0x5c0e90(0x19e)](Function[_0x5c0e90(0xb7)](this,onQuerySucceeded_CreateProjectSite),Function[_0x5c0e90(0xb7)](this,this[_0x5c0e90(0x9a)]));}function onQuerySucceeded_CreateProjectSite(){createListItem();}function onQueryFailed_CreateProjectSite(_0x426765,_0x5f488a){var _0x818055=a0_0x28c667;alert(_0x818055(0x9e)+_0x5f488a[_0x818055(0xbf)]()+'\x0a'+_0x5f488a[_0x818055(0x126)]());}function GenerateGUID(){var _0x533eaa=a0_0x28c667;return _0x533eaa(0x188)['replace'](/[xy]/g,function(_0x39e3df){var _0x285729=_0x533eaa,_0x309e9f=parseFloat('0.'+Math['random']()[_0x285729(0x175)]()[_0x285729(0x176)]('0.','')+new Date()[_0x285729(0x136)]())*0x10|0x0,_0x75cacd=_0x39e3df=='x'?_0x309e9f:_0x309e9f&0x3|0x8;return _0x75cacd[_0x285729(0x175)](0x10);});}function CheckProjectCodeExistOrNot(_0x303b0d,_0x24341c){var _0x3ce4e4=a0_0x28c667,_0x41223f=titanForWork['getQueryStringParameter'](_0x3ce4e4(0x183)),_0x402773=_0x3ce4e4(0xf3),_0x1c3143={},_0x582dd2=![],_0x3efff1='';if(_0x303b0d=='True')_0x3efff1=_spPageContextInfo[_0x3ce4e4(0x12c)]+_0x3ce4e4(0x12b)+_0x41223f+_0x3ce4e4(0x97)+_0x24341c+'\x27';else _0x303b0d==_0x3ce4e4(0x130)&&(_0x3efff1=_spPageContextInfo[_0x3ce4e4(0x12c)]+_0x3ce4e4(0x100)+_0x24341c+_0x3ce4e4(0x106)+_0x41223f+'\x27');return $[_0x3ce4e4(0xb1)]({'url':_0x3efff1,'type':_0x402773,'data':_0x1c3143,'async':![],'headers':{'Accept':_0x3ce4e4(0x10d),'Content-Type':_0x3ce4e4(0x10d),'X-RequestDigest':$(_0x3ce4e4(0xa1))['val'](),'IF-MATCH':'*','X-HTTP-Method':null},'cache':![],'success':function(_0x2ccff3){var _0x1bf285=_0x3ce4e4,_0x470b07,_0x2a3ba2=_0x2ccff3['d'][_0x1bf285(0x14f)],_0x7d7678=_0x2ccff3['d'][_0x1bf285(0x14f)][_0x1bf285(0x18c)];_0x7d7678>0x0&&(alert(_0x1bf285(0xa3)),$('#txtProjectCode')[_0x1bf285(0x11c)](''),$(_0x1bf285(0xd2))['focus'](),$(_0x1bf285(0xa6))[_0x1bf285(0x11c)](''),$(_0x1bf285(0xa6))['focus']());},'error':function(_0x1d7ef0){var _0x32bc64=_0x3ce4e4;Helper[_0x32bc64(0xd6)]();}}),_0x582dd2;}function getPeopleUserInfoGroups(_0x6b444d){var _0x4af05e=a0_0x28c667,_0x1cbdd8=new Array(),_0x364dfb=$(_0x4af05e(0xb5)+_0x6b444d+'\x27]'),_0xcc1a18=SPClientPeoplePicker[_0x4af05e(0x9b)][_0x364dfb[0x1]['id']],_0x19db49=_0xcc1a18['GetAllUserInfo']();if(_0x19db49[_0x4af05e(0x18c)]>0x0)for(var _0x24df94=0x0;_0x24df94<_0x19db49['length'];_0x24df94++){_0x1cbdd8[_0x4af05e(0x13a)](GetUserIdGroups(_0x19db49[_0x24df94]['Key']));}return _0x1cbdd8;}function GetUserIdGroups(_0x5acdbc){var _0x28942c=a0_0x28c667,_0x2ea786='',_0x21ace5=_0x28942c(0x193),_0x3fda74=_spPageContextInfo['siteAbsoluteUrl'],_0x294e2e=_0x5acdbc;return $[_0x28942c(0xb1)]({'url':_0x3fda74+'/_api/web/siteusers(@v)?@v=\x27'+encodeURIComponent(_0x294e2e)+'\x27','method':_0x28942c(0xf3),'headers':{'Accept':_0x28942c(0xdb)},'async':![],'success':function(_0x3ec9ac){_0x2ea786=_0x3ec9ac['d']['Id'];},'error':function(_0x205bc7){console['log'](JSON['stringify'](_0x205bc7));}}),_0x2ea786;}function createListItem(){var _0x47d865=a0_0x28c667,_0x40d88b=new Array();_0x40d88b=getPeopleUserInfoGroups(_0x47d865(0xdc));if(_0x40d88b[_0x47d865(0x18c)]==0x0){}var _0x3c5791=new Array();_0x3c5791=getPeopleUserInfoGroups(_0x47d865(0xc5));if(_0x3c5791[_0x47d865(0x18c)]==0x0){}var _0x3f70d6=$('#txtProjectCode')[_0x47d865(0x11c)](),_0x454682=$('#txtProjectName')[_0x47d865(0x11c)](),_0xff3562=$(_0x47d865(0x16e))[_0x47d865(0x11c)](),_0x17402d=$('.txtPlannedStartDate')[_0x47d865(0x11c)](),_0xfaf318='';_0x17402d!=null&&_0x17402d!=''&&(_0xfaf318=GetDateStandardFormat(_0x17402d));var _0x2519d0=$(_0x47d865(0x13b))['val'](),_0x11d203='';_0x2519d0!=null&&_0x2519d0!=''&&(_0x11d203=GetDateStandardFormat(_0x2519d0));var _0x47a321=$(_0x47d865(0x17f))[_0x47d865(0x11c)](),_0x2a465d='';_0x47a321!=null&&_0x47a321!=''&&(_0x2a465d=GetDateStandardFormat(_0x47a321));txtDepartmentID=$(_0x47d865(0xbe))[_0x47d865(0xc3)](_0x47d865(0x198))['val'](),DepartmentFullName=$(_0x47d865(0xbe))[_0x47d865(0xc3)]('select#departmentDetails\x20option:selected')[_0x47d865(0x8f)](),txtofficeLocationID=$(_0x47d865(0x143))[_0x47d865(0xc3)](_0x47d865(0xc8))[_0x47d865(0x11c)](),OfficeFullName=$(_0x47d865(0x143))[_0x47d865(0xc3)](_0x47d865(0x10c))[_0x47d865(0x8f)]();var _0x2f19a8=getPeopleUserInfoGroups(_0x47d865(0xdd));if(_0x2f19a8[_0x47d865(0x18c)]==0x0)return alert(_0x47d865(0xe3)),![];_0x2f19a8['length']==0x1&&(txtManagerTeam=_0x2f19a8[0x0]);txtStackeholderTeam=$(_0x47d865(0xcf))[_0x47d865(0xc3)](_0x47d865(0x186))[_0x47d865(0x11c)](),txtSponsorTeam=$(_0x47d865(0xc2))[_0x47d865(0xc3)](_0x47d865(0x186))['val'](),txtProjectStatus=$(_0x47d865(0x150))[_0x47d865(0x11c)](),txtDomain=$('#txtDomain')[_0x47d865(0x11c)]();var _0x2e0ecd=$('#txtTechnology')[_0x47d865(0x11c)](),_0x1b08fb=$(_0x47d865(0x132))[_0x47d865(0x11c)](),_0x28f3b2=siteURLProjects+'/'+siteUrl,_0x5e88fe=getConsultantValue();AddNewTak(_0x47d865(0x99),_0x3f70d6,_0x454682,_0xff3562,_0xfaf318,_0x11d203,_0x2a465d,txtDepartmentID,DepartmentFullName,txtofficeLocationID,OfficeFullName,txtManagerTeam,txtStackeholderTeam,txtSponsorTeam,txtProjectStatus,_0x2e0ecd,_0x1b08fb,txtDomain,_0x5e88fe,_0x28f3b2,_0x40d88b,_0x3c5791);}function AddNewTak(_0x401045,_0x504127,_0x27ef96,_0x21ff3d,_0x53a2f3,_0x10132d,_0x5a72e9,_0x556811,_0x156ee8,_0xd6c307,_0x2ff7fb,_0x122eca,_0x46b4e5,_0x2c118b,_0x2b15bb,_0x354c26,_0x519870,_0x250a94,_0x22a0b4,_0x457d79,_0xa1445c,_0x1b4209){var _0x1646f1=a0_0x28c667;try{var _0x318eeb=titanForWork[_0x1646f1(0x162)](_0x1646f1(0x183)),_0x4b06a3,_0x45384a=GetItemTypeForListName(_0x401045);_0x4b06a3={'__metadata':{'type':_0x45384a},'Title':_0x27ef96,'ProjectCode':_0x504127,'ProjectName':_0x27ef96,'ProjectDescription':_0x519870,'ProjectSiteURL':_0x457d79,'DepartmentId':_0x556811,'Department_IDId':_0x556811,'ActualStartDate':_0x5a72e9,'PlanedStartDate':_0x53a2f3,'PlanedEndDate':_0x10132d,'TechnologyUsed':_0x354c26,'Status':_0x2b15bb,'DepartmentName':_0x156ee8,'ConsultantName':_0x22a0b4,'ManagerNameId':_0x122eca,'OfficeLocation':_0x2ff7fb,'Domain':_0x250a94,'OfficeLocationID':_0xd6c307,'Office_Location_IdId':_0xd6c307,'CompanyId':_0x318eeb,'MultipleStackeholderId':{'results':_0xa1445c},'MultipleSponsorId':{'results':_0x1b4209},'ProjectInternalName':projectInternalName,'ClientIDId':_0x21ff3d},(_0x5a72e9==null||_0x5a72e9=='')&&delete _0x4b06a3[_0x1646f1(0xfc)],(_0x10132d==null||_0x10132d=='')&&delete _0x4b06a3[_0x1646f1(0x160)],(_0x53a2f3==null||_0x53a2f3=='')&&delete _0x4b06a3['PlanedStartDate'],AddItemToList(_0x401045,_0x4b06a3,_0x122eca,_0x457d79,_0x53a2f3,_0x10132d);}catch(_0x53938c){console[_0x1646f1(0x94)](_0x53938c[_0x1646f1(0x163)]);}}function AddItemToList(_0x4ede12,_0x31661a,_0x4b32b6,_0x22d48e,_0x2a68d5,_0xb6c04a){var _0x24930b=a0_0x28c667,_0x3d99ee=$[_0x24930b(0x195)]();return $[_0x24930b(0xb1)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x24930b(0x185)+_0x4ede12+_0x24930b(0x148),'type':_0x24930b(0xb8),'async':![],'headers':{'accept':_0x24930b(0x10d),'X-RequestDigest':$(_0x24930b(0xa1))[_0x24930b(0x11c)](),'content-Type':_0x24930b(0x10d)},'data':JSON['stringify'](_0x31661a),'success':function(_0x30194d){var _0x10dfcc=_0x24930b,_0x38879e=_0x30194d['d']['ID'],_0x20aba6='';_0x30194d['d']['ProjectInternalName']==null||_0x30194d['d'][_0x10dfcc(0xc4)]==''?_0x20aba6=items[0x0][_0x10dfcc(0x166)]:_0x20aba6=_0x30194d['d'][_0x10dfcc(0xc4)],_0x3d99ee[_0x10dfcc(0x156)](_0x30194d),console[_0x10dfcc(0x94)](_0x10dfcc(0x127)),alert(_0x10dfcc(0x115)),waitingDialog[_0x10dfcc(0xf0)](),$[_0x10dfcc(0x128)](BreakInheritePermissionDMSLibrary(_0x4b32b6,'1073741829',_0x20aba6))['done'](function(_0x5a799){AddProjectManagerAsADefaultMemeber(_0x4b32b6,_0x2a68d5,_0xb6c04a,parseInt(_0x38879e)),GetTaskEmailTemplate(0x6),GetProjectDetails(_0x38879e),SendTaskEmail(),RedirectToListViewPage();});},'error':function(_0x268870){var _0x1685b5=_0x24930b;console[_0x1685b5(0x94)](JSON['stringify'](_0x268870)),_0x3d99ee[_0x1685b5(0x177)](_0x268870);}}),_0x3d99ee['promise']();}function AddProjectManagerAsADefaultMemeber(_0x2f3471,_0x86712e,_0x124f47,_0xd71b36){var _0x1b9559=a0_0x28c667,_0xc73a5e=$['Deferred'](),_0x25bd7c=_0x1b9559(0x112),_0x591d26=CreateMetadataForAddingProjectManager(_0x25bd7c,_0x2f3471,_0x86712e,_0x124f47,_0xd71b36),_0x303e24=_spPageContextInfo[_0x1b9559(0x12c)]+_0x1b9559(0x185)+_0x25bd7c+_0x1b9559(0x148),_0x5aac0f={'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x1b9559(0xa1))['val'](),'content-Type':_0x1b9559(0x10d)};return $[_0x1b9559(0xb1)]({'url':_0x303e24,'type':_0x1b9559(0xb8),'async':![],'headers':_0x5aac0f,'data':JSON[_0x1b9559(0xc0)](_0x591d26),'success':function(_0x3f6318){var _0x64570b=_0x1b9559;console['log'](_0x64570b(0x107));},'error':function(_0x32def5){var _0x5e758e=_0x1b9559;console['log'](data),_0xc73a5e[_0x5e758e(0x177)](_0x32def5);}}),_0xc73a5e[_0x1b9559(0x142)]();}function CreateMetadataForAddingProjectManager(_0x4d2fae,_0x510a2c,_0x11853c,_0x2c18e7,_0x51de99,_0x575931){var _0x361d8b=a0_0x28c667,_0x41fb54=GetItemTypeForListName(_0x4d2fae),_0x3316f3;return _0x3316f3={'__metadata':{'type':_0x41fb54}},_0x3316f3[_0x361d8b(0xb3)]=_0x51de99,_0x3316f3[_0x361d8b(0x170)]=_0x510a2c,_0x3316f3[_0x361d8b(0x145)]=_0x361d8b(0x13e),_0x3316f3[_0x361d8b(0x102)]=_0x11853c,_0x3316f3[_0x361d8b(0xb9)]=_0x2c18e7,_0x3316f3['TeamPermission']=!![],_0x3316f3[_0x361d8b(0xea)]=!![],_0x3316f3[_0x361d8b(0xee)]=!![],_0x3316f3[_0x361d8b(0x183)]=titanForWork[_0x361d8b(0x162)](_0x361d8b(0x183)),_0x3316f3;}function addManagerToSiteAdmin(_0x9649a3,_0x2db98f,_0x2c5d91){var _0x2044e7=a0_0x28c667,_0x5a02f7={'Accept':_0x2044e7(0x10d),'content-Type':_0x2044e7(0x10d),'X-RequestDigest':jQuery(_0x2044e7(0xa1))['val']()},_0x5a782b=_0x2db98f+'/_api/web/roleassignments/addroleassignment(principalid='+_0x9649a3+_0x2044e7(0x189)+_0x2c5d91+')';$[_0x2044e7(0xb1)]({'url':_0x5a782b,'type':_0x2044e7(0xb8),'headers':_0x5a02f7,'dataType':_0x2044e7(0x174),'async':![],'success':function(_0x33b5f8){var _0xc510d=_0x2044e7;console[_0xc510d(0x94)](_0xc510d(0xd7)),alert(_0xc510d(0x191)),waitingDialog[_0xc510d(0xf0)](),RedirectToListViewPage();},'error':function(_0x39df93){var _0x1ac76b=_0x2044e7;console[_0x1ac76b(0x94)](JSON[_0x1ac76b(0xc0)](_0x39df93));}});}function GetItemTypeForListName(_0x3f53fb){var _0x10da0a=a0_0x28c667;return _0x10da0a(0x16f)+_0x3f53fb[_0x10da0a(0xe2)](0x0)[_0x10da0a(0x141)]()+_0x3f53fb[_0x10da0a(0x8b)]('\x20')[_0x10da0a(0x11e)]('')['slice'](0x1)+_0x10da0a(0x140);}function GetDateStandardFormat(_0x1984c0){var _0x122c2a=a0_0x28c667,_0x580a5d=ConvertDateFormatToddMMyyyy(_0x1984c0),_0x758ac8=new Date(_0x580a5d),_0x1b8c71=0x3c*0x3c*0x18*0x3e8,_0xc59ab8=new Date(_0x758ac8[_0x122c2a(0x136)]()),_0x358a70=_0xc59ab8[_0x122c2a(0x181)]();return _0x358a70;}function ConvertDateFormatToddMMyyyy(_0x1274e3){var _0xe6f08=stringToDate(_0x1274e3,'dd/MM/yyyy','/');return _0xe6f08;}function stringToDate(_0x555bb9,_0x3db248,_0x2b68c4){var _0x1eb0e4=a0_0x28c667,_0x4b199b=_0x3db248['toLowerCase'](),_0x1360e7=_0x4b199b[_0x1eb0e4(0x8b)](_0x2b68c4),_0x5bd42e=_0x555bb9['split'](_0x2b68c4),_0x58fdde=_0x1360e7[_0x1eb0e4(0x101)]('mm'),_0x1d347a=_0x1360e7[_0x1eb0e4(0x101)]('dd'),_0x19ecaf=_0x1360e7[_0x1eb0e4(0x101)](_0x1eb0e4(0x18f)),_0x1426cd=parseInt(_0x5bd42e[_0x58fdde]);_0x1426cd-=0x1;var _0x56866a=new Date(_0x5bd42e[_0x19ecaf],_0x1426cd,_0x5bd42e[_0x1d347a]);return _0x56866a;}function RedirectToListViewPage(){var _0x43efe2=a0_0x28c667;companyID=titanForWork[_0x43efe2(0x162)](_0x43efe2(0x183)),location[_0x43efe2(0x12f)]=_spPageContextInfo[_0x43efe2(0x12c)]+'/Pages/ViewProjectGrid.aspx?WebAppId='+companyID;}function InitializePeoplePicker(_0x1b4c2c,_0x342c2d){var _0x68b104=a0_0x28c667;_0x342c2d==null&&(_0x342c2d=![]);var _0x159b4e={};_0x159b4e[_0x68b104(0x164)]='User',_0x159b4e[_0x68b104(0xe6)]=0xf,_0x159b4e[_0x68b104(0x161)]=0xf,_0x159b4e[_0x68b104(0xbb)]=_0x342c2d,_0x159b4e[_0x68b104(0xf5)]=0x32,_0x159b4e['Width']='100%',SPClientPeoplePicker_InitStandaloneControlWrapper(_0x1b4c2c,null,_0x159b4e);}function GetProjectDetails(_0x5ace28){var _0x8c37dc=a0_0x28c667;projectManage=[],StakeHolders=[],ProjectSponsors=[],projectItemDetails=[];var _0x782a02=_spPageContextInfo['webAbsoluteUrl']+_0x8c37dc(0x108)+_0x5ace28+'\x27';$[_0x8c37dc(0xb1)]({'url':_0x782a02,'method':_0x8c37dc(0xf3),'headers':{'Accept':_0x8c37dc(0xdb)},'async':![],'success':function(_0x364f6d){var _0x374a8f=_0x8c37dc,_0x138582=_0x364f6d,_0x4d05ca='';for(var _0xc6751c=0x0;_0xc6751c<_0x138582['d'][_0x374a8f(0x14f)][_0x374a8f(0x18c)];_0xc6751c++){_0x138582['d'][_0x374a8f(0x14f)][_0xc6751c][_0x374a8f(0x17e)]!=null&&(projectManage[_0x374a8f(0x13a)](_0x138582['d']['results'][_0xc6751c][_0x374a8f(0x17e)][_0x374a8f(0xed)]),projecttouser+=_0x138582['d'][_0x374a8f(0x14f)][_0xc6751c][_0x374a8f(0x17e)]['Title']+',',projecttouser=projecttouser[_0x374a8f(0x176)](/,(\s+)?$/,''));if(_0x138582['d'][_0x374a8f(0x14f)][_0xc6751c][_0x374a8f(0x144)][_0x374a8f(0x14f)]!=null){for(var _0x8c6d84=0x0;_0x8c6d84<_0x138582['d']['results'][_0xc6751c][_0x374a8f(0x144)][_0x374a8f(0x14f)][_0x374a8f(0x18c)];_0x8c6d84++){StakeHolders[_0x374a8f(0x13a)](_0x138582['d'][_0x374a8f(0x14f)][_0xc6751c]['MultipleStackeholder'][_0x374a8f(0x14f)][_0x8c6d84][_0x374a8f(0xed)]),stackToUsers+=_0x138582['d']['results'][_0xc6751c][_0x374a8f(0x144)][_0x374a8f(0x14f)][_0x8c6d84][_0x374a8f(0xf7)]+',';}stackToUsers=stackToUsers['replace'](/,(\s+)?$/,'');}if(_0x138582['d'][_0x374a8f(0x14f)][_0xc6751c][_0x374a8f(0xa7)]['results']!=null){for(var _0x8c6d84=0x0;_0x8c6d84<_0x138582['d'][_0x374a8f(0x14f)][_0xc6751c][_0x374a8f(0xa7)][_0x374a8f(0x14f)][_0x374a8f(0x18c)];_0x8c6d84++){ProjectSponsors[_0x374a8f(0x13a)](_0x138582['d'][_0x374a8f(0x14f)][_0xc6751c][_0x374a8f(0xa7)][_0x374a8f(0x14f)][_0x8c6d84][_0x374a8f(0xed)]),sponsorToUsers+=_0x138582['d']['results'][_0xc6751c]['MultipleSponsor'][_0x374a8f(0x14f)][_0x8c6d84][_0x374a8f(0xf7)]+',';}sponsorToUsers=sponsorToUsers['replace'](/,(\s+)?$/,'');}alluser=StakeHolders['concat'](ProjectSponsors,projectManage),projectItemDetails[_0x374a8f(0x13a)](TaskMetadata(_0x138582['d'][_0x374a8f(0x14f)][_0xc6751c],projecttouser,stackToUsers,sponsorToUsers));}},'error':function(_0x4f6605){console['log'](JSON['stringify'](_0x4f6605));}});}function GetTaskEmailTemplate(_0x4a9e77){var _0x12a75c=a0_0x28c667,_0x36c30d=_spPageContextInfo[_0x12a75c(0x17b)]+_0x12a75c(0x171)+_0x4a9e77+'\x27';$['ajax']({'url':_0x36c30d,'headers':{'accept':_0x12a75c(0x10d),'content-type':_0x12a75c(0x10d),'X-RequestDigest':$(_0x12a75c(0xa1))[_0x12a75c(0x11c)]()},'async':![],'success':function(_0x3239c5){var _0x106c26=_0x12a75c,_0x4a8696=_0x3239c5['d'][_0x106c26(0x14f)];for(var _0x582bb1=0x0;_0x582bb1<_0x4a8696[_0x106c26(0x18c)];_0x582bb1++){_0x4a8696[_0x582bb1][_0x106c26(0xdf)]!=null&&(emailBodyContent=_0x4a8696[_0x582bb1][_0x106c26(0xdf)]),_0x4a8696[_0x582bb1][_0x106c26(0xa8)]!=null&&(taskEmailSubject=_0x4a8696[_0x582bb1]['Subject']);}},'eror':function(_0x58f130){var _0x440c0a=_0x12a75c;console[_0x440c0a(0x94)](_0x440c0a(0xae));}});}function SendTaskEmail(){var _0x1abbfe=a0_0x28c667,_0x176d3b=emailBodyContent,_0x8074f8=taskEmailSubject;projectItemDetails[_0x1abbfe(0x13d)](function(_0x30df32){var _0x43f675=_0x1abbfe;_0x176d3b=_0x176d3b[_0x43f675(0x176)](_0x43f675(0xe4),_0x30df32['projecttouser']),_0x176d3b=_0x176d3b[_0x43f675(0x176)](_0x43f675(0x8c),_0x30df32[_0x43f675(0x19c)]),_0x176d3b=_0x176d3b[_0x43f675(0x176)](_0x43f675(0xc6),_0x30df32['ProjectName']),_0x176d3b=_0x176d3b['replace'](_0x43f675(0x9d),_0x30df32[_0x43f675(0xec)]),_0x30df32['DepartmentName']==_0x43f675(0x15f)?_0x176d3b=_0x176d3b[_0x43f675(0x176)](_0x43f675(0xb6),''):_0x176d3b=_0x176d3b[_0x43f675(0x176)](_0x43f675(0xb6),_0x30df32[_0x43f675(0x192)]),_0x30df32[_0x43f675(0x8e)]==_0x43f675(0x15f)?_0x176d3b=_0x176d3b[_0x43f675(0x176)](_0x43f675(0x135),''):_0x176d3b=_0x176d3b['replace'](_0x43f675(0x135),_0x30df32[_0x43f675(0x8e)]),_0x176d3b=_0x176d3b[_0x43f675(0x176)]('{{PlannedStartDate}}',_0x30df32[_0x43f675(0xd1)]),_0x176d3b=_0x176d3b[_0x43f675(0x176)]('{{PlannedEndDate}}',_0x30df32[_0x43f675(0x160)]),_0x176d3b=_0x176d3b[_0x43f675(0x176)](_0x43f675(0x14b),_spPageContextInfo[_0x43f675(0x12c)]+_0x43f675(0x16b)+companyID+_0x43f675(0xbd)+_0x30df32['ID']+_0x43f675(0xa2)+_0x30df32[_0x43f675(0x166)]+'');});var _0x5cbc19=_spPageContextInfo[_0x1abbfe(0x12d)],_0x3e4a89;_0x3e4a89={'properties':{'__metadata':{'type':_0x1abbfe(0xac)},'From':_0x5cbc19,'To':{'results':alluser},'Body':_0x176d3b,'Subject':_0x8074f8}};var _0x512155=_spPageContextInfo[_0x1abbfe(0x9c)]+_0x1abbfe(0x155);$['ajax']({'contentType':_0x1abbfe(0x131),'url':_0x512155,'type':'POST','data':JSON[_0x1abbfe(0xc0)](_0x3e4a89),'async':![],'headers':{'Accept':_0x1abbfe(0x10d),'content-type':_0x1abbfe(0x10d),'X-RequestDigest':$(_0x1abbfe(0xa1))['val']()},'success':function(_0x481d58){var _0x18d2c6=_0x1abbfe;console[_0x18d2c6(0x94)](_0x18d2c6(0x17a));},'error':function(_0xfb9805){var _0x2e078e=_0x1abbfe;waitingDialog['hide'](),console[_0x2e078e(0x94)](_0x2e078e(0x18a)+JSON[_0x2e078e(0xc0)](_0xfb9805));}});}function a0_0x1a6b(_0x3324eb,_0x454e43){var _0xcc01bb=a0_0xcc01();return a0_0x1a6b=function(_0x1a6b58,_0x54487a){_0x1a6b58=_0x1a6b58-0x8b;var _0x38512b=_0xcc01bb[_0x1a6b58];return _0x38512b;},a0_0x1a6b(_0x3324eb,_0x454e43);}function TaskMetadata(_0x3f0613,_0x34f6cd,_0x42b8e6,_0x2e7ae3){var _0x4f44cb=a0_0x28c667,_0x316837={};return _0x316837[_0x4f44cb(0x166)]=_0x3f0613[_0x4f44cb(0x166)]==null?'':_0x3f0613['ProjectName'],_0x316837[_0x4f44cb(0xec)]=_0x3f0613['ClientName']==null?'':_0x3f0613[_0x4f44cb(0xec)],_0x316837['DepartmentName']=_0x3f0613[_0x4f44cb(0x192)]==null?'':_0x3f0613[_0x4f44cb(0x192)],_0x316837[_0x4f44cb(0x19c)]=_0x3f0613['ProjectCode']==null?'':_0x3f0613[_0x4f44cb(0x19c)],_0x316837[_0x4f44cb(0x8e)]=_0x3f0613[_0x4f44cb(0x8e)]==null?'':_0x3f0613[_0x4f44cb(0x8e)],_0x316837['ID']=_0x3f0613[_0x4f44cb(0x8e)]==null?'':_0x3f0613['ID'],_0x316837[_0x4f44cb(0xe0)]=_0x3f0613[_0x4f44cb(0xe0)],_0x316837[_0x4f44cb(0xb0)]=_0x34f6cd,_0x316837[_0x4f44cb(0x172)]=_0x42b8e6,_0x316837[_0x4f44cb(0x11d)]=_0x2e7ae3,_0x316837['PlanedStartDate']=_0x3f0613[_0x4f44cb(0xd1)],_0x316837[_0x4f44cb(0xd1)]=new Date(_0x316837[_0x4f44cb(0xd1)]),_0x316837[_0x4f44cb(0xd1)]=$[_0x4f44cb(0x15b)][_0x4f44cb(0x139)](_0x4f44cb(0x199),_0x316837[_0x4f44cb(0xd1)]),_0x316837['PlanedEndDate']=_0x3f0613['PlanedEndDate'],_0x316837[_0x4f44cb(0x160)]=new Date(_0x316837['PlanedEndDate']),_0x316837[_0x4f44cb(0x160)]=$['datepicker'][_0x4f44cb(0x139)](_0x4f44cb(0x199),_0x316837['PlanedEndDate']),_0x316837;}function getProjectRights(){var _0x21e8d7=a0_0x28c667,_0x1979f0=$[_0x21e8d7(0x195)](),_0x37be1c,_0x4efb68=_0x21e8d7(0x114),_0x5cd0e3=titanForWork[_0x21e8d7(0x162)](_0x21e8d7(0x183)),_0x461d1d=_spPageContextInfo[_0x21e8d7(0x12c)]+_0x21e8d7(0x185)+_0x4efb68+_0x21e8d7(0xf8)+_0x5cd0e3+_0x21e8d7(0x123)+_spPageContextInfo[_0x21e8d7(0x111)]+_0x21e8d7(0x15a);return $[_0x21e8d7(0xb1)]({'url':_0x461d1d,'headers':{'Accept':_0x21e8d7(0x10d)},'async':!![],'success':function(_0x63c238){var _0x12ad64=_0x21e8d7,_0x43b38d=_0x63c238['d'][_0x12ad64(0x14f)];_0x43b38d[_0x12ad64(0x18c)]>0x0?(_0x1979f0['resolve'](!![]),IsProjectAdmin=!![]):(_0x1979f0[_0x12ad64(0x156)](![]),IsProjectAdmin=![]);},'eror':function(_0x700df4){var _0x5bebac=_0x21e8d7;console[_0x5bebac(0x94)]($(_0x5bebac(0xa9))[_0x5bebac(0x11c)]());}}),_0x1979f0[_0x21e8d7(0x142)]();}function IsMangerActive(_0x59f956){var _0x1b9cbd=a0_0x28c667,_0x53039e=titanForWork[_0x1b9cbd(0x162)](_0x1b9cbd(0x183)),_0x4419bb='';return RestQuery=_0x1b9cbd(0x1a0)+_0x53039e+_0x1b9cbd(0x9f)+_0x59f956+'',$['when'](CommonFunction['getItemsWithQueryItem'](_0x1b9cbd(0xd4),RestQuery))[_0x1b9cbd(0xad)](function(_0x182cad){var _0xd7c73b=_0x1b9cbd;try{_0x182cad[_0xd7c73b(0x14f)][_0xd7c73b(0x18c)]>0x0?_0x4419bb=_0x182cad[_0xd7c73b(0x14f)][0x0]['ID']:_0x4419bb=![];}catch(_0x11a171){alert(_0x11a171);}}),_0x4419bb;}function BreakInheritePermissionDMSLibrary(_0x559e96,_0x3f4c0d,_0x27a900){var _0x4f6432=a0_0x28c667,_0x1c6a70=titanForWork[_0x4f6432(0x162)](_0x4f6432(0x17d))+_0x4f6432(0x151)+_0x27a900,_0x2bcedd={'Accept':_0x4f6432(0x10d),'content-Type':_0x4f6432(0x10d),'X-RequestDigest':jQuery(_0x4f6432(0xa1))[_0x4f6432(0x11c)]()},_0x146b22=_0x1c6a70+_0x4f6432(0x11a);$[_0x4f6432(0xb1)]({'url':_0x146b22,'type':_0x4f6432(0xb8),'headers':_0x2bcedd,'async':![],'dataType':'json','success':function(_0x4bd9bf){var _0x326a6e=_0x4f6432;console[_0x326a6e(0x94)](_0x326a6e(0x169)),$[_0x326a6e(0x128)](AssignPermissiononDMSLibary(_0x559e96,_0x3f4c0d,_0x27a900))[_0x326a6e(0xad)](function(_0x344d96){var _0x49423b=_0x326a6e;console[_0x49423b(0x94)](_0x49423b(0x104));});},'error':function(_0x1f155f){var _0x30869c=_0x4f6432;console[_0x30869c(0x94)](JSON[_0x30869c(0xc0)](_0x1f155f));}});}function AssignPermissiononDMSLibary(_0x5e306f,_0x33f9ae,_0x327cce){var _0x408e0d=a0_0x28c667,_0xe227eb=titanForWork[_0x408e0d(0x162)](_0x408e0d(0x17d))+_0x408e0d(0x151)+_0x327cce,_0x569d9f={'Accept':_0x408e0d(0x10d),'content-Type':'application/json;odata=verbose','X-RequestDigest':jQuery(_0x408e0d(0xa1))[_0x408e0d(0x11c)]()},_0x5d3dc0=_0xe227eb+'/_api/web/lists/getByTitle(\x27Documents\x27)/roleassignments/addroleassignment(principalid='+_0x5e306f+_0x408e0d(0x189)+_0x33f9ae+')';$['ajax']({'url':_0x5d3dc0,'type':_0x408e0d(0xb8),'headers':_0x569d9f,'dataType':_0x408e0d(0x174),'async':![],'success':function(_0x2ad7a6){var _0x3bafaa=_0x408e0d;console[_0x3bafaa(0x94)]('User\x20has\x20been\x20assigned\x20permission\x20.');},'error':function(_0x2fa621){var _0x3da5cb=_0x408e0d;console[_0x3da5cb(0x94)](JSON[_0x3da5cb(0xc0)](_0x2fa621));}});}function AddUserToOwnerGroup(_0x3afcb4){var _0x490219=a0_0x28c667;debugger;var _0x1d612b={'__metadata':{'type':_0x490219(0xc7)},'LoginName':_0x3afcb4},_0x33ea51=_spPageContextInfo[_0x490219(0x12c)]+_0x490219(0xfa);$[_0x490219(0xb1)]({'url':_0x33ea51,'type':'POST','async':![],'headers':{'accept':_0x490219(0x10d),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x490219(0x11c)](),'content-Type':_0x490219(0x10d)},'data':JSON[_0x490219(0xc0)](_0x1d612b),'success':function(_0x162afb){debugger;},'error':function(_0x56d4ae){}});}function a0_0xcc01(){var _0x154e7c=['OfficeName','.dropdown\x20dd\x20ul','error\x20:\x20Project\x20Details\x20web\x20part','html','option','get_web','#StackeholderTeam','</option>','PlanedStartDate','#txtProjectCode','executeOrDelayUntilScriptLoaded','Employees','<select\x20name=\x22officeLocation\x22\x20id=\x22departmentDetails\x22\x20class=\x22form-control\x22>','CloseWaitDialog','User\x20has\x20been\x20assigned\x20permission\x20.','get_current','WebCreationInformation','Select\x20Customer','application/json;\x20odata=verbose','StackeholderTeamEmployeePicker','ProjectManagerEmployeePicker','ClientContext','Body','ProjectSiteURL','onQuerySucceeded_CreateProjectSite','charAt','Please\x20Fill\x20the\x20Manager','{{ProjectManager}}','4391jjJXsX','SearchPrincipalSource','#cancelNewProject','634yrZcft','/DMS','DocumentPermission','Please\x20fill\x20all\x20required\x20fields.','ClientName','UserName','TaskPermission','11584426hCyfew','hide','CatogeryName','.dropdown\x20dd\x20ul\x20li\x20a','GET','#createNewProjectSite','MaximumEntitySuggestions','12XCEqbT','Title','\x27)/items?$select=*&$filter=CompanyId\x20eq\x20\x27','<span\x20title=\x22','/_api/web/sitegroups/getbyname(\x27Owners\x27)/users','get','ActualStartDate','slideToggle','../Pages/Default.aspx?WebAppId=','append','/_api/Web/Lists/GetByTitle(\x27ProjectDetails\x27)/Items?$select=Title&$filter=ProjectCode\x20eq\x20\x27','indexOf','EngageDate','DepartmentId','Permission\x20has\x20been\x20assigned\x20successfully!','SOD','\x27\x20and\x20CompanyId\x20eq\x20\x27','Project\x20Manager\x20Added\x20As\x20A\x20Default\x20Team\x20Member.','/_api/lists/getbytitle(\x27ProjectDetails\x27)/items?$select=*,ManagerName/Title,ManagerName/UserName,MultipleStackeholder/Title,MultipleStackeholder/UserName,MultipleSponsor/Title,MultipleSponsor/UserName&$Expand=ManagerName,MultipleStackeholder,MultipleSponsor&$Filter=ID\x20eq\x20\x27','get_item','.multiSel\x20span','set_webTemplate','select#officeLocationDetails\x20option:selected','application/json;odata=verbose','STS#0','load','7954602aflqED','userId','ProjectTeamDetails','getEnumerator','ProcessApprovers','Project\x20site\x20created\x20successfully','hasClass','</Value></Eq><Eq><FieldRef\x20Name=\x27IsActive\x27\x20/><Value\x20Type=\x27Boolean\x27>1</Value></Eq></And></Where><OrderBy><FieldRef\x20Name=\x27Title\x27/></OrderBy></Query></View>','trim','input[type=\x22checkbox\x22]','/_api/web/lists/getByTitle(\x27Documents\x27)/breakroleinheritance(copyRoleAssignments=false,\x20clearSubscopes=true)','72974wVwtkW','val','sponsorToUsers','join','.mutliSelect\x20input[type=\x22checkbox\x22]','18675CSlCMW','#txtTechnology','</Value></Eq><Eq><FieldRef\x20Name=\x27OfficeLocationId\x27\x20/><Value\x20Type=\x27Text\x27>0</Value></Eq></And></Where><OrderBy><FieldRef\x20Name=\x27OfficeName\x27/></OrderBy></Query></View>','\x27\x20and\x20ContributorsId\x20eq\x20\x27','\x27)/items?$select=*,Department/DepartmentName,Department/ID&$expand=Department&$filter=CompanyId\x20eq\x20\x27','prop','get_stackTrace','User\x20has\x20been\x20assigned\x20permission.','when','keyCode','.txtActualEndDate','/_api/Web/Lists/GetByTitle(\x27ProjectDetails\x27)/Items?$select=Title&$filter=CompanyId\x20eq\x20\x27','webAbsoluteUrl','userEmail','closest','href','False','application/json','#txtDescription','moveNext','\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20\x27','{{Location}}','getTime','set_url','</ul>','formatDate','push','.txtPlannedEndDate','.multiSel','forEach','Project\x20Manager','set_title','ListItem','toUpperCase','promise','#officeLocation','MultipleStackeholder','Role','<View><OrderBy><FieldRef\x20Name=\x27ID\x27\x20Ascending=\x27False\x27/></OrderBy></View>','\x20/>','\x27)/items','sp.js','keypress','{{Projectlink}}','bind','</Value></Eq></Where><OrderBy><FieldRef\x20Name=\x27Title\x27/></OrderBy></Query></View>','please\x20insert\x20only\x201\x20Manager','results','#ProjectStatus','/DMS/','1371210xZkCVk','responseJSON','SiteURL','/_api/SP.Utilities.Utility.SendEmail','resolve','Consultant_List','#select2-clientName-container','set_description','\x27\x20and\x20WebPartName\x20eq\x20\x27Project\x20Admin\x27','datepicker','select2','<option\x20value=\x220\x22>-Select-</option>','fast','-Select-','PlanedEndDate','ResolvePrincipalSource','getQueryStringParameter','message','PrincipalAccountType','ready','ProjectName','set_language','</li>','Permission\x20has\x20been\x20breaked\x20successfully!','3230vmzWMO','/Pages/ViewProjectDetails.aspx?WebAppId=','get_lists','360bwwOJo','#clientName','SP.Data.','TeamMemberId','/_api/web/Lists/GetByTitle(\x27EmailTemplate\x27)/Items?$select=ID,Body,Subject,EmailType,Title&$filter=Title\x20eq\x20\x27','stackToUsers','set_viewXml','json','toString','replace','reject','set_useSamePermissionsAsParentSite','.dropdown\x20dt\x20a','Message\x20has\x20been\x20sent.','siteAbsoluteUrl','.mutliSelect','CompanySiteUrl','ManagerName','.txtActualStartDate','target','toISOString','blur','CompanyId','charCode','/_api/web/lists/getbytitle(\x27','#TaskTeamDetails','Consultant_Comp','xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx',',roleDefId=','SendEmailSharedNotification\x20\x20','get_webs','length','span[title=\x22','-50:+50','yyyy','.hida','Project\x20site\x20created\x20Successfully','DepartmentName','i:0#.f|membership|','<option\x20value=\x22','Deferred','dateFormat','each','#departmentDetails','dd-M-yy','/_api/web/lists/getbytitle(\x27CategoryMaster\x27)/items?$select=CategoryType,CatogeryName&$filter=CategoryType\x20eq\x20\x27Project\x20Type\x27\x20and\x20Status\x20eq\x20\x27Yes\x27','attr','ProjectCode','8045370XfkTap','executeQueryAsync','appendTo','?$select=*,LogonName/EMail,LogonName/Id,LogonName/FirstName,LogonName/LastName,LogonName/EMail&$expand=LogonName\x20&$filter=\x20Status\x20eq\x20\x27Active\x27\x20and\x20Company/ID\x20eq\x20','</select>','split','{{ProjectCode}}','empty','OfficeLocation','text','<select\x20name=\x22officeLocation\x22\x20id=\x22officeLocationDetails\x22\x20class=\x22form-control\x22>','CamlQuery','click','\x27\x20and\x20Department/ID\x20eq\x20\x27','log','Planned\x20End\x20Date\x20can\x20not\x20less\x20than\x20Planned\x20Start\x20Date.','disabled','\x27\x20and\x20ProjectName\x20eq\x20\x27','.txtPlannedStartDate','ProjectDetails','onQueryFailed_CreateProjectSite','SPClientPeoplePickerDict','webServerRelativeUrl','{{ProjectClientName}}','Request\x20failed.\x20','\x20and\x20LogonNameId\x20eq\x20','<View><Query><Where><And><Eq><FieldRef\x20Name=\x27CompanyID\x27\x20/><Value\x20Type=\x27Lookup\x27>','#__REQUESTDIGEST','&ProjectName=','Project\x20code\x20or\x20Project\x20name\x20already\x20exist.','getItems','dd/mm/yy','#txtProjectName','MultipleSponsor','Subject','#txtSomethingWentWrong','ClientMaster','Employee\x20is\x20not\x20active\x20','SP.Utilities.EmailProperties','done','error','<select\x20name=\x22ClientName\x22\x20id=\x22clientName\x22\x20class=\x22form-control\x22>','projecttouser','ajax','getByTitle','ProjectId','remove','[id^=\x27','{{Department}}','createDelegate','POST','ExpectedReleseDate','.ActualEndDate','AllowMultipleValues','<ul>','&ProjectID=','#departmentDiv','get_message','stringify','\x27\x20and\x20(WebPartName\x20eq\x20\x27Project\x27)','#SponsorTeam','find','ProjectInternalName','SponsorTeamEmployeePicker','{{ProjectName}}','SP.User','#officeLocationDetails'];a0_0xcc01=function(){return _0x154e7c;};return a0_0xcc01();}function IsDepartmentAdmin(){var _0x2b082=a0_0x28c667,_0x462ad0=titanForWork[_0x2b082(0x162)](_0x2b082(0x183)),_0x12db90=Logged_DepartmentId,_0x1261e0=_0x2b082(0x114),_0x3c2be9=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27'+_0x1261e0+_0x2b082(0x124)+_0x462ad0+_0x2b082(0x123)+_spPageContextInfo[_0x2b082(0x111)]+_0x2b082(0x93)+_0x12db90+_0x2b082(0xc1);return $[_0x2b082(0xb1)]({'url':_0x3c2be9,'type':_0x2b082(0xfb),'headers':{'Accept':_0x2b082(0x10d)},'async':![],'success':function(_0x27d149){var _0x5e9217=_0x2b082,_0x2607cb=_0x27d149['d'][_0x5e9217(0x14f)];_0x2607cb[_0x5e9217(0x18c)]>0x0?IsdeptAdmin=!![]:IsdeptAdmin=![];},'error':function(_0x1d8224){var _0x3f85fb=_0x2b082;console[_0x3f85fb(0x94)](_0x1d8224[_0x3f85fb(0x153)]);}}),IsdeptAdmin;}function bindProjectType(){var _0x5cdb4=a0_0x28c667;$(_0x5cdb4(0x121))[_0x5cdb4(0x8d)]();var _0x9a006f=_spPageContextInfo['webAbsoluteUrl']+_0x5cdb4(0x19a);$[_0x5cdb4(0xb1)]({'url':_0x9a006f,'headers':{'Accept':_0x5cdb4(0x10d)},'async':!![],'success':function(_0x1e7560){var _0x42f6c3=_0x5cdb4;$(_0x42f6c3(0x15d))[_0x42f6c3(0x19f)](_0x42f6c3(0x121));for(var _0x46935f=0x0;_0x46935f<_0x1e7560['d'][_0x42f6c3(0x14f)]['length'];_0x46935f++){$(_0x42f6c3(0x121))['append'](_0x42f6c3(0x194)+_0x1e7560['d'][_0x42f6c3(0x14f)][_0x46935f][_0x42f6c3(0xf1)]+'\x22>'+_0x1e7560['d'][_0x42f6c3(0x14f)][_0x46935f][_0x42f6c3(0xf1)]+_0x42f6c3(0xd0));}},'myError':function(_0x523d49){}});}