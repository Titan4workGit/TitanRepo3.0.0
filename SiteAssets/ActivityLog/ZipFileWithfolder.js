var a0_0xe105be=a0_0x5c49;(function(_0x1b5031,_0x40bc1e){var _0x4173eb=a0_0x5c49,_0x4087ca=_0x1b5031();while(!![]){try{var _0x386122=parseInt(_0x4173eb(0x1e8))/0x1*(-parseInt(_0x4173eb(0x1d9))/0x2)+-parseInt(_0x4173eb(0x1f6))/0x3*(-parseInt(_0x4173eb(0x1e0))/0x4)+parseInt(_0x4173eb(0x1dc))/0x5*(-parseInt(_0x4173eb(0x1df))/0x6)+-parseInt(_0x4173eb(0x1f1))/0x7*(-parseInt(_0x4173eb(0x1e5))/0x8)+-parseInt(_0x4173eb(0x1d8))/0x9+-parseInt(_0x4173eb(0x203))/0xa*(parseInt(_0x4173eb(0x1fa))/0xb)+parseInt(_0x4173eb(0x1da))/0xc;if(_0x386122===_0x40bc1e)break;else _0x4087ca['push'](_0x4087ca['shift']());}catch(_0x11257a){_0x4087ca['push'](_0x4087ca['shift']());}}}(a0_0x22a8,0x23089));const siteUrl=_spPageContextInfo[a0_0xe105be(0x1d7)],selectedFolders=[];function a0_0x5c49(_0x18e021,_0x585ca6){var _0x22a86a=a0_0x22a8();return a0_0x5c49=function(_0x5c49a2,_0x3f5de8){_0x5c49a2=_0x5c49a2-0x1d7;var _0x4e3b5c=_0x22a86a[_0x5c49a2];return _0x4e3b5c;},a0_0x5c49(_0x18e021,_0x585ca6);}var zip=new JSZip(),listName=a0_0xe105be(0x1eb);function a0_0x22a8(){var _0x13927d=['getElementsByName','createObjectURL','json','1931432bMIpPn','indexOf','slice','190577WZuegs','<tr><th>Select</th><th>Name</th></tr>','FileRef','DemoLibrary','</td></tr>','</td><td>','html','lastIndexOf','log','7KbsULF','then','<table>','</table>','generateAsync','138354nyqbcD','/_api/web/lists/getByTitle(\x27DemoLibrary\x27)/items?$select=FileRef&$orderby=FileLeafRef&$filter=FSObjType\x20eq\x201','forEach','ServerRelativeUrl','1038389siIWur','application/json;odata=verbose','download','createElement','/_api/web/GetFolderByServerRelativeUrl(\x27','#fileList','\x27)?$expand=Folders,Files&$select=Name,ServerRelativeUrl,Folders,Files','Folders','map','30IaCFMY','push','GET','.zip','all','<tr><td>','results','webAbsoluteUrl','2453346Pyzeli','2uzVXzA','9295812uhgpBE','substring','57515cAxoTx','blob','ajax','138ZNvshO','12RqKkTA','Files'];a0_0x22a8=function(){return _0x13927d;};return a0_0x22a8();}function downloadSelectedFilesAsZip(){var _0x4e6e78=a0_0xe105be,_0xa49e5d=document[_0x4e6e78(0x1e2)]('files'),_0x50cbdd=[];_0xa49e5d[_0x4e6e78(0x1f8)](function(_0x13ec02){var _0x8abd78=_0x4e6e78;_0x13ec02['checked']&&_0x50cbdd[_0x8abd78(0x204)](_0x13ec02['value']);});var _0x322b54=[],_0x53797b=_0x50cbdd['map'](function(_0xf9c4dd){return getFolderFilesAndSubFolders(_0xf9c4dd,_0x322b54);});Promise['all'](_0x53797b)[_0x4e6e78(0x1f2)](function(){var _0x5763ce=_0x4e6e78;zip=new JSZip();var _0x275d34=_0x322b54[_0x5763ce(0x202)](function(_0x4debef){var _0x21605a=_0x5763ce,_0x4fb0f2=_spPageContextInfo['portalUrl']+_0x4debef;return fetch(_0x4fb0f2)[_0x21605a(0x1f2)](function(_0x4d70d4){var _0x3eaa5a=_0x21605a;return _0x4d70d4[_0x3eaa5a(0x1dd)]();})['then'](function(_0x402f7f){var _0x47dcb8=_0x21605a,_0x52bea8=_0x4debef[_0x47dcb8(0x1db)](_0x4debef[_0x47dcb8(0x1e6)](listName)+listName['length']+0x1);zip['file'](_0x52bea8,_0x402f7f);});});Promise[_0x5763ce(0x207)](_0x275d34)['then'](function(){dowloadZip();});});}function dowloadZip(){var _0x20b384=a0_0xe105be;zip[_0x20b384(0x1f5)]({'type':_0x20b384(0x1dd)})[_0x20b384(0x1f2)](function(_0x5f2f25){var _0x58510f=_0x20b384,_0x2d3d54=document[_0x58510f(0x1fd)]('a');_0x2d3d54['href']=URL[_0x58510f(0x1e3)](_0x5f2f25),_0x2d3d54[_0x58510f(0x1fc)]='files_'+new Date()['toJSON']()[_0x58510f(0x1e7)](0x0,0x14)+_0x58510f(0x206),_0x2d3d54['click']();});}function getFilesFromLibrary(_0x417e0d){var _0x4a1b0b=a0_0xe105be,_0x1b80c3=_0x417e0d+_0x4a1b0b(0x1f7);$[_0x4a1b0b(0x1de)]({'url':_0x1b80c3,'type':_0x4a1b0b(0x205),'headers':{'Accept':_0x4a1b0b(0x1fb)},'success':function(_0x248616){var _0x57e793=_0x4a1b0b,_0x4efd25=_0x248616['d'][_0x57e793(0x209)],_0x5c0a8f=[];_0x4efd25[_0x57e793(0x1f8)](function(_0x19f6ad){var _0x48047d=_0x57e793,_0x26d702=_0x19f6ad[_0x48047d(0x1ea)][_0x48047d(0x1db)](_0x19f6ad[_0x48047d(0x1ea)][_0x48047d(0x1ef)]('/')+0x1),_0x2f2fd8={'name':_0x26d702,'url':_0x19f6ad[_0x48047d(0x1ea)],'checkbox':'<input\x20type=\x27checkbox\x27\x20name=\x27files\x27\x20value=\x27'+_0x19f6ad['FileRef']+'\x27>'};_0x5c0a8f[_0x48047d(0x204)](_0x2f2fd8);});var _0x9dec00=_0x57e793(0x1f3);_0x9dec00+=_0x57e793(0x1e9),_0x5c0a8f[_0x57e793(0x1f8)](function(_0x367f2d){var _0x35daa7=_0x57e793;_0x9dec00+=_0x35daa7(0x208)+_0x367f2d['checkbox']+_0x35daa7(0x1ed)+_0x367f2d['name']+_0x35daa7(0x1ec);}),_0x9dec00+=_0x57e793(0x1f4),$(_0x57e793(0x1ff))[_0x57e793(0x1ee)](_0x9dec00);},'error':function(_0x47bd47){var _0x195192=_0x4a1b0b;console[_0x195192(0x1f0)](_0x47bd47);}});}getFilesFromLibrary(siteUrl);async function getFolderFilesAndSubFolders(_0x1eede3,_0x4f3e2e){var _0x251735=a0_0xe105be,_0x2ed0a3=siteUrl+_0x251735(0x1fe)+_0x1eede3+_0x251735(0x200);return fetch(_0x2ed0a3,{'headers':{'Accept':_0x251735(0x1fb)}})[_0x251735(0x1f2)](function(_0x3a5858){var _0x4d4cdc=_0x251735;return _0x3a5858[_0x4d4cdc(0x1e4)]();})[_0x251735(0x1f2)](function(_0x6d7cf){var _0x117541=_0x251735,_0x35588c=_0x6d7cf['d'][_0x117541(0x1e1)][_0x117541(0x209)];_0x35588c['forEach'](function(_0x3619a3){var _0x1a17d0=_0x117541;_0x4f3e2e[_0x1a17d0(0x204)](_0x3619a3[_0x1a17d0(0x1f9)]);});var _0x36a0b7=_0x6d7cf['d'][_0x117541(0x201)][_0x117541(0x209)],_0x2b1c79=_0x36a0b7['map'](function(_0x74b336){var _0x588336=_0x117541;return getFolderFilesAndSubFolders(_0x74b336[_0x588336(0x1f9)],_0x4f3e2e);});return Promise[_0x117541(0x207)](_0x2b1c79);});}