function a0_0x4ed3(){const _0x469ac3=['nextMiddleware','getRandomStatusCode','x-ms-ags-diagnostic','createResponseBody','12805470IDWepG','append','no-store','request','response','MANUAL','createResponseHeaders','responseBody','stringify','5DyrPOz','Date','chaosStrategy','createResponse','20662fwPvep','statusCode','toString','test','manualMap','length','getRelativeURL','undefined','setNext','sendRequest','execute','536451udBBls','Strict-Transport-Security','111AAEaXp','random','request-id','options','middlewareControl','headers','4106672phukGC','assign','712196lhlscx','method','4863117qQhrPS','floor','2347938OsdPln','get','Cache-Control','statusMessage','string'];a0_0x4ed3=function(){return _0x469ac3;};return a0_0x4ed3();}const a0_0x2e64d9=a0_0x4db5;(function(_0x4f69ff,_0x31fce9){const _0x6fbb1a=a0_0x4db5,_0x4f2069=_0x4f69ff();while(!![]){try{const _0x2ecc87=parseInt(_0x6fbb1a(0x8c))/0x1+parseInt(_0x6fbb1a(0xb0))/0x2*(parseInt(_0x6fbb1a(0x8e))/0x3)+parseInt(_0x6fbb1a(0x96))/0x4*(-parseInt(_0x6fbb1a(0xac))/0x5)+parseInt(_0x6fbb1a(0x9a))/0x6+parseInt(_0x6fbb1a(0x98))/0x7+parseInt(_0x6fbb1a(0x94))/0x8+-parseInt(_0x6fbb1a(0xa3))/0x9;if(_0x2ecc87===_0x31fce9)break;else _0x4f2069['push'](_0x4f2069['shift']());}catch(_0x5ac71b){_0x4f2069['push'](_0x4f2069['shift']());}}}(a0_0x4ed3,0xdfed7));function a0_0x4db5(_0x394e91,_0x476220){const _0x4ed3cc=a0_0x4ed3();return a0_0x4db5=function(_0x4db5fd,_0x33d144){_0x4db5fd=_0x4db5fd-0x8c;let _0x3e2d00=_0x4ed3cc[_0x4db5fd];return _0x3e2d00;},a0_0x4db5(_0x394e91,_0x476220);}import{__awaiter}from'tslib';import{MiddlewareControl}from'./MiddlewareControl';import{generateUUID}from'./MiddlewareUtil';import{httpStatusCode,methodStatusCode}from'./options/ChaosHandlerData';import{ChaosHandlerOptions}from'./options/ChaosHandlerOptions';import{ChaosStrategy}from'./options/ChaosStrategy';export class ChaosHandler{constructor(_0x508fcd=new ChaosHandlerOptions(),_0x37f64d){const _0x1f7eda=a0_0x4db5;this[_0x1f7eda(0x91)]=_0x508fcd,this[_0x1f7eda(0xb4)]=_0x37f64d;}[a0_0x2e64d9(0xa9)](_0x27675b,_0x2276e5,_0x4ac7e5){const _0x46bd5d=a0_0x2e64d9,_0x2fe428=_0x27675b[_0x46bd5d(0x93)]?new Headers(_0x27675b[_0x46bd5d(0x93)]):new Headers();return _0x2fe428['append'](_0x46bd5d(0x9c),_0x46bd5d(0xa5)),_0x2fe428[_0x46bd5d(0xa4)](_0x46bd5d(0x90),_0x2276e5),_0x2fe428[_0x46bd5d(0xa4)]('client-request-id',_0x2276e5),_0x2fe428[_0x46bd5d(0xa4)](_0x46bd5d(0xa1),''),_0x2fe428[_0x46bd5d(0xa4)](_0x46bd5d(0xad),_0x4ac7e5),_0x2fe428['append'](_0x46bd5d(0x8d),''),_0x27675b[_0x46bd5d(0xb1)]===0x1ad&&_0x2fe428[_0x46bd5d(0xa4)]('retry-after','3'),_0x2fe428;}[a0_0x2e64d9(0xa2)](_0x1b5070,_0x49b036,_0xa922ca){const _0x2c546f=a0_0x2e64d9;if(_0x1b5070[_0x2c546f(0xaa)])return _0x1b5070[_0x2c546f(0xaa)];let _0x4edd5b;if(_0x1b5070[_0x2c546f(0xb1)]>=0x190){const _0x4a02ea=httpStatusCode[_0x1b5070[_0x2c546f(0xb1)]],_0x20540a=_0x1b5070[_0x2c546f(0x9d)];_0x4edd5b={'error':{'code':_0x4a02ea,'message':_0x20540a,'innerError':{'request-id':_0x49b036,'date':_0xa922ca}}};}else _0x4edd5b={};return _0x4edd5b;}[a0_0x2e64d9(0xaf)](_0x13c28e,_0x590a5f){const _0x45d355=a0_0x2e64d9,_0x3bb957=_0x590a5f[_0x45d355(0xa6)],_0xcaf37e=generateUUID(),_0x1c6856=new Date(),_0x58cba4=this['createResponseHeaders'](_0x13c28e,_0xcaf37e,_0x1c6856[_0x45d355(0xb2)]()),_0x54d2c3=this[_0x45d355(0xa2)](_0x13c28e,_0xcaf37e,_0x1c6856['toString']()),_0x4d4dff={'url':_0x3bb957,'status':_0x13c28e['statusCode'],'statusText':_0x13c28e[_0x45d355(0x9d)],'headers':_0x58cba4};_0x590a5f[_0x45d355(0xa7)]=new Response(typeof _0x54d2c3===_0x45d355(0x9e)?_0x54d2c3:JSON[_0x45d355(0xab)](_0x54d2c3),_0x4d4dff);}[a0_0x2e64d9(0xb9)](_0x513114,_0x5e12a8){return __awaiter(this,void 0x0,void 0x0,function*(){const _0xcb7f51=a0_0x4db5;this['setStatusCode'](_0x513114,_0x5e12a8['request'],_0x5e12a8[_0xcb7f51(0x91)][_0xcb7f51(0x97)]);if(_0x513114[_0xcb7f51(0xae)]===ChaosStrategy[_0xcb7f51(0xa8)]&&!this[_0xcb7f51(0x9f)]||Math['floor'](Math[_0xcb7f51(0x8f)]()*0x64)<_0x513114['chaosPercentage'])this['createResponse'](_0x513114,_0x5e12a8);else this[_0xcb7f51(0x9f)]&&(yield this[_0xcb7f51(0x9f)][_0xcb7f51(0xba)](_0x5e12a8));});}['getRandomStatusCode'](_0x423721){const _0x241106=a0_0x2e64d9,_0x1868af=methodStatusCode[_0x423721];return _0x1868af[Math[_0x241106(0x99)](Math[_0x241106(0x8f)]()*_0x1868af[_0x241106(0xb5)])];}[a0_0x2e64d9(0xb6)](_0x2ec1da){const _0x3a0412=/https?:\/\/graph\.microsoft\.com\/[^/]+(.+?)(\?|$)/;let _0x311785;return _0x3a0412['exec'](_0x2ec1da)!==null&&(_0x311785=_0x3a0412['exec'](_0x2ec1da)[0x1]),_0x311785;}['setStatusCode'](_0x3963cb,_0x578f43,_0x103895){const _0x3cc38a=a0_0x2e64d9;if(_0x3963cb['chaosStrategy']===ChaosStrategy[_0x3cc38a(0xa8)]){if(_0x3963cb[_0x3cc38a(0xb1)]===undefined){const _0x37f1b9=this[_0x3cc38a(0xb6)](_0x578f43);this[_0x3cc38a(0xb4)][_0x3cc38a(0x9b)](_0x37f1b9)!==undefined?this['manualMap'][_0x3cc38a(0x9b)](_0x37f1b9)[_0x3cc38a(0x9b)](_0x103895)!==undefined&&(_0x3963cb[_0x3cc38a(0xb1)]=this[_0x3cc38a(0xb4)][_0x3cc38a(0x9b)](_0x37f1b9)['get'](_0x103895)):this[_0x3cc38a(0xb4)]['forEach']((_0x25977c,_0x3334a3)=>{const _0x18ffca=_0x3cc38a,_0x292383=new RegExp(_0x3334a3+'$');_0x292383[_0x18ffca(0xb3)](_0x37f1b9)&&(this[_0x18ffca(0xb4)][_0x18ffca(0x9b)](_0x3334a3)[_0x18ffca(0x9b)](_0x103895)!==undefined&&(_0x3963cb[_0x18ffca(0xb1)]=this[_0x18ffca(0xb4)][_0x18ffca(0x9b)](_0x3334a3)[_0x18ffca(0x9b)](_0x103895)));});}}else _0x3963cb['statusCode']=this[_0x3cc38a(0xa0)](_0x103895);}['getOptions'](_0x50d135){const _0x25dac2=a0_0x2e64d9;let _0x42aadf;return _0x50d135[_0x25dac2(0x92)]instanceof MiddlewareControl&&(_0x42aadf=_0x50d135[_0x25dac2(0x92)]['getMiddlewareOptions'](ChaosHandlerOptions)),typeof _0x42aadf===_0x25dac2(0xb7)&&(_0x42aadf=Object[_0x25dac2(0x95)](new ChaosHandlerOptions(),this[_0x25dac2(0x91)])),_0x42aadf;}[a0_0x2e64d9(0xba)](_0x360dd9){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x4a9729=a0_0x4db5,_0x394742=this['getOptions'](_0x360dd9);return yield this[_0x4a9729(0xb9)](_0x394742,_0x360dd9);});}[a0_0x2e64d9(0xb8)](_0x2c57c5){const _0x2a7ab5=a0_0x2e64d9;this[_0x2a7ab5(0x9f)]=_0x2c57c5;}}